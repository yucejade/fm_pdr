<html><!-- Created using the cpp_pretty_printer from the dlib C++ library.  See http://dlib.net for updates. --><head><title>dlib C++ Library - pybind11.h</title></head><body bgcolor='white'><pre>
<font color='#009900'>/*
    pybind11/pybind11.h: Main header file of the C++11 python
    binding generator library

    Copyright (c) 2016 Wenzel Jakob &lt;wenzel.jakob@epfl.ch&gt;

    All rights reserved. Use of this source code is governed by a
    BSD-style license that can be found in the LICENSE file.
*/</font>

<font color='#0000FF'>#pragma</font> once

<font color='#0000FF'>#include</font> "<a style='text-decoration:none' href='detail/class.h.html'>detail/class.h</a>"
<font color='#0000FF'>#include</font> "<a style='text-decoration:none' href='detail/init.h.html'>detail/init.h</a>"
<font color='#0000FF'>#include</font> "<a style='text-decoration:none' href='attr.h.html'>attr.h</a>"
<font color='#0000FF'>#include</font> "<a style='text-decoration:none' href='gil.h.html'>gil.h</a>"
<font color='#0000FF'>#include</font> "<a style='text-decoration:none' href='gil_safe_call_once.h.html'>gil_safe_call_once.h</a>"
<font color='#0000FF'>#include</font> "<a style='text-decoration:none' href='options.h.html'>options.h</a>"
<font color='#0000FF'>#include</font> "<a style='text-decoration:none' href='typing.h.html'>typing.h</a>"

<font color='#0000FF'>#include</font> <font color='#5555FF'>&lt;</font>cstdlib<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>#include</font> <font color='#5555FF'>&lt;</font>cstring<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>#include</font> <font color='#5555FF'>&lt;</font>memory<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>#include</font> <font color='#5555FF'>&lt;</font>new<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>#include</font> <font color='#5555FF'>&lt;</font>string<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>#include</font> <font color='#5555FF'>&lt;</font>utility<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>#include</font> <font color='#5555FF'>&lt;</font>vector<font color='#5555FF'>&gt;</font>

<font color='#0000FF'>#if</font> defined<font face='Lucida Console'>(</font>__cpp_lib_launder<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font><font face='Lucida Console'>(</font>defined<font face='Lucida Console'>(</font>_MSC_VER<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font face='Lucida Console'>(</font>_MSC_VER <font color='#5555FF'>&lt;</font> <font color='#979000'>1914</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>
#    define PYBIND11_STD_LAUNDER std::launder
#    define PYBIND11_HAS_STD_LAUNDER <font color='#979000'>1</font>
<font color='#0000FF'>#else</font>
#    define PYBIND11_STD_LAUNDER
#    define PYBIND11_HAS_STD_LAUNDER <font color='#979000'>0</font>
<font color='#0000FF'>#endif</font>
<font color='#0000FF'>#if</font> defined<font face='Lucida Console'>(</font>__GNUG__<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font>defined<font face='Lucida Console'>(</font>__clang__<font face='Lucida Console'>)</font>
#    include <font color='#5555FF'>&lt;</font>cxxabi.h<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>#endif</font>

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>PYBIND11_NAMESPACE<font face='Lucida Console'>)</font>

<font color='#009900'>/* https://stackoverflow.com/questions/46798456/handling-gccs-noexcept-type-warning
   This warning is about ABI compatibility, not code health.
   It is only actually needed in a couple places, but apparently GCC 7 "generates this warning if
   and only if the first template instantiation ... involves noexcept" [stackoverflow], therefore
   it could get triggered from seemingly random places, depending on user code.
   No other GCC version generates this warning.
 */</font>
<font color='#0000FF'>#if</font> defined<font face='Lucida Console'>(</font>__GNUC__<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> __GNUC__ <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>7</font>
<b><a name='PYBIND11_WARNING_DISABLE_GCC'></a>PYBIND11_WARNING_DISABLE_GCC</b><font face='Lucida Console'>(</font>"<font color='#CC0000'>-Wnoexcept-type</font>"<font face='Lucida Console'>)</font>
<font color='#0000FF'>#endif</font>

<b><a name='PYBIND11_WARNING_DISABLE_MSVC'></a>PYBIND11_WARNING_DISABLE_MSVC</b><font face='Lucida Console'>(</font><font color='#979000'>4127</font><font face='Lucida Console'>)</font>

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#0000FF'>inline</font> std::string <b><a name='replace_newlines_and_squash'></a>replace_newlines_and_squash</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>text<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>whitespaces <font color='#5555FF'>=</font> "<font color='#CC0000'> \t\n\r\f\v</font>";
    std::string <font color='#BB00BB'>result</font><font face='Lucida Console'>(</font>text<font face='Lucida Console'>)</font>;
    <font color='#0000FF'><u>bool</u></font> previous_is_whitespace <font color='#5555FF'>=</font> <font color='#979000'>false</font>;

    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>result.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> <font color='#979000'>2</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#009900'>// Do not modify string representations
</font>        <font color='#0000FF'><u>char</u></font> first_char <font color='#5555FF'>=</font> result[<font color='#979000'>0</font>];
        <font color='#0000FF'><u>char</u></font> last_char <font color='#5555FF'>=</font> result[result.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>-</font> <font color='#979000'>1</font>];
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>first_char <font color='#5555FF'>=</font><font color='#5555FF'>=</font> last_char <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> first_char <font color='#5555FF'>=</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\'</font>'<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> result;
        <b>}</b>
    <b>}</b>
    result.<font color='#BB00BB'>clear</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;

    <font color='#009900'>// Replace characters in whitespaces array with spaces and squash consecutive spaces
</font>    <font color='#0000FF'>while</font> <font face='Lucida Console'>(</font><font color='#5555FF'>*</font>text <font color='#5555FF'>!</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\0</font>'<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>std::<font color='#BB00BB'>strchr</font><font face='Lucida Console'>(</font>whitespaces, <font color='#5555FF'>*</font>text<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>previous_is_whitespace<font face='Lucida Console'>)</font> <b>{</b>
                result <font color='#5555FF'>+</font><font color='#5555FF'>=</font> '<font color='#FF0000'> </font>';
                previous_is_whitespace <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
            <b>}</b>
        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
            result <font color='#5555FF'>+</font><font color='#5555FF'>=</font> <font color='#5555FF'>*</font>text;
            previous_is_whitespace <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
        <b>}</b>
        <font color='#5555FF'>+</font><font color='#5555FF'>+</font>text;
    <b>}</b>

    <font color='#009900'>// Strip leading and trailing whitespaces
</font>    <font color='#0000FF'>const</font> <font color='#0000FF'><u>size_t</u></font> str_begin <font color='#5555FF'>=</font> result.<font color='#BB00BB'>find_first_not_of</font><font face='Lucida Console'>(</font>whitespaces<font face='Lucida Console'>)</font>;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>str_begin <font color='#5555FF'>=</font><font color='#5555FF'>=</font> std::string::npos<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> "<font color='#CC0000'></font>";
    <b>}</b>

    <font color='#0000FF'>const</font> <font color='#0000FF'><u>size_t</u></font> str_end <font color='#5555FF'>=</font> result.<font color='#BB00BB'>find_last_not_of</font><font face='Lucida Console'>(</font>whitespaces<font face='Lucida Console'>)</font>;
    <font color='#0000FF'>const</font> <font color='#0000FF'><u>size_t</u></font> str_range <font color='#5555FF'>=</font> str_end <font color='#5555FF'>-</font> str_begin <font color='#5555FF'>+</font> <font color='#979000'>1</font>;

    <font color='#0000FF'>return</font> result.<font color='#BB00BB'>substr</font><font face='Lucida Console'>(</font>str_begin, str_range<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#009900'>// Apply all the extensions translators from a list
</font><font color='#009900'>// Return true if one of the translators completed without raising an exception
</font><font color='#009900'>// itself. Return of false indicates that if there are other translators
</font><font color='#009900'>// available, they should be tried.
</font><font color='#0000FF'>inline</font> <font color='#0000FF'><u>bool</u></font> <b><a name='apply_exception_translators'></a>apply_exception_translators</b><font face='Lucida Console'>(</font>std::forward_list<font color='#5555FF'>&lt;</font>ExceptionTranslator<font color='#5555FF'>&gt;</font> <font color='#5555FF'>&amp;</font>translators<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>auto</font> last_exception <font color='#5555FF'>=</font> std::<font color='#BB00BB'>current_exception</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;

    <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>translator : translators<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>try</font> <b>{</b>
            <font color='#BB00BB'>translator</font><font face='Lucida Console'>(</font>last_exception<font face='Lucida Console'>)</font>;
            <font color='#0000FF'>return</font> <font color='#979000'>true</font>;
        <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font>...<font face='Lucida Console'>)</font> <b>{</b>
            last_exception <font color='#5555FF'>=</font> std::<font color='#BB00BB'>current_exception</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b>
    <font color='#0000FF'>return</font> <font color='#979000'>false</font>;
<b>}</b>

<font color='#0000FF'>#if</font> defined<font face='Lucida Console'>(</font>_MSC_VER<font face='Lucida Console'>)</font>
#    define PYBIND11_COMPAT_STRDUP _strdup
<font color='#0000FF'>#else</font>
#    define PYBIND11_COMPAT_STRDUP strdup
<font color='#0000FF'>#endif</font>

<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#009900'>/// Wraps an arbitrary C++ function/method/lambda function/.. into a callable Python object
</font><font color='#0000FF'>class</font> <b><a name='cpp_function'></a>cpp_function</b> : <font color='#0000FF'>public</font> function <b>{</b>
<font color='#0000FF'>public</font>:
    <b><a name='cpp_function'></a>cpp_function</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#0000FF'>default</font>;
    <font color='#009900'>// NOLINTNEXTLINE(google-explicit-constructor)
</font>    <b><a name='cpp_function'></a>cpp_function</b><font face='Lucida Console'>(</font>std::nullptr_t<font face='Lucida Console'>)</font> <b>{</b><b>}</b>
    <b><a name='cpp_function'></a>cpp_function</b><font face='Lucida Console'>(</font>std::nullptr_t, <font color='#0000FF'>const</font> is_setter <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <b>{</b><b>}</b>

    <font color='#009900'>/// Construct a cpp_function from a vanilla function pointer
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font>... Args, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    <font color='#009900'>// NOLINTNEXTLINE(google-explicit-constructor)
</font>    <b><a name='cpp_function'></a>cpp_function</b><font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font><font color='#5555FF'>*</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Args...<font face='Lucida Console'>)</font>, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>initialize</font><font face='Lucida Console'>(</font>f, f, extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Construct a cpp_function from a lambda function (possibly with internal state)
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Func,
              <font color='#0000FF'>typename</font>... Extra,
              <font color='#0000FF'>typename</font> <font color='#5555FF'>=</font> detail::enable_if_t<font color='#5555FF'>&lt;</font>detail::is_lambda<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font>::value<font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font>
    <font color='#009900'>// NOLINTNEXTLINE(google-explicit-constructor)
</font>    <b><a name='cpp_function'></a>cpp_function</b><font face='Lucida Console'>(</font>Func <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>f, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>initialize</font><font face='Lucida Console'>(</font>
            std::forward<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>f<font face='Lucida Console'>)</font>, <font face='Lucida Console'>(</font>detail::function_signature_t<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font> <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> nullptr, extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Construct a cpp_function from a class method (non-const, no ref-qualifier)
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font> Class, <font color='#0000FF'>typename</font>... Arg, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    <font color='#009900'>// NOLINTNEXTLINE(google-explicit-constructor)
</font>    <b><a name='cpp_function'></a>cpp_function</b><font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font>Class::<font color='#5555FF'>*</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Arg...<font face='Lucida Console'>)</font>, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>initialize</font><font face='Lucida Console'>(</font>
            [f]<font face='Lucida Console'>(</font>Class <font color='#5555FF'>*</font>c, Arg... args<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> Return <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font>c<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#5555FF'>*</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Arg<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>args<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>; <b>}</b>,
            <font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Class <font color='#5555FF'>*</font>, Arg...<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> nullptr,
            extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Construct a cpp_function from a class method (non-const, lvalue ref-qualifier)
</font>    <font color='#009900'>/// A copy of the overload for non-const functions without explicit ref-qualifier
</font>    <font color='#009900'>/// but with an added `&amp;`.
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font> Class, <font color='#0000FF'>typename</font>... Arg, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    <font color='#009900'>// NOLINTNEXTLINE(google-explicit-constructor)
</font>    <b><a name='cpp_function'></a>cpp_function</b><font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font>Class::<font color='#5555FF'>*</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Arg...<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font>, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>initialize</font><font face='Lucida Console'>(</font>
            [f]<font face='Lucida Console'>(</font>Class <font color='#5555FF'>*</font>c, Arg... args<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> Return <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font>c<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#5555FF'>*</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Arg<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>args<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>; <b>}</b>,
            <font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Class <font color='#5555FF'>*</font>, Arg...<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> nullptr,
            extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Construct a cpp_function from a class method (const, no ref-qualifier)
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font> Class, <font color='#0000FF'>typename</font>... Arg, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    <font color='#009900'>// NOLINTNEXTLINE(google-explicit-constructor)
</font>    <b><a name='cpp_function'></a>cpp_function</b><font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font>Class::<font color='#5555FF'>*</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Arg...<font face='Lucida Console'>)</font> <font color='#0000FF'>const</font>, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>initialize</font><font face='Lucida Console'>(</font>[f]<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> Class <font color='#5555FF'>*</font>c,
                       Arg... args<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> Return <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font>c<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#5555FF'>*</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Arg<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>args<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>; <b>}</b>,
                   <font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> Class <font color='#5555FF'>*</font>, Arg...<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> nullptr,
                   extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Construct a cpp_function from a class method (const, lvalue ref-qualifier)
</font>    <font color='#009900'>/// A copy of the overload for const functions without explicit ref-qualifier
</font>    <font color='#009900'>/// but with an added `&amp;`.
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font> Class, <font color='#0000FF'>typename</font>... Arg, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    <font color='#009900'>// NOLINTNEXTLINE(google-explicit-constructor)
</font>    <b><a name='cpp_function'></a>cpp_function</b><font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font>Class::<font color='#5555FF'>*</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Arg...<font face='Lucida Console'>)</font> <font color='#0000FF'>const</font> <font color='#5555FF'>&amp;</font>, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>initialize</font><font face='Lucida Console'>(</font>[f]<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> Class <font color='#5555FF'>*</font>c,
                       Arg... args<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> Return <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font>c<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#5555FF'>*</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Arg<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>args<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>; <b>}</b>,
                   <font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> Class <font color='#5555FF'>*</font>, Arg...<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> nullptr,
                   extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Return the function name
</font>    object <b><a name='name'></a>name</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#0000FF'>const</font> <b>{</b> <font color='#0000FF'>return</font> <font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__name__</font>"<font face='Lucida Console'>)</font>; <b>}</b>

<font color='#0000FF'>protected</font>:
    <font color='#0000FF'>struct</font> <b><a name='InitializingFunctionRecordDeleter'></a>InitializingFunctionRecordDeleter</b> <b>{</b>
        <font color='#009900'>// `destruct(function_record, false)`: `initialize_generic` copies strings and
</font>        <font color='#009900'>// takes care of cleaning up in case of exceptions. So pass `false` to `free_strings`.
</font>        <font color='#0000FF'><u>void</u></font> <b><a name='operator'></a>operator</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>detail::function_record <font color='#5555FF'>*</font>rec<font face='Lucida Console'>)</font> <b>{</b> <font color='#BB00BB'>destruct</font><font face='Lucida Console'>(</font>rec, <font color='#979000'>false</font><font face='Lucida Console'>)</font>; <b>}</b>
    <b>}</b>;
    <font color='#0000FF'>using</font> unique_function_record
        <font color='#5555FF'>=</font> std::unique_ptr<font color='#5555FF'>&lt;</font>detail::function_record, InitializingFunctionRecordDeleter<font color='#5555FF'>&gt;</font>;

    <font color='#009900'>/// Space optimization: don't inline this frequently instantiated fragment
</font>    PYBIND11_NOINLINE unique_function_record <b><a name='make_function_record'></a>make_function_record</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>unique_function_record</font><font face='Lucida Console'>(</font><font color='#0000FF'>new</font> detail::<font color='#BB00BB'>function_record</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Special internal constructor for functors, lambda functions, etc.
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Func, <font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font>... Args, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    <font color='#0000FF'><u>void</u></font> <b><a name='initialize'></a>initialize</b><font face='Lucida Console'>(</font>Func <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>f, <font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Args...<font face='Lucida Console'>)</font>, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>using</font> <font color='#0000FF'>namespace</font> detail;
        <font color='#0000FF'>struct</font> <b><a name='capture'></a>capture</b> <b>{</b>
            remove_reference_t<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font> f;
        <b>}</b>;

        <font color='#009900'>/* Store the function including any extra state it might have (e.g. a lambda capture
         * object) */</font>
        <font color='#009900'>// The unique_ptr makes sure nothing is leaked in case of an exception.
</font>        <font color='#0000FF'>auto</font> unique_rec <font color='#5555FF'>=</font> <font color='#BB00BB'>make_function_record</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>rec <font color='#5555FF'>=</font> unique_rec.<font color='#BB00BB'>get</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;

        <font color='#009900'>/* Store the capture object directly in the function record if there is enough space */</font>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font>capture<font face='Lucida Console'>)</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>=</font> <font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>data<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#009900'>/* Without these pragmas, GCC warns that there might not be
               enough space to use the placement new operator. However, the
               'if' statement above ensures that this is the case. */</font>
            PYBIND11_WARNING_PUSH

<font color='#0000FF'>#if</font> defined<font face='Lucida Console'>(</font>__GNUG__<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> __GNUC__ <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> <font color='#979000'>6</font>
            <font color='#BB00BB'>PYBIND11_WARNING_DISABLE_GCC</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>-Wplacement-new</font>"<font face='Lucida Console'>)</font>
<font color='#0000FF'>#endif</font>

            <font color='#0000FF'>new</font> <font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>capture <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>data<font face='Lucida Console'>)</font> capture<b>{</b>std::forward<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>f<font face='Lucida Console'>)</font><b>}</b>;

<font color='#0000FF'>#if</font> <font color='#5555FF'>!</font>PYBIND11_HAS_STD_LAUNDER
            <font color='#BB00BB'>PYBIND11_WARNING_DISABLE_GCC</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>-Wstrict-aliasing</font>"<font face='Lucida Console'>)</font>
<font color='#0000FF'>#endif</font>

            <font color='#009900'>// UB without std::launder, but without breaking ABI and/or
</font>            <font color='#009900'>// a significant refactoring it's "impossible" to solve.
</font>            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>std::is_trivially_destructible<font color='#5555FF'>&lt;</font>capture<font color='#5555FF'>&gt;</font>::value<font face='Lucida Console'>)</font> <b>{</b>
                rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>free_data <font color='#5555FF'>=</font> []<font face='Lucida Console'>(</font>function_record <font color='#5555FF'>*</font>r<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>auto</font> data <font color='#5555FF'>=</font> <font color='#BB00BB'>PYBIND11_STD_LAUNDER</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>capture <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font>r<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>data<font face='Lucida Console'>)</font>;
                    <font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font><font face='Lucida Console'>)</font> data;
                    data<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>~<font color='#BB00BB'>capture</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                <b>}</b>;
            <b>}</b>
            PYBIND11_WARNING_POP
        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>data[<font color='#979000'>0</font>] <font color='#5555FF'>=</font> <font color='#0000FF'>new</font> capture<b>{</b>std::forward<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>f<font face='Lucida Console'>)</font><b>}</b>;
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>free_data <font color='#5555FF'>=</font> []<font face='Lucida Console'>(</font>function_record <font color='#5555FF'>*</font>r<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>delete</font> <font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>capture <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> r<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>data[<font color='#979000'>0</font>]<font face='Lucida Console'>)</font>; <b>}</b>;
        <b>}</b>

        <font color='#009900'>/* Type casters for the function arguments and return value */</font>
        <font color='#0000FF'>using</font> cast_in <font color='#5555FF'>=</font> argument_loader<font color='#5555FF'>&lt;</font>Args...<font color='#5555FF'>&gt;</font>;
        <font color='#0000FF'>using</font> cast_out
            <font color='#5555FF'>=</font> make_caster<font color='#5555FF'>&lt;</font>conditional_t<font color='#5555FF'>&lt;</font>std::is_void<font color='#5555FF'>&lt;</font>Return<font color='#5555FF'>&gt;</font>::value, void_type, Return<font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font>;

        <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font>
            expected_num_args<font color='#5555FF'>&lt;</font>Extra...<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>
                <font color='#0000FF'>sizeof</font>...<font face='Lucida Console'>(</font>Args<font face='Lucida Console'>)</font>, cast_in::args_pos <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> <font color='#979000'>0</font>, cast_in::has_kwargs<font face='Lucida Console'>)</font>,
            "<font color='#CC0000'>The number of argument annotations does not match the number of function arguments</font>"<font face='Lucida Console'>)</font>;

        <font color='#009900'>/* Dispatch code which converts function arguments and performs the actual function call */</font>
        rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>impl <font color='#5555FF'>=</font> []<font face='Lucida Console'>(</font>function_call <font color='#5555FF'>&amp;</font>call<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> handle <b>{</b>
            cast_in args_converter;

            <font color='#009900'>/* Try to cast the function arguments into the C++ domain */</font>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>args_converter.<font color='#BB00BB'>load_args</font><font face='Lucida Console'>(</font>call<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>return</font> PYBIND11_TRY_NEXT_OVERLOAD;
            <b>}</b>

            <font color='#009900'>/* Invoke call policy pre-call hook */</font>
            process_attributes<font color='#5555FF'>&lt;</font>Extra...<font color='#5555FF'>&gt;</font>::<font color='#BB00BB'>precall</font><font face='Lucida Console'>(</font>call<font face='Lucida Console'>)</font>;

            <font color='#009900'>/* Get a pointer to the capture object */</font>
            <font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>data <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font><font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font>capture<font face='Lucida Console'>)</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>=</font> <font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font>call.func.data<font face='Lucida Console'>)</font> ? <font color='#5555FF'>&amp;</font>call.func.data
                                                                          : call.func.data[<font color='#979000'>0</font>]<font face='Lucida Console'>)</font>;
            <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>cap <font color='#5555FF'>=</font> <font color='#0000FF'>const_cast</font><font color='#5555FF'>&lt;</font>capture <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'>const</font> capture <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>data<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

            <font color='#009900'>/* Override policy for rvalues -- usually to enforce rvp::move on an rvalue */</font>
            return_value_policy policy
                <font color='#5555FF'>=</font> return_value_policy_override<font color='#5555FF'>&lt;</font>Return<font color='#5555FF'>&gt;</font>::<font color='#BB00BB'>policy</font><font face='Lucida Console'>(</font>call.func.policy<font face='Lucida Console'>)</font>;

            <font color='#009900'>/* Function scope guard -- defaults to the compile-to-nothing `void_type` */</font>
            <font color='#0000FF'>using</font> Guard <font color='#5555FF'>=</font> extract_guard_t<font color='#5555FF'>&lt;</font>Extra...<font color='#5555FF'>&gt;</font>;

            <font color='#009900'>/* Perform the function call */</font>
            handle result;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>call.func.is_setter<font face='Lucida Console'>)</font> <b>{</b>
                <font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font><font face='Lucida Console'>)</font> std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>args_converter<font face='Lucida Console'>)</font>.<font color='#0000FF'>template</font> call<font color='#5555FF'>&lt;</font>Return, Guard<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>cap<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>f<font face='Lucida Console'>)</font>;
                result <font color='#5555FF'>=</font> <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                result <font color='#5555FF'>=</font> cast_out::<font color='#BB00BB'>cast</font><font face='Lucida Console'>(</font>
                    std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>args_converter<font face='Lucida Console'>)</font>.<font color='#0000FF'>template</font> call<font color='#5555FF'>&lt;</font>Return, Guard<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>cap<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>f<font face='Lucida Console'>)</font>,
                    policy,
                    call.parent<font face='Lucida Console'>)</font>;
            <b>}</b>

            <font color='#009900'>/* Invoke call policy post-call hook */</font>
            process_attributes<font color='#5555FF'>&lt;</font>Extra...<font color='#5555FF'>&gt;</font>::<font color='#BB00BB'>postcall</font><font face='Lucida Console'>(</font>call, result<font face='Lucida Console'>)</font>;

            <font color='#0000FF'>return</font> result;
        <b>}</b>;

        rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>nargs_pos <font color='#5555FF'>=</font> cast_in::args_pos <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> <font color='#979000'>0</font>
                             ? <font color='#0000FF'>static_cast</font><font color='#5555FF'>&lt;</font>std::uint16_t<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>cast_in::args_pos<font face='Lucida Console'>)</font>
                             : <font color='#0000FF'>sizeof</font>...<font face='Lucida Console'>(</font>Args<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font> cast_in::has_kwargs; <font color='#009900'>// Will get reduced more if
</font>                                                                      <font color='#009900'>// we have a kw_only
</font>        rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>has_args <font color='#5555FF'>=</font> cast_in::args_pos <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> <font color='#979000'>0</font>;
        rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>has_kwargs <font color='#5555FF'>=</font> cast_in::has_kwargs;

        <font color='#009900'>/* Process any user-provided function attributes */</font>
        process_attributes<font color='#5555FF'>&lt;</font>Extra...<font color='#5555FF'>&gt;</font>::<font color='#BB00BB'>init</font><font face='Lucida Console'>(</font>extra..., rec<font face='Lucida Console'>)</font>;

        <b>{</b>
            constexpr <font color='#0000FF'><u>bool</u></font> has_kw_only_args <font color='#5555FF'>=</font> any_of<font color='#5555FF'>&lt;</font>std::is_same<font color='#5555FF'>&lt;</font>kw_only, Extra<font color='#5555FF'>&gt;</font>...<font color='#5555FF'>&gt;</font>::value,
                           has_pos_only_args <font color='#5555FF'>=</font> any_of<font color='#5555FF'>&lt;</font>std::is_same<font color='#5555FF'>&lt;</font>pos_only, Extra<font color='#5555FF'>&gt;</font>...<font color='#5555FF'>&gt;</font>::value,
                           has_arg_annotations <font color='#5555FF'>=</font> any_of<font color='#5555FF'>&lt;</font>is_keyword<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font>...<font color='#5555FF'>&gt;</font>::value;
            <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font>has_arg_annotations <font color='#5555FF'>|</font><font color='#5555FF'>|</font> <font color='#5555FF'>!</font>has_kw_only_args,
                          "<font color='#CC0000'>py::kw_only requires the use of argument annotations</font>"<font face='Lucida Console'>)</font>;
            <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font>has_arg_annotations <font color='#5555FF'>|</font><font color='#5555FF'>|</font> <font color='#5555FF'>!</font>has_pos_only_args,
                          "<font color='#CC0000'>py::pos_only requires the use of argument annotations (for docstrings </font>"
                          "<font color='#CC0000'>and aligning the annotations to the argument)</font>"<font face='Lucida Console'>)</font>;

            <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font><font color='#BB00BB'>constexpr_sum</font><font face='Lucida Console'>(</font>is_kw_only<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font>::value...<font face='Lucida Console'>)</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>=</font> <font color='#979000'>1</font>,
                          "<font color='#CC0000'>py::kw_only may be specified only once</font>"<font face='Lucida Console'>)</font>;
            <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font><font color='#BB00BB'>constexpr_sum</font><font face='Lucida Console'>(</font>is_pos_only<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font>::value...<font face='Lucida Console'>)</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>=</font> <font color='#979000'>1</font>,
                          "<font color='#CC0000'>py::pos_only may be specified only once</font>"<font face='Lucida Console'>)</font>;
            constexpr <font color='#0000FF'>auto</font> kw_only_pos <font color='#5555FF'>=</font> constexpr_first<font color='#5555FF'>&lt;</font>is_kw_only, Extra...<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            constexpr <font color='#0000FF'>auto</font> pos_only_pos <font color='#5555FF'>=</font> constexpr_first<font color='#5555FF'>&lt;</font>is_pos_only, Extra...<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font><font color='#5555FF'>!</font><font face='Lucida Console'>(</font>has_kw_only_args <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> has_pos_only_args<font face='Lucida Console'>)</font> <font color='#5555FF'>|</font><font color='#5555FF'>|</font> pos_only_pos <font color='#5555FF'>&lt;</font> kw_only_pos,
                          "<font color='#CC0000'>py::pos_only must come before py::kw_only</font>"<font face='Lucida Console'>)</font>;
        <b>}</b>

        <font color='#009900'>/* Generate a readable signature describing the function's arguments and return
           value types */</font>
        <font color='#0000FF'>static</font> constexpr <font color='#0000FF'>auto</font> signature
            <font color='#5555FF'>=</font> <font color='#BB00BB'>const_name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>(</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> cast_in::arg_names <font color='#5555FF'>+</font> <font color='#BB00BB'>const_name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>) -&gt; </font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> cast_out::name;
        PYBIND11_DESCR_CONSTEXPR <font color='#0000FF'>auto</font> types <font color='#5555FF'>=</font> <font color='#BB00BB'>decltype</font><font face='Lucida Console'>(</font>signature<font face='Lucida Console'>)</font>::<font color='#BB00BB'>types</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;

        <font color='#009900'>/* Register the function with Python from generic (non-templated) code */</font>
        <font color='#009900'>// Pass on the ownership over the `unique_rec` to `initialize_generic`. `rec` stays valid.
</font>        <font color='#BB00BB'>initialize_generic</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>unique_rec<font face='Lucida Console'>)</font>, signature.text, types.<font color='#BB00BB'>data</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, <font color='#0000FF'>sizeof</font>...<font face='Lucida Console'>(</font>Args<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

        <font color='#009900'>/* Stash some additional information used by an important optimization in 'functional.h' */</font>
        <font color='#0000FF'>using</font> FunctionType <font color='#5555FF'>=</font> <font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Args...<font face='Lucida Console'>)</font>;
        constexpr <font color='#0000FF'><u>bool</u></font> is_function_ptr
            <font color='#5555FF'>=</font> std::is_convertible<font color='#5555FF'>&lt;</font>Func, FunctionType<font color='#5555FF'>&gt;</font>::value <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font>capture<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>is_function_ptr<font face='Lucida Console'>)</font> <b>{</b>
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_stateless <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>data[<font color='#979000'>1</font>]
                <font color='#5555FF'>=</font> <font color='#0000FF'>const_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#5555FF'>&amp;</font><font color='#0000FF'>typeid</font><font face='Lucida Console'>(</font>FunctionType<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b>

    <font color='#009900'>// Utility class that keeps track of all duplicated strings, and cleans them up in its
</font>    <font color='#009900'>// destructor, unless they are released. Basically a RAII-solution to deal with exceptions
</font>    <font color='#009900'>// along the way.
</font>    <font color='#0000FF'>class</font> <b><a name='strdup_guard'></a>strdup_guard</b> <b>{</b>
    <font color='#0000FF'>public</font>:
        <b><a name='strdup_guard'></a>strdup_guard</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#0000FF'>default</font>;
        <b><a name='strdup_guard'></a>strdup_guard</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> strdup_guard <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#0000FF'>delete</font>;
        strdup_guard <font color='#5555FF'>&amp;</font><b><a name='operator'></a>operator</b><font color='#5555FF'>=</font><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> strdup_guard <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#0000FF'>delete</font>;

        ~<b><a name='strdup_guard'></a>strdup_guard</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>s : strings<font face='Lucida Console'>)</font> <b>{</b>
                std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font>s<font face='Lucida Console'>)</font>;
            <b>}</b>
        <b>}</b>
        <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><b><a name='operator'></a>operator</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>s<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>t <font color='#5555FF'>=</font> <font color='#BB00BB'>PYBIND11_COMPAT_STRDUP</font><font face='Lucida Console'>(</font>s<font face='Lucida Console'>)</font>;
            strings.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>t<font face='Lucida Console'>)</font>;
            <font color='#0000FF'>return</font> t;
        <b>}</b>
        <font color='#0000FF'><u>void</u></font> <b><a name='release'></a>release</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b> strings.<font color='#BB00BB'>clear</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>; <b>}</b>

    <font color='#0000FF'>private</font>:
        std::vector<font color='#5555FF'>&lt;</font><font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font> strings;
    <b>}</b>;

    <font color='#009900'>/// Register a function call with Python (generic non-templated code goes here)
</font>    <font color='#0000FF'><u>void</u></font> <b><a name='initialize_generic'></a>initialize_generic</b><font face='Lucida Console'>(</font>unique_function_record <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>unique_rec,
                            <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>text,
                            <font color='#0000FF'>const</font> std::type_info <font color='#5555FF'>*</font><font color='#0000FF'>const</font> <font color='#5555FF'>*</font>types,
                            <font color='#0000FF'><u>size_t</u></font> args<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#009900'>// Do NOT receive `unique_rec` by value. If this function fails to move out the unique_ptr,
</font>        <font color='#009900'>// we do not want this to destruct the pointer. `initialize` (the caller) still relies on
</font>        <font color='#009900'>// the pointee being alive after this call. Only move out if a `capsule` is going to keep
</font>        <font color='#009900'>// it alive.
</font>        <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>rec <font color='#5555FF'>=</font> unique_rec.<font color='#BB00BB'>get</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;

        <font color='#009900'>// Keep track of strdup'ed strings, and clean them up as long as the function's capsule
</font>        <font color='#009900'>// has not taken ownership yet (when `unique_rec.release()` is called).
</font>        <font color='#009900'>// Note: This cannot easily be fixed by a `unique_ptr` with custom deleter, because the
</font>        <font color='#009900'>// strings are only referenced before strdup'ing. So only *after* the following block could
</font>        <font color='#009900'>// `destruct` safely be called, but even then, `repr` could still throw in the middle of
</font>        <font color='#009900'>// copying all strings.
</font>        strdup_guard guarded_strdup;

        <font color='#009900'>/* Create copies of all referenced C-style strings */</font>
        rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name <font color='#5555FF'>=</font> <font color='#BB00BB'>guarded_strdup</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name ? rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name : "<font color='#CC0000'></font>"<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc<font face='Lucida Console'>)</font> <b>{</b>
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc <font color='#5555FF'>=</font> <font color='#BB00BB'>guarded_strdup</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc<font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>a : rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>a.name<font face='Lucida Console'>)</font> <b>{</b>
                a.name <font color='#5555FF'>=</font> <font color='#BB00BB'>guarded_strdup</font><font face='Lucida Console'>(</font>a.name<font face='Lucida Console'>)</font>;
            <b>}</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>a.descr<font face='Lucida Console'>)</font> <b>{</b>
                a.descr <font color='#5555FF'>=</font> <font color='#BB00BB'>guarded_strdup</font><font face='Lucida Console'>(</font>a.descr<font face='Lucida Console'>)</font>;
            <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>a.value<font face='Lucida Console'>)</font> <b>{</b>
                a.descr <font color='#5555FF'>=</font> <font color='#BB00BB'>guarded_strdup</font><font face='Lucida Console'>(</font><font color='#BB00BB'>repr</font><font face='Lucida Console'>(</font>a.value<font face='Lucida Console'>)</font>.cast<font color='#5555FF'>&lt;</font>std::string<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <b>}</b>
        <b>}</b>

        rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_constructor <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font>std::<font color='#BB00BB'>strcmp</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name, "<font color='#CC0000'>__init__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>0</font><font face='Lucida Console'>)</font>
                              <font color='#5555FF'>|</font><font color='#5555FF'>|</font> <font face='Lucida Console'>(</font>std::<font color='#BB00BB'>strcmp</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name, "<font color='#CC0000'>__setstate__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>0</font><font face='Lucida Console'>)</font>;

<font color='#0000FF'>#if</font> defined<font face='Lucida Console'>(</font>PYBIND11_DETAILED_ERROR_MESSAGES<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font>defined<font face='Lucida Console'>(</font>PYBIND11_DISABLE_NEW_STYLE_INIT_WARNING<font face='Lucida Console'>)</font>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_constructor <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_new_style_constructor<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> class_name
                <font color='#5555FF'>=</font> detail::<font color='#BB00BB'>get_fully_qualified_tp_name</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> func_name <font color='#5555FF'>=</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name<font face='Lucida Console'>)</font>;
            <font color='#BB00BB'>PyErr_WarnEx</font><font face='Lucida Console'>(</font>PyExc_FutureWarning,
                         <font face='Lucida Console'>(</font>"<font color='#CC0000'>pybind11-bound class '</font>" <font color='#5555FF'>+</font> class_name
                          <font color='#5555FF'>+</font> "<font color='#CC0000'>' is using an old-style </font>"
                            "<font color='#CC0000'>placement-new '</font>"
                          <font color='#5555FF'>+</font> func_name
                          <font color='#5555FF'>+</font> "<font color='#CC0000'>' which has been deprecated. See </font>"
                            "<font color='#CC0000'>the upgrade guide in pybind11's docs. This message is only visible </font>"
                            "<font color='#CC0000'>when compiled in debug mode.</font>"<font face='Lucida Console'>)</font>
                             .<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                         <font color='#979000'>0</font><font face='Lucida Console'>)</font>;
        <b>}</b>
<font color='#0000FF'>#endif</font>

        <font color='#009900'>/* Generate a proper function signature */</font>
        std::string signature;
        <font color='#0000FF'><u>size_t</u></font> type_index <font color='#5555FF'>=</font> <font color='#979000'>0</font>, arg_index <font color='#5555FF'>=</font> <font color='#979000'>0</font>;
        <font color='#0000FF'><u>bool</u></font> is_starred <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
        <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>pc <font color='#5555FF'>=</font> text; <font color='#5555FF'>*</font>pc <font color='#5555FF'>!</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\0</font>'; <font color='#5555FF'>+</font><font color='#5555FF'>+</font>pc<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> c <font color='#5555FF'>=</font> <font color='#5555FF'>*</font>pc;

            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>c <font color='#5555FF'>=</font><font color='#5555FF'>=</font> '<font color='#FF0000'>{</font>'<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#009900'>// Write arg name for everything except *args and **kwargs.
</font>                is_starred <font color='#5555FF'>=</font> <font color='#5555FF'>*</font><font face='Lucida Console'>(</font>pc <font color='#5555FF'>+</font> <font color='#979000'>1</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> '<font color='#FF0000'>*</font>';
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>is_starred<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>continue</font>;
                <b>}</b>
                <font color='#009900'>// Separator for keyword-only arguments, placed before the kw
</font>                <font color='#009900'>// arguments start (unless we are already putting an *args)
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>has_args <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> arg_index <font color='#5555FF'>=</font><font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>nargs_pos<font face='Lucida Console'>)</font> <b>{</b>
                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>*, </font>";
                <b>}</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>arg_index <font color='#5555FF'>&lt;</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args[arg_index].name<font face='Lucida Console'>)</font> <b>{</b>
                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args[arg_index].name;
                <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>arg_index <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>0</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_method<font face='Lucida Console'>)</font> <b>{</b>
                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>self</font>";
                <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>arg</font>" <font color='#5555FF'>+</font> std::<font color='#BB00BB'>to_string</font><font face='Lucida Console'>(</font>arg_index <font color='#5555FF'>-</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_method ? <font color='#979000'>1</font> : <font color='#979000'>0</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                <b>}</b>
                signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>: </font>";
            <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>c <font color='#5555FF'>=</font><font color='#5555FF'>=</font> '<font color='#FF0000'>}</font>'<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#009900'>// Write default value if available.
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>is_starred <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> arg_index <font color='#5555FF'>&lt;</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args[arg_index].descr<font face='Lucida Console'>)</font> <b>{</b>
                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'> = </font>";
                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> detail::<font color='#BB00BB'>replace_newlines_and_squash</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args[arg_index].descr<font face='Lucida Console'>)</font>;
                <b>}</b>
                <font color='#009900'>// Separator for positional-only arguments (placed after the
</font>                <font color='#009900'>// argument, rather than before like *
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>nargs_pos_only <font color='#5555FF'>&gt;</font> <font color='#979000'>0</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font face='Lucida Console'>(</font>arg_index <font color='#5555FF'>+</font> <font color='#979000'>1</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>nargs_pos_only<font face='Lucida Console'>)</font> <b>{</b>
                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>, /</font>";
                <b>}</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>is_starred<font face='Lucida Console'>)</font> <b>{</b>
                    arg_index<font color='#5555FF'>+</font><font color='#5555FF'>+</font>;
                <b>}</b>
            <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>c <font color='#5555FF'>=</font><font color='#5555FF'>=</font> '<font color='#FF0000'>%</font>'<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>const</font> std::type_info <font color='#5555FF'>*</font>t <font color='#5555FF'>=</font> types[type_index<font color='#5555FF'>+</font><font color='#5555FF'>+</font>];
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>t<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>Internal error while parsing type signature (1)</font>"<font face='Lucida Console'>)</font>;
                <b>}</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>tinfo <font color='#5555FF'>=</font> detail::<font color='#BB00BB'>get_type_info</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>t<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    handle <font color='#BB00BB'>th</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>type<font face='Lucida Console'>)</font>;
                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> th.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__module__</font>"<font face='Lucida Console'>)</font>.cast<font color='#5555FF'>&lt;</font>std::string<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>.</font>"
                                 <font color='#5555FF'>+</font> th.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__qualname__</font>"<font face='Lucida Console'>)</font>.cast<font color='#5555FF'>&lt;</font>std::string<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_new_style_constructor <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> arg_index <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>0</font><font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#009900'>// A new-style `__init__` takes `self` as `value_and_holder`.
</font>                    <font color='#009900'>// Rewrite it to the proper class type.
</font>                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__module__</font>"<font face='Lucida Console'>)</font>.cast<font color='#5555FF'>&lt;</font>std::string<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>.</font>"
                                 <font color='#5555FF'>+</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__qualname__</font>"<font face='Lucida Console'>)</font>.cast<font color='#5555FF'>&lt;</font>std::string<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                    signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> detail::<font color='#BB00BB'>quote_cpp_type_name</font><font face='Lucida Console'>(</font>detail::<font color='#BB00BB'>clean_type_id</font><font face='Lucida Console'>(</font>t<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#BB00BB'>name</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                <b>}</b>
            <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                signature <font color='#5555FF'>+</font><font color='#5555FF'>=</font> c;
            <b>}</b>
        <b>}</b>

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>arg_index <font color='#5555FF'>!</font><font color='#5555FF'>=</font> args <font color='#5555FF'>-</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>has_args <font color='#5555FF'>-</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>has_kwargs <font color='#5555FF'>|</font><font color='#5555FF'>|</font> types[type_index] <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>Internal error while parsing type signature (2)</font>"<font face='Lucida Console'>)</font>;
        <b>}</b>

        rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>signature <font color='#5555FF'>=</font> <font color='#BB00BB'>guarded_strdup</font><font face='Lucida Console'>(</font>signature.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args.<font color='#BB00BB'>shrink_to_fit</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>nargs <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font>std::uint16_t<font face='Lucida Console'>)</font> args;

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>sibling <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#BB00BB'>PYBIND11_INSTANCE_METHOD_CHECK</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>sibling.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>sibling <font color='#5555FF'>=</font> <font color='#BB00BB'>PYBIND11_INSTANCE_METHOD_GET_FUNCTION</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>sibling.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <b>}</b>

        detail::function_record <font color='#5555FF'>*</font>chain <font color='#5555FF'>=</font> nullptr, <font color='#5555FF'>*</font>chain_start <font color='#5555FF'>=</font> rec;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>sibling<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#BB00BB'>PyCFunction_Check</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>sibling.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>self <font color='#5555FF'>=</font> <font color='#BB00BB'>PyCFunction_GET_SELF</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>sibling.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>isinstance<font color='#5555FF'>&lt;</font>capsule<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>self<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    chain <font color='#5555FF'>=</font> nullptr;
                <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                    <font color='#0000FF'>auto</font> rec_capsule <font color='#5555FF'>=</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>capsule<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>self<font face='Lucida Console'>)</font>;
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>detail::<font color='#BB00BB'>is_function_record_capsule</font><font face='Lucida Console'>(</font>rec_capsule<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                        chain <font color='#5555FF'>=</font> rec_capsule.get_pointer<font color='#5555FF'>&lt;</font>detail::function_record<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                        <font color='#009900'>/* Never append a method to an overload chain of a parent class;
                           instead, hide the parent's overloads in this case */</font>
                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>chain<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>is</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                            chain <font color='#5555FF'>=</font> nullptr;
                        <b>}</b>
                    <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                        chain <font color='#5555FF'>=</font> nullptr;
                    <b>}</b>
                <b>}</b>
            <b>}</b>
            <font color='#009900'>// Don't trigger for things like the default __init__, which are wrapper_descriptors
</font>            <font color='#009900'>// that we are intentionally replacing
</font>            <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>sibling.<font color='#BB00BB'>is_none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name[<font color='#979000'>0</font>] <font color='#5555FF'>!</font><font color='#5555FF'>=</font> '<font color='#FF0000'>_</font>'<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>Cannot overload existing non-function object \"</font>"
                              <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>\" with a function of the same name</font>"<font face='Lucida Console'>)</font>;
            <b>}</b>
        <b>}</b>

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>chain<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#009900'>/* No existing overload was found, create a new function object */</font>
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def <font color='#5555FF'>=</font> <font color='#0000FF'>new</font> <font color='#BB00BB'>PyMethodDef</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            std::<font color='#BB00BB'>memset</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def, <font color='#979000'>0</font>, <font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font>PyMethodDef<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>ml_name <font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name;
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>ml_meth
                <font color='#5555FF'>=</font> <font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font>PyCFunction<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>void</u></font> <font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>dispatcher<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>ml_flags <font color='#5555FF'>=</font> METH_VARARGS <font color='#5555FF'>|</font> METH_KEYWORDS;

            capsule <font color='#BB00BB'>rec_capsule</font><font face='Lucida Console'>(</font>unique_rec.<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                                detail::<font color='#BB00BB'>get_function_record_capsule_name</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                                []<font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font>ptr<font face='Lucida Console'>)</font> <b>{</b> <font color='#BB00BB'>destruct</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>detail::function_record <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> ptr<font face='Lucida Console'>)</font>; <b>}</b><font face='Lucida Console'>)</font>;
            guarded_strdup.<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;

            object scope_module;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#BB00BB'>hasattr</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope, "<font color='#CC0000'>__module__</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    scope_module <font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__module__</font>"<font face='Lucida Console'>)</font>;
                <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#BB00BB'>hasattr</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope, "<font color='#CC0000'>__name__</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    scope_module <font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__name__</font>"<font face='Lucida Console'>)</font>;
                <b>}</b>
            <b>}</b>

            m_ptr <font color='#5555FF'>=</font> <font color='#BB00BB'>PyCFunction_NewEx</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def, rec_capsule.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, scope_module.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>m_ptr<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>cpp_function::cpp_function(): Could not allocate function object</font>"<font face='Lucida Console'>)</font>;
            <b>}</b>
        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
            <font color='#009900'>/* Append at the beginning or end of the overload chain */</font>
            m_ptr <font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>sibling.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <font color='#BB00BB'>inc_ref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>chain<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_method <font color='#5555FF'>!</font><font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_method<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>
                    "<font color='#CC0000'>overloading a method with both static and instance methods is not supported; </font>"
<font color='#0000FF'>#if</font> <font color='#5555FF'>!</font>defined<font face='Lucida Console'>(</font>PYBIND11_DETAILED_ERROR_MESSAGES<font face='Lucida Console'>)</font>
                    "<font color='#CC0000'>#define PYBIND11_DETAILED_ERROR_MESSAGES or compile in debug mode for more </font>"
                    "<font color='#CC0000'>details</font>"
<font color='#0000FF'>#else</font>
                    "<font color='#CC0000'>error while attempting to bind </font>"
                    <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_method ? "<font color='#CC0000'>instance</font>" : "<font color='#CC0000'>static</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'> method </font>"
                    <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__name__</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>.</font>"
                    <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> signature
<font color='#0000FF'>#endif</font>
                <font face='Lucida Console'>)</font>;
            <b>}</b>

            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>prepend<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#009900'>// Beginning of chain; we need to replace the capsule's current head-of-the-chain
</font>                <font color='#009900'>// pointer with this one, then make this one point to the previous head of the
</font>                <font color='#009900'>// chain.
</font>                chain_start <font color='#5555FF'>=</font> rec;
                rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>next <font color='#5555FF'>=</font> chain;
                <font color='#0000FF'>auto</font> rec_capsule
                    <font color='#5555FF'>=</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>capsule<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyCFunctionObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> m_ptr<font face='Lucida Console'>)</font><font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>m_self<font face='Lucida Console'>)</font>;
                rec_capsule.<font color='#BB00BB'>set_pointer</font><font face='Lucida Console'>(</font>unique_rec.<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                guarded_strdup.<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                <font color='#009900'>// Or end of chain (normal behavior)
</font>                chain_start <font color='#5555FF'>=</font> chain;
                <font color='#0000FF'>while</font> <font face='Lucida Console'>(</font>chain<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>next<font face='Lucida Console'>)</font> <b>{</b>
                    chain <font color='#5555FF'>=</font> chain<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>next;
                <b>}</b>
                chain<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>next <font color='#5555FF'>=</font> unique_rec.<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                guarded_strdup.<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <b>}</b>
        <b>}</b>

        std::string signatures;
        <font color='#0000FF'><u>int</u></font> index <font color='#5555FF'>=</font> <font color='#979000'>0</font>;
        <font color='#009900'>/* Create a nice pydoc rec including all signatures and
           docstrings of the functions in the overload chain */</font>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>chain <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> options::<font color='#BB00BB'>show_function_signatures</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#009900'>// First a generic signature
</font>            signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name;
            signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>(*args, **kwargs)\n</font>";
            signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>Overloaded function.\n\n</font>";
        <b>}</b>
        <font color='#009900'>// Then specific overload signatures
</font>        <font color='#0000FF'><u>bool</u></font> first_user_def <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
        <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>it <font color='#5555FF'>=</font> chain_start; it <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr; it <font color='#5555FF'>=</font> it<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>next<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>options::<font color='#BB00BB'>show_function_signatures</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>index <font color='#5555FF'>&gt;</font> <font color='#979000'>0</font><font face='Lucida Console'>)</font> <b>{</b>
                    signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\n</font>';
                <b>}</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>chain<font face='Lucida Console'>)</font> <b>{</b>
                    signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> std::<font color='#BB00BB'>to_string</font><font face='Lucida Console'>(</font><font color='#5555FF'>+</font><font color='#5555FF'>+</font>index<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>. </font>";
                <b>}</b>
                signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name;
                signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> it<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>signature;
                signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\n</font>';
            <b>}</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>it<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> it<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc[<font color='#979000'>0</font>] <font color='#5555FF'>!</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\0</font>' <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> options::<font color='#BB00BB'>show_user_defined_docstrings</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#009900'>// If we're appending another docstring, and aren't printing function signatures,
</font>                <font color='#009900'>// we need to append a newline first:
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>options::<font color='#BB00BB'>show_function_signatures</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>first_user_def<font face='Lucida Console'>)</font> <b>{</b>
                        first_user_def <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
                    <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                        signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\n</font>';
                    <b>}</b>
                <b>}</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>options::<font color='#BB00BB'>show_function_signatures</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\n</font>';
                <b>}</b>
                signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> it<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc;
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>options::<font color='#BB00BB'>show_function_signatures</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    signatures <font color='#5555FF'>+</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\n</font>';
                <b>}</b>
            <b>}</b>
        <b>}</b>

        <font color='#009900'>/* Install docstring */</font>
        <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>func <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font>PyCFunctionObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> m_ptr;
        std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font><font color='#0000FF'>const_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>func<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>m_ml<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>ml_doc<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#009900'>// Install docstring if it's non-empty (when at least one option is enabled)
</font>        func<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>m_ml<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>ml_doc
            <font color='#5555FF'>=</font> signatures.<font color='#BB00BB'>empty</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> ? nullptr : <font color='#BB00BB'>PYBIND11_COMPAT_STRDUP</font><font face='Lucida Console'>(</font>signatures.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_method<font face='Lucida Console'>)</font> <b>{</b>
            m_ptr <font color='#5555FF'>=</font> <font color='#BB00BB'>PYBIND11_INSTANCE_METHOD_NEW</font><font face='Lucida Console'>(</font>m_ptr, rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>m_ptr<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>
                    "<font color='#CC0000'>cpp_function::cpp_function(): Could not allocate instance method object</font>"<font face='Lucida Console'>)</font>;
            <b>}</b>
            <font color='#BB00BB'>Py_DECREF</font><font face='Lucida Console'>(</font>func<font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b>

    <font color='#009900'>/// When a cpp_function is GCed, release any memory allocated by pybind11
</font>    <font color='#0000FF'>static</font> <font color='#0000FF'><u>void</u></font> <b><a name='destruct'></a>destruct</b><font face='Lucida Console'>(</font>detail::function_record <font color='#5555FF'>*</font>rec, <font color='#0000FF'><u>bool</u></font> free_strings <font color='#5555FF'>=</font> <font color='#979000'>true</font><font face='Lucida Console'>)</font> <b>{</b>
<font color='#009900'>// If on Python 3.9, check the interpreter "MICRO" (patch) version.
</font><font color='#009900'>// If this is running on 3.9.0, we have to work around a bug.
</font><font color='#0000FF'>#if</font> <font color='#5555FF'>!</font>defined<font face='Lucida Console'>(</font>PYPY_VERSION<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> PY_MAJOR_VERSION <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>3</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> PY_MINOR_VERSION <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>9</font>
        <font color='#0000FF'>static</font> <font color='#0000FF'><u>bool</u></font> is_zero <font color='#5555FF'>=</font> <font color='#BB00BB'>Py_GetVersion</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>[<font color='#979000'>4</font>] <font color='#5555FF'>=</font><font color='#5555FF'>=</font> '<font color='#FF0000'>0</font>';
<font color='#0000FF'>#endif</font>

        <font color='#0000FF'>while</font> <font face='Lucida Console'>(</font>rec<font face='Lucida Console'>)</font> <b>{</b>
            detail::function_record <font color='#5555FF'>*</font>next <font color='#5555FF'>=</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>next;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>free_data<font face='Lucida Console'>)</font> <b>{</b>
                rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#BB00BB'>free_data</font><font face='Lucida Console'>(</font>rec<font face='Lucida Console'>)</font>;
            <b>}</b>
            <font color='#009900'>// During initialization, these strings might not have been copied yet,
</font>            <font color='#009900'>// so they cannot be freed. Once the function has been created, they can.
</font>            <font color='#009900'>// Check `make_function_record` for more details.
</font>            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>free_strings<font face='Lucida Console'>)</font> <b>{</b>
                std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name<font face='Lucida Console'>)</font>;
                std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc<font face='Lucida Console'>)</font>;
                std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>signature<font face='Lucida Console'>)</font>;
                <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>arg : rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args<font face='Lucida Console'>)</font> <b>{</b>
                    std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font><font color='#0000FF'>const_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>arg.name<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                    std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font><font color='#0000FF'>const_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>arg.descr<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                <b>}</b>
            <b>}</b>
            <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>arg : rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>args<font face='Lucida Console'>)</font> <b>{</b>
                arg.value.<font color='#BB00BB'>dec_ref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <b>}</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def<font face='Lucida Console'>)</font> <b>{</b>
                std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font><font color='#0000FF'>const_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>ml_doc<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
<font color='#009900'>// Python 3.9.0 decref's these in the wrong order; rec-&gt;def
</font><font color='#009900'>// If loaded on 3.9.0, let these leak (use Python 3.9.1 at runtime to fix)
</font><font color='#009900'>// See https://github.com/python/cpython/pull/22670
</font><font color='#0000FF'>#if</font> <font color='#5555FF'>!</font>defined<font face='Lucida Console'>(</font>PYPY_VERSION<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> PY_MAJOR_VERSION <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>3</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> PY_MINOR_VERSION <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>9</font>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>is_zero<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>delete</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def;
                <b>}</b>
<font color='#0000FF'>#else</font>
                <font color='#0000FF'>delete</font> rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>def;
<font color='#0000FF'>#endif</font>
            <b>}</b>
            <font color='#0000FF'>delete</font> rec;
            rec <font color='#5555FF'>=</font> next;
        <b>}</b>
    <b>}</b>

    <font color='#009900'>/// Main dispatch logic for calls to functions bound using pybind11
</font>    <font color='#0000FF'>static</font> PyObject <font color='#5555FF'>*</font><b><a name='dispatcher'></a>dispatcher</b><font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font>self, PyObject <font color='#5555FF'>*</font>args_in, PyObject <font color='#5555FF'>*</font>kwargs_in<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>using</font> <font color='#0000FF'>namespace</font> detail;
        <font color='#BB00BB'>assert</font><font face='Lucida Console'>(</font>isinstance<font color='#5555FF'>&lt;</font>capsule<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>self<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

        <font color='#009900'>/* Iterator over the list of potentially admissible overloads */</font>
        <font color='#0000FF'>const</font> function_record <font color='#5555FF'>*</font>overloads <font color='#5555FF'>=</font> <font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font>function_record <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>
                                  <font color='#BB00BB'>PyCapsule_GetPointer</font><font face='Lucida Console'>(</font>self, <font color='#BB00BB'>get_function_record_capsule_name</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                              <font color='#5555FF'>*</font>current_overload <font color='#5555FF'>=</font> overloads;
        <font color='#BB00BB'>assert</font><font face='Lucida Console'>(</font>overloads <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font>;

        <font color='#009900'>/* Need to know how many arguments + keyword arguments there are to pick the right
           overload */</font>
        <font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> n_args_in <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font><font color='#0000FF'><u>size_t</u></font><font face='Lucida Console'>)</font> <font color='#BB00BB'>PyTuple_GET_SIZE</font><font face='Lucida Console'>(</font>args_in<font face='Lucida Console'>)</font>;

        handle parent <font color='#5555FF'>=</font> n_args_in <font color='#5555FF'>&gt;</font> <font color='#979000'>0</font> ? <font color='#BB00BB'>PyTuple_GET_ITEM</font><font face='Lucida Console'>(</font>args_in, <font color='#979000'>0</font><font face='Lucida Console'>)</font> : nullptr,
               result <font color='#5555FF'>=</font> PYBIND11_TRY_NEXT_OVERLOAD;

        <font color='#0000FF'>auto</font> self_value_and_holder <font color='#5555FF'>=</font> <font color='#BB00BB'>value_and_holder</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>overloads<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_constructor<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>parent
                <font color='#5555FF'>|</font><font color='#5555FF'>|</font> <font color='#5555FF'>!</font><font color='#BB00BB'>PyObject_TypeCheck</font><font face='Lucida Console'>(</font>parent.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, <font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> overloads<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#BB00BB'>set_error</font><font face='Lucida Console'>(</font>PyExc_TypeError,
                          "<font color='#CC0000'>__init__(self, ...) called with invalid or missing `self` argument</font>"<font face='Lucida Console'>)</font>;
                <font color='#0000FF'>return</font> nullptr;
            <b>}</b>

            <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font><font color='#0000FF'>const</font> tinfo <font color='#5555FF'>=</font> <font color='#BB00BB'>get_type_info</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> overloads<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font><font color='#0000FF'>const</font> pi <font color='#5555FF'>=</font> <font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font>instance <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>parent.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            self_value_and_holder <font color='#5555FF'>=</font> pi<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#BB00BB'>get_value_and_holder</font><font face='Lucida Console'>(</font>tinfo, <font color='#979000'>true</font><font face='Lucida Console'>)</font>;

            <font color='#009900'>// If this value is already registered it must mean __init__ is invoked multiple times;
</font>            <font color='#009900'>// we really can't support that in C++, so just ignore the second __init__.
</font>            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>self_value_and_holder.<font color='#BB00BB'>instance_registered</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>return</font> <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <b>}</b>
        <b>}</b>

        <font color='#0000FF'>try</font> <b>{</b>
            <font color='#009900'>// We do this in two passes: in the first pass, we load arguments with `convert=false`;
</font>            <font color='#009900'>// in the second, we allow conversion (except for arguments with an explicit
</font>            <font color='#009900'>// py::arg().noconvert()).  This lets us prefer calls without conversion, with
</font>            <font color='#009900'>// conversion as a fallback.
</font>            std::vector<font color='#5555FF'>&lt;</font>function_call<font color='#5555FF'>&gt;</font> second_pass;

            <font color='#009900'>// However, if there are no overloads, we can just skip the no-convert pass entirely
</font>            <font color='#0000FF'>const</font> <font color='#0000FF'><u>bool</u></font> overloaded
                <font color='#5555FF'>=</font> current_overload <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> current_overload<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>next <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr;

            <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font>; current_overload <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr; current_overload <font color='#5555FF'>=</font> current_overload<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>next<font face='Lucida Console'>)</font> <b>{</b>

                <font color='#009900'>/* For each overload:
                   1. Copy all positional arguments we were given, also checking to make sure that
                      named positional arguments weren't *also* specified via kwarg.
                   2. If we weren't given enough, try to make up the omitted ones by checking
                      whether they were provided by a kwarg matching the `py::arg("name")` name. If
                      so, use it (and remove it from kwargs); if not, see if the function binding
                      provided a default that we can use.
                   3. Ensure that either all keyword arguments were "consumed", or that the
                   function takes a kwargs argument to accept unconsumed kwargs.
                   4. Any positional arguments still left get put into a tuple (for args), and any
                      leftover kwargs get put into a dict.
                   5. Pack everything into a vector; if we have py::args or py::kwargs, they are an
                      extra tuple or dict at the end of the positional arguments.
                   6. Call the function call dispatcher (function_record::impl)

                   If one of these fail, move on to the next overload and keep trying until we get
                   a result other than PYBIND11_TRY_NEXT_OVERLOAD.
                 */</font>

                <font color='#0000FF'>const</font> function_record <font color='#5555FF'>&amp;</font>func <font color='#5555FF'>=</font> <font color='#5555FF'>*</font>current_overload;
                <font color='#0000FF'><u>size_t</u></font> num_args <font color='#5555FF'>=</font> func.nargs; <font color='#009900'>// Number of positional arguments that we need
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>func.has_args<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#5555FF'>-</font><font color='#5555FF'>-</font>num_args; <font color='#009900'>// (but don't count py::args
</font>                <b>}</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>func.has_kwargs<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#5555FF'>-</font><font color='#5555FF'>-</font>num_args; <font color='#009900'>//  or py::kwargs)
</font>                <b>}</b>
                <font color='#0000FF'><u>size_t</u></font> pos_args <font color='#5555FF'>=</font> func.nargs_pos;

                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>func.has_args <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> n_args_in <font color='#5555FF'>&gt;</font> pos_args<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>continue</font>; <font color='#009900'>// Too many positional arguments for this overload
</font>                <b>}</b>

                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>n_args_in <font color='#5555FF'>&lt;</font> pos_args <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> func.args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&lt;</font> pos_args<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>continue</font>; <font color='#009900'>// Not enough positional arguments given, and not enough defaults to
</font>                              <font color='#009900'>// fill in the blanks
</font>                <b>}</b>

                function_call <font color='#BB00BB'>call</font><font face='Lucida Console'>(</font>func, parent<font face='Lucida Console'>)</font>;

                <font color='#009900'>// Protect std::min with parentheses
</font>                <font color='#0000FF'><u>size_t</u></font> args_to_copy <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font>std::min<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>pos_args, n_args_in<font face='Lucida Console'>)</font>;
                <font color='#0000FF'><u>size_t</u></font> args_copied <font color='#5555FF'>=</font> <font color='#979000'>0</font>;

                <font color='#009900'>// 0. Inject new-style `self` argument
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>func.is_new_style_constructor<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#009900'>// The `value` may have been preallocated by an old-style `__init__`
</font>                    <font color='#009900'>// if it was a preceding candidate for overload resolution.
</font>                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>self_value_and_holder<font face='Lucida Console'>)</font> <b>{</b>
                        self_value_and_holder.type<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#BB00BB'>dealloc</font><font face='Lucida Console'>(</font>self_value_and_holder<font face='Lucida Console'>)</font>;
                    <b>}</b>

                    call.init_self <font color='#5555FF'>=</font> <font color='#BB00BB'>PyTuple_GET_ITEM</font><font face='Lucida Console'>(</font>args_in, <font color='#979000'>0</font><font face='Lucida Console'>)</font>;
                    call.args.<font color='#BB00BB'>emplace_back</font><font face='Lucida Console'>(</font><font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font>PyObject <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#5555FF'>&amp;</font>self_value_and_holder<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                    call.args_convert.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font><font color='#979000'>false</font><font face='Lucida Console'>)</font>;
                    <font color='#5555FF'>+</font><font color='#5555FF'>+</font>args_copied;
                <b>}</b>

                <font color='#009900'>// 1. Copy any position arguments given.
</font>                <font color='#0000FF'><u>bool</u></font> bad_arg <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
                <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font>; args_copied <font color='#5555FF'>&lt;</font> args_to_copy; <font color='#5555FF'>+</font><font color='#5555FF'>+</font>args_copied<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>const</font> argument_record <font color='#5555FF'>*</font>arg_rec
                        <font color='#5555FF'>=</font> args_copied <font color='#5555FF'>&lt;</font> func.args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> ? <font color='#5555FF'>&amp;</font>func.args[args_copied] : nullptr;
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>kwargs_in <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> arg_rec <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> arg_rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name
                        <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#BB00BB'>dict_getitemstring</font><font face='Lucida Console'>(</font>kwargs_in, arg_rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                        bad_arg <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
                        <font color='#0000FF'>break</font>;
                    <b>}</b>

                    handle <font color='#BB00BB'>arg</font><font face='Lucida Console'>(</font><font color='#BB00BB'>PyTuple_GET_ITEM</font><font face='Lucida Console'>(</font>args_in, args_copied<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>arg_rec <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font>arg_rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>none <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> arg.<font color='#BB00BB'>is_none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                        bad_arg <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
                        <font color='#0000FF'>break</font>;
                    <b>}</b>
                    call.args.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font>;
                    call.args_convert.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>arg_rec ? arg_rec<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>convert : <font color='#979000'>true</font><font face='Lucida Console'>)</font>;
                <b>}</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>bad_arg<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>continue</font>; <font color='#009900'>// Maybe it was meant for another overload (issue #688)
</font>                <b>}</b>

                <font color='#009900'>// Keep track of how many position args we copied out in case we need to come back
</font>                <font color='#009900'>// to copy the rest into a py::args argument.
</font>                <font color='#0000FF'><u>size_t</u></font> positional_args_copied <font color='#5555FF'>=</font> args_copied;

                <font color='#009900'>// We'll need to copy this if we steal some kwargs for defaults
</font>                dict kwargs <font color='#5555FF'>=</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>dict<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>kwargs_in<font face='Lucida Console'>)</font>;

                <font color='#009900'>// 1.5. Fill in any missing pos_only args from defaults if they exist
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>args_copied <font color='#5555FF'>&lt;</font> func.nargs_pos_only<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font>; args_copied <font color='#5555FF'>&lt;</font> func.nargs_pos_only; <font color='#5555FF'>+</font><font color='#5555FF'>+</font>args_copied<font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>arg_rec <font color='#5555FF'>=</font> func.args[args_copied];
                        handle value;

                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>arg_rec.value<font face='Lucida Console'>)</font> <b>{</b>
                            value <font color='#5555FF'>=</font> arg_rec.value;
                        <b>}</b>
                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font> <b>{</b>
                            call.args.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font>;
                            call.args_convert.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>arg_rec.convert<font face='Lucida Console'>)</font>;
                        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                            <font color='#0000FF'>break</font>;
                        <b>}</b>
                    <b>}</b>

                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>args_copied <font color='#5555FF'>&lt;</font> func.nargs_pos_only<font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#0000FF'>continue</font>; <font color='#009900'>// Not enough defaults to fill the positional arguments
</font>                    <b>}</b>
                <b>}</b>

                <font color='#009900'>// 2. Check kwargs and, failing that, defaults that may help complete the list
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>args_copied <font color='#5555FF'>&lt;</font> num_args<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'><u>bool</u></font> copied_kwargs <font color='#5555FF'>=</font> <font color='#979000'>false</font>;

                    <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font>; args_copied <font color='#5555FF'>&lt;</font> num_args; <font color='#5555FF'>+</font><font color='#5555FF'>+</font>args_copied<font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>arg_rec <font color='#5555FF'>=</font> func.args[args_copied];

                        handle value;
                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>kwargs_in <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> arg_rec.name<font face='Lucida Console'>)</font> <b>{</b>
                            value <font color='#5555FF'>=</font> <font color='#BB00BB'>dict_getitemstring</font><font face='Lucida Console'>(</font>kwargs.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, arg_rec.name<font face='Lucida Console'>)</font>;
                        <b>}</b>

                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font> <b>{</b>
                            <font color='#009900'>// Consume a kwargs value
</font>                            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>copied_kwargs<font face='Lucida Console'>)</font> <b>{</b>
                                kwargs <font color='#5555FF'>=</font> reinterpret_steal<font color='#5555FF'>&lt;</font>dict<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#BB00BB'>PyDict_Copy</font><font face='Lucida Console'>(</font>kwargs.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                                copied_kwargs <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
                            <b>}</b>
                            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#BB00BB'>PyDict_DelItemString</font><font face='Lucida Console'>(</font>kwargs.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, arg_rec.name<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#5555FF'>-</font><font color='#979000'>1</font><font face='Lucida Console'>)</font> <b>{</b>
                                <font color='#0000FF'>throw</font> <font color='#BB00BB'>error_already_set</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                            <b>}</b>
                        <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>arg_rec.value<font face='Lucida Console'>)</font> <b>{</b>
                            value <font color='#5555FF'>=</font> arg_rec.value;
                        <b>}</b>

                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>arg_rec.none <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> value.<font color='#BB00BB'>is_none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                            <font color='#0000FF'>break</font>;
                        <b>}</b>

                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font> <b>{</b>
                            <font color='#009900'>// If we're at the py::args index then first insert a stub for it to be
</font>                            <font color='#009900'>// replaced later
</font>                            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>func.has_args <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> call.args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> func.nargs_pos<font face='Lucida Console'>)</font> <b>{</b>
                                call.args.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font><font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                            <b>}</b>

                            call.args.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font>;
                            call.args_convert.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>arg_rec.convert<font face='Lucida Console'>)</font>;
                        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                            <font color='#0000FF'>break</font>;
                        <b>}</b>
                    <b>}</b>

                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>args_copied <font color='#5555FF'>&lt;</font> num_args<font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#0000FF'>continue</font>; <font color='#009900'>// Not enough arguments, defaults, or kwargs to fill the
</font>                                  <font color='#009900'>// positional arguments
</font>                    <b>}</b>
                <b>}</b>

                <font color='#009900'>// 3. Check everything was consumed (unless we have a kwargs arg)
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>kwargs <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font>kwargs.<font color='#BB00BB'>empty</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font>func.has_kwargs<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>continue</font>; <font color='#009900'>// Unconsumed kwargs, but no py::kwargs argument to accept them
</font>                <b>}</b>

                <font color='#009900'>// 4a. If we have a py::args argument, create a new tuple with leftovers
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>func.has_args<font face='Lucida Console'>)</font> <b>{</b>
                    tuple extra_args;
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>args_to_copy <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>0</font><font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#009900'>// We didn't copy out any position arguments from the args_in tuple, so we
</font>                        <font color='#009900'>// can reuse it directly without copying:
</font>                        extra_args <font color='#5555FF'>=</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>tuple<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>args_in<font face='Lucida Console'>)</font>;
                    <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>positional_args_copied <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> n_args_in<font face='Lucida Console'>)</font> <b>{</b>
                        extra_args <font color='#5555FF'>=</font> <font color='#BB00BB'>tuple</font><font face='Lucida Console'>(</font><font color='#979000'>0</font><font face='Lucida Console'>)</font>;
                    <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                        <font color='#0000FF'><u>size_t</u></font> args_size <font color='#5555FF'>=</font> n_args_in <font color='#5555FF'>-</font> positional_args_copied;
                        extra_args <font color='#5555FF'>=</font> <font color='#BB00BB'>tuple</font><font face='Lucida Console'>(</font>args_size<font face='Lucida Console'>)</font>;
                        <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'><u>size_t</u></font> i <font color='#5555FF'>=</font> <font color='#979000'>0</font>; i <font color='#5555FF'>&lt;</font> args_size; <font color='#5555FF'>+</font><font color='#5555FF'>+</font>i<font face='Lucida Console'>)</font> <b>{</b>
                            extra_args[i] <font color='#5555FF'>=</font> <font color='#BB00BB'>PyTuple_GET_ITEM</font><font face='Lucida Console'>(</font>args_in, positional_args_copied <font color='#5555FF'>+</font> i<font face='Lucida Console'>)</font>;
                        <b>}</b>
                    <b>}</b>
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>call.args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>=</font> func.nargs_pos<font face='Lucida Console'>)</font> <b>{</b>
                        call.args.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>extra_args<font face='Lucida Console'>)</font>;
                    <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                        call.args[func.nargs_pos] <font color='#5555FF'>=</font> extra_args;
                    <b>}</b>
                    call.args_convert.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font><font color='#979000'>false</font><font face='Lucida Console'>)</font>;
                    call.args_ref <font color='#5555FF'>=</font> std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>extra_args<font face='Lucida Console'>)</font>;
                <b>}</b>

                <font color='#009900'>// 4b. If we have a py::kwargs, pass on any remaining kwargs
</font>                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>func.has_kwargs<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>kwargs.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                        kwargs <font color='#5555FF'>=</font> <font color='#BB00BB'>dict</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>; <font color='#009900'>// If we didn't get one, send an empty one
</font>                    <b>}</b>
                    call.args.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>kwargs<font face='Lucida Console'>)</font>;
                    call.args_convert.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font><font color='#979000'>false</font><font face='Lucida Console'>)</font>;
                    call.kwargs_ref <font color='#5555FF'>=</font> std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>kwargs<font face='Lucida Console'>)</font>;
                <b>}</b>

<font color='#009900'>// 5. Put everything in a vector.  Not technically step 5, we've been building it
</font><font color='#009900'>// in `call.args` all along.
</font><font color='#0000FF'>#if</font> defined<font face='Lucida Console'>(</font>PYBIND11_DETAILED_ERROR_MESSAGES<font face='Lucida Console'>)</font>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>call.args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>!</font><font color='#5555FF'>=</font> func.nargs <font color='#5555FF'>|</font><font color='#5555FF'>|</font> call.args_convert.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>!</font><font color='#5555FF'>=</font> func.nargs<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>Internal error: function call dispatcher inserted wrong number </font>"
                                  "<font color='#CC0000'>of arguments!</font>"<font face='Lucida Console'>)</font>;
                <b>}</b>
<font color='#0000FF'>#endif</font>

                std::vector<font color='#5555FF'>&lt;</font><font color='#0000FF'><u>bool</u></font><font color='#5555FF'>&gt;</font> second_pass_convert;
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>overloaded<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#009900'>// We're in the first no-convert pass, so swap out the conversion flags for a
</font>                    <font color='#009900'>// set of all-false flags.  If the call fails, we'll swap the flags back in for
</font>                    <font color='#009900'>// the conversion-allowed call below.
</font>                    second_pass_convert.<font color='#BB00BB'>resize</font><font face='Lucida Console'>(</font>func.nargs, <font color='#979000'>false</font><font face='Lucida Console'>)</font>;
                    call.args_convert.<font color='#BB00BB'>swap</font><font face='Lucida Console'>(</font>second_pass_convert<font face='Lucida Console'>)</font>;
                <b>}</b>

                <font color='#009900'>// 6. Call the function.
</font>                <font color='#0000FF'>try</font> <b>{</b>
                    loader_life_support guard<b>{</b><b>}</b>;
                    result <font color='#5555FF'>=</font> func.<font color='#BB00BB'>impl</font><font face='Lucida Console'>(</font>call<font face='Lucida Console'>)</font>;
                <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font>reference_cast_error <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <b>{</b>
                    result <font color='#5555FF'>=</font> PYBIND11_TRY_NEXT_OVERLOAD;
                <b>}</b>

                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>result.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>!</font><font color='#5555FF'>=</font> PYBIND11_TRY_NEXT_OVERLOAD<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>break</font>;
                <b>}</b>

                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>overloaded<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#009900'>// The (overloaded) call failed; if the call has at least one argument that
</font>                    <font color='#009900'>// permits conversion (i.e. it hasn't been explicitly specified `.noconvert()`)
</font>                    <font color='#009900'>// then add this call to the list of second pass overloads to try.
</font>                    <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'><u>size_t</u></font> i <font color='#5555FF'>=</font> func.is_method ? <font color='#979000'>1</font> : <font color='#979000'>0</font>; i <font color='#5555FF'>&lt;</font> pos_args; i<font color='#5555FF'>+</font><font color='#5555FF'>+</font><font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>second_pass_convert[i]<font face='Lucida Console'>)</font> <b>{</b>
                            <font color='#009900'>// Found one: swap the converting flags back in and store the call for
</font>                            <font color='#009900'>// the second pass.
</font>                            call.args_convert.<font color='#BB00BB'>swap</font><font face='Lucida Console'>(</font>second_pass_convert<font face='Lucida Console'>)</font>;
                            second_pass.<font color='#BB00BB'>push_back</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>call<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                            <font color='#0000FF'>break</font>;
                        <b>}</b>
                    <b>}</b>
                <b>}</b>
            <b>}</b>

            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>overloaded <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font>second_pass.<font color='#BB00BB'>empty</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> result.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> PYBIND11_TRY_NEXT_OVERLOAD<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#009900'>// The no-conversion pass finished without success, try again with conversion
</font>                <font color='#009900'>// allowed
</font>                <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>call : second_pass<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>try</font> <b>{</b>
                        loader_life_support guard<b>{</b><b>}</b>;
                        result <font color='#5555FF'>=</font> call.func.<font color='#BB00BB'>impl</font><font face='Lucida Console'>(</font>call<font face='Lucida Console'>)</font>;
                    <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font>reference_cast_error <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <b>{</b>
                        result <font color='#5555FF'>=</font> PYBIND11_TRY_NEXT_OVERLOAD;
                    <b>}</b>

                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>result.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>!</font><font color='#5555FF'>=</font> PYBIND11_TRY_NEXT_OVERLOAD<font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#009900'>// The error reporting logic below expects 'current_overload' to be valid,
</font>                        <font color='#009900'>// as it would be if we'd encountered this failure in the first-pass loop.
</font>                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>result<font face='Lucida Console'>)</font> <b>{</b>
                            current_overload <font color='#5555FF'>=</font> <font color='#5555FF'>&amp;</font>call.func;
                        <b>}</b>
                        <font color='#0000FF'>break</font>;
                    <b>}</b>
                <b>}</b>
            <b>}</b>
        <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font>error_already_set <font color='#5555FF'>&amp;</font>e<font face='Lucida Console'>)</font> <b>{</b>
            e.<font color='#BB00BB'>restore</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>return</font> nullptr;
<font color='#0000FF'>#ifdef</font> __GLIBCXX__
        <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font>abi::__forced_unwind <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>throw</font>;
<font color='#0000FF'>#endif</font>
        <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font>...<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#009900'>/* When an exception is caught, give each registered exception
               translator a chance to translate it to a Python exception. First
               all module-local translators will be tried in reverse order of
               registration. If none of the module-locale translators handle
               the exception (or there are no module-locale translators) then
               the global translators will be tried, also in reverse order of
               registration.

               A translator may choose to do one of the following:

                - catch the exception and call py::set_error()
                  to set a standard (or custom) Python exception, or
                - do nothing and let the exception fall through to the next translator, or
                - delegate translation to the next translator by throwing a new type of exception.
             */</font>

            <font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>local_exception_translators
                <font color='#5555FF'>=</font> <font color='#BB00BB'>get_local_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.registered_exception_translators;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>detail::<font color='#BB00BB'>apply_exception_translators</font><font face='Lucida Console'>(</font>local_exception_translators<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>return</font> nullptr;
            <b>}</b>
            <font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>exception_translators <font color='#5555FF'>=</font> <font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.registered_exception_translators;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>detail::<font color='#BB00BB'>apply_exception_translators</font><font face='Lucida Console'>(</font>exception_translators<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>return</font> nullptr;
            <b>}</b>

            <font color='#BB00BB'>set_error</font><font face='Lucida Console'>(</font>PyExc_SystemError, "<font color='#CC0000'>Exception escaped from default exception translator!</font>"<font face='Lucida Console'>)</font>;
            <font color='#0000FF'>return</font> nullptr;
        <b>}</b>

        <font color='#0000FF'>auto</font> append_note_if_missing_header_is_suspected <font color='#5555FF'>=</font> []<font face='Lucida Console'>(</font>std::string <font color='#5555FF'>&amp;</font>msg<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>msg.<font color='#BB00BB'>find</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>std::</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>!</font><font color='#5555FF'>=</font> std::string::npos<font face='Lucida Console'>)</font> <b>{</b>
                msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>\n\n</font>"
                       "<font color='#CC0000'>Did you forget to `#include &lt;pybind11/stl.h&gt;`? Or &lt;pybind11/complex.h&gt;,\n</font>"
                       "<font color='#CC0000'>&lt;pybind11/functional.h&gt;, &lt;pybind11/chrono.h&gt;, etc. Some automatic\n</font>"
                       "<font color='#CC0000'>conversions are optional and require extra headers to be included\n</font>"
                       "<font color='#CC0000'>when compiling your pybind11 module.</font>";
            <b>}</b>
        <b>}</b>;

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>result.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> PYBIND11_TRY_NEXT_OVERLOAD<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>overloads<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_operator<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>return</font> <font color='#BB00BB'>handle</font><font face='Lucida Console'>(</font>Py_NotImplemented<font face='Lucida Console'>)</font>.<font color='#BB00BB'>inc_ref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <b>}</b>

            std::string msg <font color='#5555FF'>=</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>overloads<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>name<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>(): incompatible </font>"
                              <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>overloads<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_constructor ? "<font color='#CC0000'>constructor</font>" : "<font color='#CC0000'>function</font>"<font face='Lucida Console'>)</font>
                              <font color='#5555FF'>+</font> "<font color='#CC0000'> arguments. The following argument types are supported:\n</font>";

            <font color='#0000FF'><u>int</u></font> ctr <font color='#5555FF'>=</font> <font color='#979000'>0</font>;
            <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>const</font> function_record <font color='#5555FF'>*</font>it2 <font color='#5555FF'>=</font> overloads; it2 <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr; it2 <font color='#5555FF'>=</font> it2<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>next<font face='Lucida Console'>)</font> <b>{</b>
                msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>    </font>" <font color='#5555FF'>+</font> std::<font color='#BB00BB'>to_string</font><font face='Lucida Console'>(</font><font color='#5555FF'>+</font><font color='#5555FF'>+</font>ctr<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>. </font>";

                <font color='#0000FF'><u>bool</u></font> wrote_sig <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>overloads<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_constructor<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#009900'>// For a constructor, rewrite `(self: Object, arg0, ...) -&gt; NoneType` as
</font>                    <font color='#009900'>// `Object(arg0, ...)`
</font>                    std::string sig <font color='#5555FF'>=</font> it2<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>signature;
                    <font color='#0000FF'><u>size_t</u></font> start <font color='#5555FF'>=</font> sig.<font color='#BB00BB'>find</font><font face='Lucida Console'>(</font>'<font color='#FF0000'>(</font>'<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> <font color='#979000'>7</font>; <font color='#009900'>// skip "(self: "
</font>                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>start <font color='#5555FF'>&lt;</font> sig.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#009900'>// End at the , for the next argument
</font>                        <font color='#0000FF'><u>size_t</u></font> end <font color='#5555FF'>=</font> sig.<font color='#BB00BB'>find</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>, </font>"<font face='Lucida Console'>)</font>, next <font color='#5555FF'>=</font> end <font color='#5555FF'>+</font> <font color='#979000'>2</font>;
                        <font color='#0000FF'><u>size_t</u></font> ret <font color='#5555FF'>=</font> sig.<font color='#BB00BB'>rfind</font><font face='Lucida Console'>(</font>"<font color='#CC0000'> -&gt; </font>"<font face='Lucida Console'>)</font>;
                        <font color='#009900'>// Or the ), if there is no comma:
</font>                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>end <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> sig.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                            next <font color='#5555FF'>=</font> end <font color='#5555FF'>=</font> sig.<font color='#BB00BB'>find</font><font face='Lucida Console'>(</font>'<font color='#FF0000'>)</font>'<font face='Lucida Console'>)</font>;
                        <b>}</b>
                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>start <font color='#5555FF'>&lt;</font> end <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> next <font color='#5555FF'>&lt;</font> sig.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                            msg.<font color='#BB00BB'>append</font><font face='Lucida Console'>(</font>sig, start, end <font color='#5555FF'>-</font> start<font face='Lucida Console'>)</font>;
                            msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> '<font color='#FF0000'>(</font>';
                            msg.<font color='#BB00BB'>append</font><font face='Lucida Console'>(</font>sig, next, ret <font color='#5555FF'>-</font> next<font face='Lucida Console'>)</font>;
                            wrote_sig <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
                        <b>}</b>
                    <b>}</b>
                <b>}</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>wrote_sig<font face='Lucida Console'>)</font> <b>{</b>
                    msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> it2<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>signature;
                <b>}</b>

                msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> '<font color='#FF0000'>\n</font>';
            <b>}</b>
            msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>\nInvoked with: </font>";
            <font color='#0000FF'>auto</font> args_ <font color='#5555FF'>=</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>tuple<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>args_in<font face='Lucida Console'>)</font>;
            <font color='#0000FF'><u>bool</u></font> some_args <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
            <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'><u>size_t</u></font> ti <font color='#5555FF'>=</font> overloads<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_constructor ? <font color='#979000'>1</font> : <font color='#979000'>0</font>; ti <font color='#5555FF'>&lt;</font> args_.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>; <font color='#5555FF'>+</font><font color='#5555FF'>+</font>ti<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>some_args<font face='Lucida Console'>)</font> <b>{</b>
                    some_args <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
                <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                    msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>, </font>";
                <b>}</b>
                <font color='#0000FF'>try</font> <b>{</b>
                    msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> pybind11::<font color='#BB00BB'>repr</font><font face='Lucida Console'>(</font>args_[ti]<font face='Lucida Console'>)</font>;
                <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font><font color='#0000FF'>const</font> error_already_set <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <b>{</b>
                    msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>&lt;repr raised Error&gt;</font>";
                <b>}</b>
            <b>}</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>kwargs_in<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>auto</font> kwargs <font color='#5555FF'>=</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>dict<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>kwargs_in<font face='Lucida Console'>)</font>;
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>kwargs.<font color='#BB00BB'>empty</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>some_args<font face='Lucida Console'>)</font> <b>{</b>
                        msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>; </font>";
                    <b>}</b>
                    msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>kwargs: </font>";
                    <font color='#0000FF'><u>bool</u></font> first <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
                    <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>kwarg : kwargs<font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>first<font face='Lucida Console'>)</font> <b>{</b>
                            first <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
                        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                            msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>, </font>";
                        <b>}</b>
                        msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>{}=</font>"<font face='Lucida Console'>)</font>.<font color='#BB00BB'>format</font><font face='Lucida Console'>(</font>kwarg.first<font face='Lucida Console'>)</font>;
                        <font color='#0000FF'>try</font> <b>{</b>
                            msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> pybind11::<font color='#BB00BB'>repr</font><font face='Lucida Console'>(</font>kwarg.second<font face='Lucida Console'>)</font>;
                        <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font><font color='#0000FF'>const</font> error_already_set <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <b>{</b>
                            msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>&lt;repr raised Error&gt;</font>";
                        <b>}</b>
                    <b>}</b>
                <b>}</b>
            <b>}</b>

            <font color='#BB00BB'>append_note_if_missing_header_is_suspected</font><font face='Lucida Console'>(</font>msg<font face='Lucida Console'>)</font>;
            <font color='#009900'>// Attach additional error info to the exception if supported
</font>            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#BB00BB'>PyErr_Occurred</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#009900'>// #HelpAppreciated: unit test coverage for this branch.
</font>                <font color='#BB00BB'>raise_from</font><font face='Lucida Console'>(</font>PyExc_TypeError, msg.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                <font color='#0000FF'>return</font> nullptr;
            <b>}</b>
            <font color='#BB00BB'>set_error</font><font face='Lucida Console'>(</font>PyExc_TypeError, msg.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>return</font> nullptr;
        <b>}</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>result<font face='Lucida Console'>)</font> <b>{</b>
            std::string msg <font color='#5555FF'>=</font> "<font color='#CC0000'>Unable to convert function return value to a </font>"
                              "<font color='#CC0000'>Python type! The signature was\n\t</font>";
            <font color='#BB00BB'>assert</font><font face='Lucida Console'>(</font>current_overload <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font>;
            msg <font color='#5555FF'>+</font><font color='#5555FF'>=</font> current_overload<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>signature;
            <font color='#BB00BB'>append_note_if_missing_header_is_suspected</font><font face='Lucida Console'>(</font>msg<font face='Lucida Console'>)</font>;
            <font color='#009900'>// Attach additional error info to the exception if supported
</font>            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#BB00BB'>PyErr_Occurred</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#BB00BB'>raise_from</font><font face='Lucida Console'>(</font>PyExc_TypeError, msg.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                <font color='#0000FF'>return</font> nullptr;
            <b>}</b>
            <font color='#BB00BB'>set_error</font><font face='Lucida Console'>(</font>PyExc_TypeError, msg.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>return</font> nullptr;
        <b>}</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>overloads<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_constructor <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font>self_value_and_holder.<font color='#BB00BB'>holder_constructed</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>pi <font color='#5555FF'>=</font> <font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font>instance <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>parent.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            self_value_and_holder.type<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#BB00BB'>init_instance</font><font face='Lucida Console'>(</font>pi, nullptr<font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#0000FF'>return</font> result.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>
<b>}</b>;

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='handle_type_name'></a>handle_type_name</b><font color='#5555FF'>&lt;</font>cpp_function<font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>static</font> constexpr <font color='#0000FF'>auto</font> name <font color='#5555FF'>=</font> <b><a name='const_name'></a>const_name</b><font face='Lucida Console'>(</font>"<font color='#CC0000'>Callable</font>"<font face='Lucida Console'>)</font>;
<b>}</b>;

<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#009900'>/// Wrapper for Python extension modules
</font><font color='#0000FF'>class</font> <b><a name='module_'></a>module_</b> : <font color='#0000FF'>public</font> object <b>{</b>
<font color='#0000FF'>public</font>:
    <b><a name='PYBIND11_OBJECT_DEFAULT'></a>PYBIND11_OBJECT_DEFAULT</b><font face='Lucida Console'>(</font>module_, object, PyModule_Check<font face='Lucida Console'>)</font>

    <font color='#009900'>/// Create a new top-level Python module with the given name and docstring
</font>    <b><a name='PYBIND11_DEPRECATED'></a>PYBIND11_DEPRECATED</b><font face='Lucida Console'>(</font>"<font color='#CC0000'>Use PYBIND11_MODULE or module_::create_extension_module instead</font>"<font face='Lucida Console'>)</font>
    <font color='#0000FF'>explicit</font> <b><a name='module_'></a>module_</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>doc <font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#5555FF'>*</font><font color='#0000FF'>this</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>create_extension_module</font><font face='Lucida Console'>(</font>name, doc, <font color='#0000FF'>new</font> <font color='#BB00BB'>PyModuleDef</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/** \rst
        Create Python binding for a new function within the module scope. ``Func``
        can be a plain C++ function, a function pointer, or a lambda function. For
        details on the ``Extra&amp;&amp; ... extra`` argument, see section :ref:`extras`.
    \endrst */</font>
    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Func, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    module_ <font color='#5555FF'>&amp;</font><b><a name='def'></a>def</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name_, Func <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>f, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        cpp_function <font color='#BB00BB'>func</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>f<font face='Lucida Console'>)</font>,
                          <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>name_<font face='Lucida Console'>)</font>,
                          <font color='#BB00BB'>scope</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font>,
                          <font color='#BB00BB'>sibling</font><font face='Lucida Console'>(</font><font color='#BB00BB'>getattr</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, name_, <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                          extra...<font face='Lucida Console'>)</font>;
        <font color='#009900'>// NB: allow overwriting here because cpp_function sets up a chain with the intention of
</font>        <font color='#009900'>// overwriting (and has already checked internally that it isn't overwriting
</font>        <font color='#009900'>// non-functions).
</font>        <font color='#BB00BB'>add_object</font><font face='Lucida Console'>(</font>name_, func, <font color='#979000'>true</font> <font color='#009900'>/* overwrite */</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#009900'>/** \rst
        Create and return a new Python submodule with the given name and docstring.
        This also works recursively, i.e.

        .. code-block:: cpp

            py::module_ m("example", "pybind11 example plugin");
            py::module_ m2 = m.def_submodule("sub", "A submodule of 'example'");
            py::module_ m3 = m2.def_submodule("subsub", "A submodule of 'example.sub'");
    \endrst */</font>
    module_ <b><a name='def_submodule'></a>def_submodule</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>doc <font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>this_name <font color='#5555FF'>=</font> <font color='#BB00BB'>PyModule_GetName</font><font face='Lucida Console'>(</font>m_ptr<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>this_name <font color='#5555FF'>=</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>throw</font> <font color='#BB00BB'>error_already_set</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
        std::string full_name <font color='#5555FF'>=</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>this_name<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> '<font color='#FF0000'>.</font>' <font color='#5555FF'>+</font> name;
        handle submodule <font color='#5555FF'>=</font> <font color='#BB00BB'>PyImport_AddModule</font><font face='Lucida Console'>(</font>full_name.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>submodule<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>throw</font> <font color='#BB00BB'>error_already_set</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#0000FF'>auto</font> result <font color='#5555FF'>=</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>module_<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>submodule<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>doc <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> options::<font color='#BB00BB'>show_user_defined_docstrings</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            result.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__doc__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>doc<font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> result;
        <font color='#0000FF'>return</font> result;
    <b>}</b>

    <font color='#009900'>/// Import and return a module or throws `error_already_set`.
</font>    <font color='#0000FF'>static</font> module_ <b><a name='import'></a>import</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name<font face='Lucida Console'>)</font> <b>{</b>
        PyObject <font color='#5555FF'>*</font>obj <font color='#5555FF'>=</font> <font color='#BB00BB'>PyImport_ImportModule</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>obj<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>throw</font> <font color='#BB00BB'>error_already_set</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#0000FF'>return</font> reinterpret_steal<font color='#5555FF'>&lt;</font>module_<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>obj<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Reload the module or throws `error_already_set`.
</font>    <font color='#0000FF'><u>void</u></font> <b><a name='reload'></a>reload</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b>
        PyObject <font color='#5555FF'>*</font>obj <font color='#5555FF'>=</font> <font color='#BB00BB'>PyImport_ReloadModule</font><font face='Lucida Console'>(</font><font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>obj<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>throw</font> <font color='#BB00BB'>error_already_set</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#5555FF'>*</font><font color='#0000FF'>this</font> <font color='#5555FF'>=</font> reinterpret_steal<font color='#5555FF'>&lt;</font>module_<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>obj<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/** \rst
        Adds an object to the module using the given name.  Throws if an object with the given name
        already exists.

        ``overwrite`` should almost always be false: attempting to overwrite objects that pybind11
        has established will, in most cases, break things.
    \endrst */</font>
    PYBIND11_NOINLINE <font color='#0000FF'><u>void</u></font> <b><a name='add_object'></a>add_object</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, handle obj, <font color='#0000FF'><u>bool</u></font> overwrite <font color='#5555FF'>=</font> <font color='#979000'>false</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>overwrite <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#BB00BB'>hasattr</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, name<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>
                "<font color='#CC0000'>Error during initialization: multiple incompatible definitions with name \"</font>"
                <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>\"</font>"<font face='Lucida Console'>)</font>;
        <b>}</b>

        <font color='#BB00BB'>PyModule_AddObject</font><font face='Lucida Console'>(</font><font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, name, obj.<font color='#BB00BB'>inc_ref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#009900'>/* steals a reference */</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#0000FF'>using</font> module_def <font color='#5555FF'>=</font> PyModuleDef; <font color='#009900'>// TODO: Can this be removed (it was needed only for Python 2)?
</font>
    <font color='#009900'>/** \rst
        Create a new top-level module that can be used as the main module of a C extension.

        ``def`` should point to a statically allocated module_def.
    \endrst */</font>
    <font color='#0000FF'>static</font> module_ <b><a name='create_extension_module'></a>create_extension_module</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>doc, module_def <font color='#5555FF'>*</font>def<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#009900'>// module_def is PyModuleDef
</font>        <font color='#009900'>// Placement new (not an allocation).
</font>        def <font color='#5555FF'>=</font> <font color='#0000FF'>new</font> <font face='Lucida Console'>(</font>def<font face='Lucida Console'>)</font>
            PyModuleDef<b>{</b><font color='#009900'>/* m_base */</font> PyModuleDef_HEAD_INIT,
                        <font color='#009900'>/* m_name */</font> name,
                        <font color='#009900'>/* m_doc */</font> options::<font color='#BB00BB'>show_user_defined_docstrings</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> ? doc : nullptr,
                        <font color='#009900'>/* m_size */</font> <font color='#5555FF'>-</font><font color='#979000'>1</font>,
                        <font color='#009900'>/* m_methods */</font> nullptr,
                        <font color='#009900'>/* m_slots */</font> nullptr,
                        <font color='#009900'>/* m_traverse */</font> nullptr,
                        <font color='#009900'>/* m_clear */</font> nullptr,
                        <font color='#009900'>/* m_free */</font> nullptr<b>}</b>;
        <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>m <font color='#5555FF'>=</font> <font color='#BB00BB'>PyModule_Create</font><font face='Lucida Console'>(</font>def<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>m <font color='#5555FF'>=</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#BB00BB'>PyErr_Occurred</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                <font color='#0000FF'>throw</font> <font color='#BB00BB'>error_already_set</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <b>}</b>
            <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>Internal error in module_::create_extension_module()</font>"<font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#009900'>// TODO: Should be reinterpret_steal for Python 3, but Python also steals it again when
</font>        <font color='#009900'>//       returned from PyInit_...
</font>        <font color='#009900'>//       For Python 2, reinterpret_borrow was correct.
</font>        <font color='#0000FF'>return</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>module_<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>m<font face='Lucida Console'>)</font>;
    <b>}</b>
<b>}</b>;

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='handle_type_name'></a>handle_type_name</b><font color='#5555FF'>&lt;</font>module_<font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>static</font> constexpr <font color='#0000FF'>auto</font> name <font color='#5555FF'>=</font> <b><a name='const_name'></a>const_name</b><font face='Lucida Console'>(</font>"<font color='#CC0000'>module</font>"<font face='Lucida Console'>)</font>;
<b>}</b>;

<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#009900'>// When inside a namespace (or anywhere as long as it's not the first item on a line),
</font><font color='#009900'>// C++20 allows "module" to be used. This is provided for backward compatibility, and for
</font><font color='#009900'>// simplicity, if someone wants to use py::module for example, that is perfectly safe.
</font><font color='#0000FF'>using</font> module <font color='#5555FF'>=</font> module_;

<font color='#009900'>/// \ingroup python_builtins
</font><font color='#009900'>/// Return a dictionary representing the global variables in the current execution frame,
</font><font color='#009900'>/// or ``__main__.__dict__`` if there is no frame (usually when the interpreter is embedded).
</font><font color='#0000FF'>inline</font> dict <b><a name='globals'></a>globals</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b>
    PyObject <font color='#5555FF'>*</font>p <font color='#5555FF'>=</font> <font color='#BB00BB'>PyEval_GetGlobals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <font color='#0000FF'>return</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>dict<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>p ? p : module_::<font color='#BB00BB'>import</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__main__</font>"<font face='Lucida Console'>)</font>.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__dict__</font>"<font face='Lucida Console'>)</font>.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Args, <font color='#0000FF'>typename</font> <font color='#5555FF'>=</font> detail::enable_if_t<font color='#5555FF'>&lt;</font>args_are_all_keyword_or_ds<font color='#5555FF'>&lt;</font>Args...<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font>
<b><a name='PYBIND11_DEPRECATED'></a>PYBIND11_DEPRECATED</b><font face='Lucida Console'>(</font>"<font color='#CC0000'>make_simple_namespace should be replaced with </font>"
                    "<font color='#CC0000'>py::module_::import(\"types\").attr(\"SimpleNamespace\") </font>"<font face='Lucida Console'>)</font>
object <b><a name='make_simple_namespace'></a>make_simple_namespace</b><font face='Lucida Console'>(</font>Args <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>...args_<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> module_::<font color='#BB00BB'>import</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>types</font>"<font face='Lucida Console'>)</font>.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>SimpleNamespace</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Args<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>args_<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>;
<b>}</b>

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>
<font color='#009900'>/// Generic support for creating new Python heap types
</font><font color='#0000FF'>class</font> <b><a name='generic_type'></a>generic_type</b> : <font color='#0000FF'>public</font> object <b>{</b>
<font color='#0000FF'>public</font>:
    <b><a name='PYBIND11_OBJECT_DEFAULT'></a>PYBIND11_OBJECT_DEFAULT</b><font face='Lucida Console'>(</font>generic_type, object, PyType_Check<font face='Lucida Console'>)</font>
<font color='#0000FF'>protected</font>:
    <font color='#0000FF'><u>void</u></font> <b><a name='initialize'></a>initialize</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> type_record <font color='#5555FF'>&amp;</font>rec<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec.scope <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#BB00BB'>hasattr</font><font face='Lucida Console'>(</font>rec.scope, "<font color='#CC0000'>__dict__</font>"<font face='Lucida Console'>)</font>
            <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> rec.scope.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__dict__</font>"<font face='Lucida Console'>)</font>.<font color='#BB00BB'>contains</font><font face='Lucida Console'>(</font>rec.name<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>generic_type: cannot initialize type \"</font>" <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>rec.name<font face='Lucida Console'>)</font>
                          <font color='#5555FF'>+</font> "<font color='#CC0000'>\": an object with that name is already defined</font>"<font face='Lucida Console'>)</font>;
        <b>}</b>

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>rec.module_local ? <font color='#BB00BB'>get_local_type_info</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>rec.type<font face='Lucida Console'>)</font> : <font color='#BB00BB'>get_global_type_info</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>rec.type<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>
            <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>generic_type: type \"</font>" <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>rec.name<font face='Lucida Console'>)</font>
                          <font color='#5555FF'>+</font> "<font color='#CC0000'>\" is already registered!</font>"<font face='Lucida Console'>)</font>;
        <b>}</b>

        m_ptr <font color='#5555FF'>=</font> <font color='#BB00BB'>make_new_python_type</font><font face='Lucida Console'>(</font>rec<font face='Lucida Console'>)</font>;

        <font color='#009900'>/* Register supplemental type information in C++ dict */</font>
        <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>tinfo <font color='#5555FF'>=</font> <font color='#0000FF'>new</font> detail::<font color='#BB00BB'>type_info</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>type <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> m_ptr;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>cpptype <font color='#5555FF'>=</font> rec.type;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>type_size <font color='#5555FF'>=</font> rec.type_size;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>type_align <font color='#5555FF'>=</font> rec.type_align;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>operator_new <font color='#5555FF'>=</font> rec.operator_new;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>holder_size_in_ptrs <font color='#5555FF'>=</font> <font color='#BB00BB'>size_in_ptrs</font><font face='Lucida Console'>(</font>rec.holder_size<font face='Lucida Console'>)</font>;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>init_instance <font color='#5555FF'>=</font> rec.init_instance;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>dealloc <font color='#5555FF'>=</font> rec.dealloc;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>simple_type <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>simple_ancestors <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>default_holder <font color='#5555FF'>=</font> rec.default_holder;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>module_local <font color='#5555FF'>=</font> rec.module_local;

        <font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>internals <font color='#5555FF'>=</font> <font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>auto</font> tindex <font color='#5555FF'>=</font> std::<font color='#BB00BB'>type_index</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>rec.type<font face='Lucida Console'>)</font>;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>direct_conversions <font color='#5555FF'>=</font> <font color='#5555FF'>&amp;</font>internals.direct_conversions[tindex];
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec.module_local<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>get_local_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.registered_types_cpp[tindex] <font color='#5555FF'>=</font> tinfo;
        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
            internals.registered_types_cpp[tindex] <font color='#5555FF'>=</font> tinfo;
        <b>}</b>
        internals.registered_types_py[<font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> m_ptr] <font color='#5555FF'>=</font> <b>{</b>tinfo<b>}</b>;

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec.bases.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&gt;</font> <font color='#979000'>1</font> <font color='#5555FF'>|</font><font color='#5555FF'>|</font> rec.multiple_inheritance<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>mark_parents_nonsimple</font><font face='Lucida Console'>(</font>tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>type<font face='Lucida Console'>)</font>;
            tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>simple_ancestors <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
        <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec.bases.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>1</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>parent_tinfo <font color='#5555FF'>=</font> <font color='#BB00BB'>get_type_info</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> rec.bases[<font color='#979000'>0</font>].<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#BB00BB'>assert</font><font face='Lucida Console'>(</font>parent_tinfo <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font>;
            <font color='#0000FF'><u>bool</u></font> parent_simple_ancestors <font color='#5555FF'>=</font> parent_tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>simple_ancestors;
            tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>simple_ancestors <font color='#5555FF'>=</font> parent_simple_ancestors;
            <font color='#009900'>// The parent can no longer be a simple type if it has MI and has a child
</font>            parent_tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>simple_type <font color='#5555FF'>=</font> parent_tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>simple_type <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> parent_simple_ancestors;
        <b>}</b>

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec.module_local<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#009900'>// Stash the local typeinfo and loader so that external modules can access it.
</font>            tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>module_local_load <font color='#5555FF'>=</font> <font color='#5555FF'>&amp;</font>type_caster_generic::local_load;
            <font color='#BB00BB'>setattr</font><font face='Lucida Console'>(</font>m_ptr, PYBIND11_MODULE_LOCAL_ID, <font color='#BB00BB'>capsule</font><font face='Lucida Console'>(</font>tinfo<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b>

    <font color='#009900'>/// Helper function which tags all parents of a type using mult. inheritance
</font>    <font color='#0000FF'><u>void</u></font> <b><a name='mark_parents_nonsimple'></a>mark_parents_nonsimple</b><font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font>value<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>auto</font> t <font color='#5555FF'>=</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>tuple<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>value<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>tp_bases<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font>handle h : t<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>tinfo2 <font color='#5555FF'>=</font> <font color='#BB00BB'>get_type_info</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> h.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>tinfo2<font face='Lucida Console'>)</font> <b>{</b>
                tinfo2<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>simple_type <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
            <b>}</b>
            <font color='#BB00BB'>mark_parents_nonsimple</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> h.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b>

    <font color='#0000FF'><u>void</u></font> <b><a name='install_buffer_funcs'></a>install_buffer_funcs</b><font face='Lucida Console'>(</font>buffer_info <font color='#5555FF'>*</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>get_buffer<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font>, <font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font><font face='Lucida Console'>)</font>,
                              <font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font>get_buffer_data<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>type <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font>PyHeapTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> m_ptr;
        <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>tinfo <font color='#5555FF'>=</font> detail::<font color='#BB00BB'>get_type_info</font><font face='Lucida Console'>(</font><font color='#5555FF'>&amp;</font>type<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>ht_type<font face='Lucida Console'>)</font>;

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>type<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>ht_type.tp_as_buffer<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>To be able to register buffer protocol support for the type '</font>"
                          <font color='#5555FF'>+</font> <font color='#BB00BB'>get_fully_qualified_tp_name</font><font face='Lucida Console'>(</font>tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>type<font face='Lucida Console'>)</font>
                          <font color='#5555FF'>+</font> "<font color='#CC0000'>' the associated class&lt;&gt;(..) invocation must </font>"
                            "<font color='#CC0000'>include the pybind11::buffer_protocol() annotation!</font>"<font face='Lucida Console'>)</font>;
        <b>}</b>

        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>get_buffer <font color='#5555FF'>=</font> get_buffer;
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>get_buffer_data <font color='#5555FF'>=</font> get_buffer_data;
    <b>}</b>

    <font color='#009900'>// rec_func must be set for either fget or fset.
</font>    <font color='#0000FF'><u>void</u></font> <b><a name='def_property_static_impl'></a>def_property_static_impl</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name,
                                  handle fget,
                                  handle fset,
                                  detail::function_record <font color='#5555FF'>*</font>rec_func<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> is_static <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font>rec_func <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font><font face='Lucida Console'>(</font>rec_func<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>is_method <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> rec_func<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>scope<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>const</font> <font color='#0000FF'>auto</font> has_doc <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font>rec_func <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font face='Lucida Console'>(</font>rec_func<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font>
                             <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> pybind11::options::<font color='#BB00BB'>show_user_defined_docstrings</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>auto</font> property <font color='#5555FF'>=</font> <font color='#BB00BB'>handle</font><font face='Lucida Console'>(</font>
            <font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> <font face='Lucida Console'>(</font>is_static ? <font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.static_property_type : <font color='#5555FF'>&amp;</font>PyProperty_Type<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>property</font><font face='Lucida Console'>(</font>fget.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> ? fget : <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                              fset.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> ? fset : <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                              <font color='#009900'>/*deleter*/</font> <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                              pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>has_doc ? rec_func<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc : "<font color='#CC0000'></font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b>
<b>}</b>;

<font color='#009900'>/// Set the pointer to operator new if it exists. The cast is needed because it can be overloaded.
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T,
          <font color='#0000FF'>typename</font> <font color='#5555FF'>=</font> void_t<font color='#5555FF'>&lt;</font><b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font color='#0000FF'>static_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font> <font face='Lucida Console'>(</font><font color='#0000FF'><u>size_t</u></font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>T::<b><a name='operator'></a>operator</b> <font color='#0000FF'>new</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'><u>void</u></font> <b><a name='set_operator_new'></a>set_operator_new</b><font face='Lucida Console'>(</font>type_record <font color='#5555FF'>*</font>r<font face='Lucida Console'>)</font> <b>{</b>
    r<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>operator_new <font color='#5555FF'>=</font> <font color='#5555FF'>&amp;</font>T::<font color='#0000FF'>operator</font> <font color='#0000FF'>new</font>;
<b>}</b>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'><u>void</u></font> <b><a name='set_operator_new'></a>set_operator_new</b><font face='Lucida Console'>(</font>...<font face='Lucida Console'>)</font> <b>{</b><b>}</b>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T, <font color='#0000FF'>typename</font> SFINAE <font color='#5555FF'>=</font> <font color='#0000FF'><u>void</u></font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='has_operator_delete'></a>has_operator_delete</b> : std::false_type <b>{</b><b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='has_operator_delete'></a>has_operator_delete</b><font color='#5555FF'>&lt;</font>T, void_t<font color='#5555FF'>&lt;</font><b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font color='#0000FF'>static_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>void</u></font> <font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>T::<b><a name='operator'></a>operator</b> <font color='#0000FF'>delete</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font>
    : std::true_type <b>{</b><b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T, <font color='#0000FF'>typename</font> SFINAE <font color='#5555FF'>=</font> <font color='#0000FF'><u>void</u></font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='has_operator_delete_size'></a>has_operator_delete_size</b> : std::false_type <b>{</b><b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='has_operator_delete_size'></a>has_operator_delete_size</b><font color='#5555FF'>&lt;</font>
    T,
    void_t<font color='#5555FF'>&lt;</font><b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font color='#0000FF'>static_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>void</u></font> <font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font>, <font color='#0000FF'><u>size_t</u></font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>T::<b><a name='operator'></a>operator</b> <font color='#0000FF'>delete</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font> : std::true_type <b>{</b>
<b>}</b>;
<font color='#009900'>/// Call class-specific delete if it exists or global otherwise. Can also be an overload set.
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T, enable_if_t<font color='#5555FF'>&lt;</font>has_operator_delete<font color='#5555FF'>&lt;</font>T<font color='#5555FF'>&gt;</font>::value, <font color='#0000FF'><u>int</u></font><font color='#5555FF'>&gt;</font> <font color='#5555FF'>=</font> <font color='#979000'>0</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'><u>void</u></font> <b><a name='call_operator_delete'></a>call_operator_delete</b><font face='Lucida Console'>(</font>T <font color='#5555FF'>*</font>p, <font color='#0000FF'><u>size_t</u></font>, <font color='#0000FF'><u>size_t</u></font><font face='Lucida Console'>)</font> <b>{</b>
    T::<font color='#0000FF'>operator</font> <font color='#0000FF'>delete</font><font face='Lucida Console'>(</font>p<font face='Lucida Console'>)</font>;
<b>}</b>
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T,
          enable_if_t<font color='#5555FF'>&lt;</font><font color='#5555FF'>!</font>has_operator_delete<font color='#5555FF'>&lt;</font>T<font color='#5555FF'>&gt;</font>::value <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> has_operator_delete_size<font color='#5555FF'>&lt;</font>T<font color='#5555FF'>&gt;</font>::value, <font color='#0000FF'><u>int</u></font><font color='#5555FF'>&gt;</font>
          <font color='#5555FF'>=</font> <font color='#979000'>0</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'><u>void</u></font> <b><a name='call_operator_delete'></a>call_operator_delete</b><font face='Lucida Console'>(</font>T <font color='#5555FF'>*</font>p, <font color='#0000FF'><u>size_t</u></font> s, <font color='#0000FF'><u>size_t</u></font><font face='Lucida Console'>)</font> <b>{</b>
    T::<font color='#0000FF'>operator</font> <font color='#0000FF'>delete</font><font face='Lucida Console'>(</font>p, s<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#0000FF'>inline</font> <font color='#0000FF'><u>void</u></font> <b><a name='call_operator_delete'></a>call_operator_delete</b><font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font>p, <font color='#0000FF'><u>size_t</u></font> s, <font color='#0000FF'><u>size_t</u></font> a<font face='Lucida Console'>)</font> <b>{</b>
    <font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font><font face='Lucida Console'>)</font> s;
    <font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font><font face='Lucida Console'>)</font> a;
<font color='#0000FF'>#if</font> defined<font face='Lucida Console'>(</font>__cpp_aligned_new<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>defined<font face='Lucida Console'>(</font>_MSC_VER<font face='Lucida Console'>)</font> <font color='#5555FF'>|</font><font color='#5555FF'>|</font> _MSC_VER <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> <font color='#979000'>1912</font><font face='Lucida Console'>)</font>
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>a <font color='#5555FF'>&gt;</font> __STDCPP_DEFAULT_NEW_ALIGNMENT__<font face='Lucida Console'>)</font> <b>{</b>
#    ifdef __cpp_sized_deallocation
        ::<font color='#0000FF'>operator</font> <font color='#0000FF'>delete</font><font face='Lucida Console'>(</font>p, s, std::<font color='#BB00BB'>align_val_t</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
#    <font color='#0000FF'>else</font>
        ::<font color='#0000FF'>operator</font> <font color='#0000FF'>delete</font><font face='Lucida Console'>(</font>p, std::<font color='#BB00BB'>align_val_t</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
#    endif
        <font color='#0000FF'>return</font>;
    <b>}</b>
<font color='#0000FF'>#endif</font>
<font color='#0000FF'>#ifdef</font> __cpp_sized_deallocation
    ::<font color='#0000FF'>operator</font> <font color='#0000FF'>delete</font><font face='Lucida Console'>(</font>p, s<font face='Lucida Console'>)</font>;
<font color='#0000FF'>#else</font>
    ::<font color='#0000FF'>operator</font> <font color='#0000FF'>delete</font><font face='Lucida Console'>(</font>p<font face='Lucida Console'>)</font>;
<font color='#0000FF'>#endif</font>
<b>}</b>

<font color='#0000FF'>inline</font> <font color='#0000FF'><u>void</u></font> <b><a name='add_class_method'></a>add_class_method</b><font face='Lucida Console'>(</font>object <font color='#5555FF'>&amp;</font>cls, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name_, <font color='#0000FF'>const</font> cpp_function <font color='#5555FF'>&amp;</font>cf<font face='Lucida Console'>)</font> <b>{</b>
    cls.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>cf.<font color='#BB00BB'>name</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> cf;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>std::<font color='#BB00BB'>strcmp</font><font face='Lucida Console'>(</font>name_, "<font color='#CC0000'>__eq__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>0</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#5555FF'>!</font>cls.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__dict__</font>"<font face='Lucida Console'>)</font>.<font color='#BB00BB'>contains</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__hash__</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        cls.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__hash__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>
<b>}</b>

<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#009900'>/// Given a pointer to a member function, cast it to its `Derived` version.
</font><font color='#009900'>/// Forward everything else unchanged.
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> <font color='#009900'>/*Derived*/</font>, <font color='#0000FF'>typename</font> F<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>auto</font> <b><a name='method_adaptor'></a>method_adaptor</b><font face='Lucida Console'>(</font>F <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>f<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>F<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> std::forward<font color='#5555FF'>&lt;</font>F<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>f<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Derived, <font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font> Class, <font color='#0000FF'>typename</font>... Args<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>auto</font> <b><a name='method_adaptor'></a>method_adaptor</b><font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font>Class::<font color='#5555FF'>*</font>pmf<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Args...<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> <b><a name='Return'></a>Return</b> <font face='Lucida Console'>(</font>Derived::<font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Args...<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font>
        detail::is_accessible_base_of<font color='#5555FF'>&lt;</font>Class, Derived<font color='#5555FF'>&gt;</font>::value,
        "<font color='#CC0000'>Cannot bind an inaccessible base class method; use a lambda definition instead</font>"<font face='Lucida Console'>)</font>;
    <font color='#0000FF'>return</font> pmf;
<b>}</b>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Derived, <font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font> Class, <font color='#0000FF'>typename</font>... Args<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>auto</font> <b><a name='method_adaptor'></a>method_adaptor</b><font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font>Class::<font color='#5555FF'>*</font>pmf<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Args...<font face='Lucida Console'>)</font> <font color='#0000FF'>const</font><font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> <b><a name='Return'></a>Return</b> <font face='Lucida Console'>(</font>Derived::<font color='#5555FF'>*</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Args...<font face='Lucida Console'>)</font> <font color='#0000FF'>const</font> <b>{</b>
    <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font>
        detail::is_accessible_base_of<font color='#5555FF'>&lt;</font>Class, Derived<font color='#5555FF'>&gt;</font>::value,
        "<font color='#CC0000'>Cannot bind an inaccessible base class method; use a lambda definition instead</font>"<font face='Lucida Console'>)</font>;
    <font color='#0000FF'>return</font> pmf;
<b>}</b>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> type_, <font color='#0000FF'>typename</font>... options<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>class</font> <b><a name='class_'></a>class_</b> : <font color='#0000FF'>public</font> detail::generic_type <b>{</b>
    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T<font color='#5555FF'>&gt;</font>
    <font color='#0000FF'>using</font> is_holder <font color='#5555FF'>=</font> detail::is_holder_type<font color='#5555FF'>&lt;</font>type_, T<font color='#5555FF'>&gt;</font>;
    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T<font color='#5555FF'>&gt;</font>
    <font color='#0000FF'>using</font> is_subtype <font color='#5555FF'>=</font> detail::is_strict_base_of<font color='#5555FF'>&lt;</font>type_, T<font color='#5555FF'>&gt;</font>;
    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T<font color='#5555FF'>&gt;</font>
    <font color='#0000FF'>using</font> is_base <font color='#5555FF'>=</font> detail::is_strict_base_of<font color='#5555FF'>&lt;</font>T, type_<font color='#5555FF'>&gt;</font>;
    <font color='#009900'>// struct instead of using here to help MSVC:
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T<font color='#5555FF'>&gt;</font>
    <font color='#0000FF'>struct</font> <b><a name='is_valid_class_option'></a>is_valid_class_option</b> : detail::any_of<font color='#5555FF'>&lt;</font>is_holder<font color='#5555FF'>&lt;</font>T<font color='#5555FF'>&gt;</font>, is_subtype<font color='#5555FF'>&lt;</font>T<font color='#5555FF'>&gt;</font>, is_base<font color='#5555FF'>&lt;</font>T<font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font> <b>{</b><b>}</b>;

<font color='#0000FF'>public</font>:
    <font color='#0000FF'>using</font> type <font color='#5555FF'>=</font> type_;
    <font color='#0000FF'>using</font> type_alias <font color='#5555FF'>=</font> detail::exactly_one_t<font color='#5555FF'>&lt;</font>is_subtype, <font color='#0000FF'><u>void</u></font>, options...<font color='#5555FF'>&gt;</font>;
    constexpr <font color='#0000FF'>static</font> <font color='#0000FF'><u>bool</u></font> has_alias <font color='#5555FF'>=</font> <font color='#5555FF'>!</font>std::is_void<font color='#5555FF'>&lt;</font>type_alias<font color='#5555FF'>&gt;</font>::value;
    <font color='#0000FF'>using</font> holder_type <font color='#5555FF'>=</font> detail::exactly_one_t<font color='#5555FF'>&lt;</font>is_holder, std::unique_ptr<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font>, options...<font color='#5555FF'>&gt;</font>;

    <b><a name='static_assert'></a>static_assert</b><font face='Lucida Console'>(</font>detail::all_of<font color='#5555FF'>&lt;</font>is_valid_class_option<font color='#5555FF'>&lt;</font>options<font color='#5555FF'>&gt;</font>...<font color='#5555FF'>&gt;</font>::value,
                  "<font color='#CC0000'>Unknown/invalid class_ template parameters provided</font>"<font face='Lucida Console'>)</font>;

    <b><a name='static_assert'></a>static_assert</b><font face='Lucida Console'>(</font><font color='#5555FF'>!</font>has_alias <font color='#5555FF'>|</font><font color='#5555FF'>|</font> std::is_polymorphic<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font>::value,
                  "<font color='#CC0000'>Cannot use an alias class with a non-polymorphic type</font>"<font face='Lucida Console'>)</font>;

    <b><a name='PYBIND11_OBJECT'></a>PYBIND11_OBJECT</b><font face='Lucida Console'>(</font>class_, generic_type, PyType_Check<font face='Lucida Console'>)</font>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    <b><a name='class_'></a>class_</b><font face='Lucida Console'>(</font>handle scope, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>using</font> <font color='#0000FF'>namespace</font> detail;

        <font color='#009900'>// MI can only be specified via class_ template options, not constructor parameters
</font>        <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font>
            none_of<font color='#5555FF'>&lt;</font>is_pyobject<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font>...<font color='#5555FF'>&gt;</font>::value <font color='#5555FF'>|</font><font color='#5555FF'>|</font> <font color='#009900'>// no base class arguments, or:
</font>                <font face='Lucida Console'>(</font><font color='#BB00BB'>constexpr_sum</font><font face='Lucida Console'>(</font>is_pyobject<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font>::value...<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>1</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font color='#009900'>// Exactly one base
</font>                 <font color='#BB00BB'>constexpr_sum</font><font face='Lucida Console'>(</font>is_base<font color='#5555FF'>&lt;</font>options<font color='#5555FF'>&gt;</font>::value...<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>0</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>   <font color='#009900'>// no template option bases
</font>                 <font color='#009900'>// no multiple_inheritance attr
</font>                 none_of<font color='#5555FF'>&lt;</font>std::is_same<font color='#5555FF'>&lt;</font>multiple_inheritance, Extra<font color='#5555FF'>&gt;</font>...<font color='#5555FF'>&gt;</font>::value<font face='Lucida Console'>)</font>,
            "<font color='#CC0000'>Error: multiple inheritance bases must be specified via class_ template options</font>"<font face='Lucida Console'>)</font>;

        type_record record;
        record.scope <font color='#5555FF'>=</font> scope;
        record.name <font color='#5555FF'>=</font> name;
        record.type <font color='#5555FF'>=</font> <font color='#5555FF'>&amp;</font><font color='#0000FF'>typeid</font><font face='Lucida Console'>(</font>type<font face='Lucida Console'>)</font>;
        record.type_size <font color='#5555FF'>=</font> <font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font>conditional_t<font color='#5555FF'>&lt;</font>has_alias, type_alias, type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>)</font>;
        record.type_align <font color='#5555FF'>=</font> <font color='#BB00BB'>alignof</font><font face='Lucida Console'>(</font>conditional_t<font color='#5555FF'>&lt;</font>has_alias, type_alias, type<font color='#5555FF'>&gt;</font> <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font>;
        record.holder_size <font color='#5555FF'>=</font> <font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font>holder_type<font face='Lucida Console'>)</font>;
        record.init_instance <font color='#5555FF'>=</font> init_instance;
        record.dealloc <font color='#5555FF'>=</font> dealloc;
        record.default_holder <font color='#5555FF'>=</font> detail::is_instantiation<font color='#5555FF'>&lt;</font>std::unique_ptr, holder_type<font color='#5555FF'>&gt;</font>::value;

        set_operator_new<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#5555FF'>&amp;</font>record<font face='Lucida Console'>)</font>;

        <font color='#009900'>/* Register base classes specified via template arguments to class_, if any */</font>
        <font color='#BB00BB'>PYBIND11_EXPAND_SIDE_EFFECTS</font><font face='Lucida Console'>(</font>add_base<font color='#5555FF'>&lt;</font>options<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>record<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

        <font color='#009900'>/* Process optional arguments, if any */</font>
        process_attributes<font color='#5555FF'>&lt;</font>Extra...<font color='#5555FF'>&gt;</font>::<font color='#BB00BB'>init</font><font face='Lucida Console'>(</font>extra..., <font color='#5555FF'>&amp;</font>record<font face='Lucida Console'>)</font>;

        generic_type::<font color='#BB00BB'>initialize</font><font face='Lucida Console'>(</font>record<font face='Lucida Console'>)</font>;

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>has_alias<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>instances <font color='#5555FF'>=</font> record.module_local ? <font color='#BB00BB'>get_local_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.registered_types_cpp
                                                  : <font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.registered_types_cpp;
            instances[std::<font color='#BB00BB'>type_index</font><font face='Lucida Console'>(</font><font color='#0000FF'>typeid</font><font face='Lucida Console'>(</font>type_alias<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>]
                <font color='#5555FF'>=</font> instances[std::<font color='#BB00BB'>type_index</font><font face='Lucida Console'>(</font><font color='#0000FF'>typeid</font><font face='Lucida Console'>(</font>type<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>];
        <b>}</b>
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Base, detail::enable_if_t<font color='#5555FF'>&lt;</font>is_base<font color='#5555FF'>&lt;</font>Base<font color='#5555FF'>&gt;</font>::value, <font color='#0000FF'><u>int</u></font><font color='#5555FF'>&gt;</font> <font color='#5555FF'>=</font> <font color='#979000'>0</font><font color='#5555FF'>&gt;</font>
    <font color='#0000FF'>static</font> <font color='#0000FF'><u>void</u></font> <b><a name='add_base'></a>add_base</b><font face='Lucida Console'>(</font>detail::type_record <font color='#5555FF'>&amp;</font>rec<font face='Lucida Console'>)</font> <b>{</b>
        rec.<font color='#BB00BB'>add_base</font><font face='Lucida Console'>(</font><font color='#0000FF'>typeid</font><font face='Lucida Console'>(</font>Base<font face='Lucida Console'>)</font>, []<font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font>src<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> <font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font> <b>{</b>
            <font color='#0000FF'>return</font> <font color='#0000FF'>static_cast</font><font color='#5555FF'>&lt;</font>Base <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font>type <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>src<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <b>}</b><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Base, detail::enable_if_t<font color='#5555FF'>&lt;</font><font color='#5555FF'>!</font>is_base<font color='#5555FF'>&lt;</font>Base<font color='#5555FF'>&gt;</font>::value, <font color='#0000FF'><u>int</u></font><font color='#5555FF'>&gt;</font> <font color='#5555FF'>=</font> <font color='#979000'>0</font><font color='#5555FF'>&gt;</font>
    <font color='#0000FF'>static</font> <font color='#0000FF'><u>void</u></font> <b><a name='add_base'></a>add_base</b><font face='Lucida Console'>(</font>detail::type_record <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <b>{</b><b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Func, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def'></a>def</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name_, Func <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>f, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        cpp_function <font color='#BB00BB'>cf</font><font face='Lucida Console'>(</font>method_adaptor<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>f<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                        <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>name_<font face='Lucida Console'>)</font>,
                        <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font>,
                        <font color='#BB00BB'>sibling</font><font face='Lucida Console'>(</font><font color='#BB00BB'>getattr</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, name_, <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                        extra...<font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>add_class_method</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, name_, cf<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Func, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_static'></a>def_static</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name_, Func <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>f, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font><font color='#5555FF'>!</font>std::is_member_function_pointer<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font>::value,
                      "<font color='#CC0000'>def_static(...) called with a non-static member function pointer</font>"<font face='Lucida Console'>)</font>;
        cpp_function <font color='#BB00BB'>cf</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>f<font face='Lucida Console'>)</font>,
                        <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>name_<font face='Lucida Console'>)</font>,
                        <font color='#BB00BB'>scope</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font>,
                        <font color='#BB00BB'>sibling</font><font face='Lucida Console'>(</font><font color='#BB00BB'>getattr</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, name_, <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                        extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>auto</font> cf_name <font color='#5555FF'>=</font> cf.<font color='#BB00BB'>name</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>cf_name<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>staticmethod</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>cf<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T, <font color='#0000FF'>typename</font>... Extra, detail::enable_if_t<font color='#5555FF'>&lt;</font>T::op_enable_if_hook, <font color='#0000FF'><u>int</u></font><font color='#5555FF'>&gt;</font> <font color='#5555FF'>=</font> <font color='#979000'>0</font><font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def'></a>def</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> T <font color='#5555FF'>&amp;</font>op, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        op.<font color='#BB00BB'>execute</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T, <font color='#0000FF'>typename</font>... Extra, detail::enable_if_t<font color='#5555FF'>&lt;</font>T::op_enable_if_hook, <font color='#0000FF'><u>int</u></font><font color='#5555FF'>&gt;</font> <font color='#5555FF'>=</font> <font color='#979000'>0</font><font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_cast'></a>def_cast</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> T <font color='#5555FF'>&amp;</font>op, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        op.<font color='#BB00BB'>execute_cast</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Args, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def'></a>def</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> detail::initimpl::constructor<font color='#5555FF'>&lt;</font>Args...<font color='#5555FF'>&gt;</font> <font color='#5555FF'>&amp;</font>init, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>PYBIND11_WORKAROUND_INCORRECT_MSVC_C4100</font><font face='Lucida Console'>(</font>init<font face='Lucida Console'>)</font>;
        init.<font color='#BB00BB'>execute</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Args, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def'></a>def</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> detail::initimpl::alias_constructor<font color='#5555FF'>&lt;</font>Args...<font color='#5555FF'>&gt;</font> <font color='#5555FF'>&amp;</font>init, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>PYBIND11_WORKAROUND_INCORRECT_MSVC_C4100</font><font face='Lucida Console'>(</font>init<font face='Lucida Console'>)</font>;
        init.<font color='#BB00BB'>execute</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Args, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def'></a>def</b><font face='Lucida Console'>(</font>detail::initimpl::factory<font color='#5555FF'>&lt;</font>Args...<font color='#5555FF'>&gt;</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>init, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>init<font face='Lucida Console'>)</font>.<font color='#BB00BB'>execute</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Args, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def'></a>def</b><font face='Lucida Console'>(</font>detail::initimpl::pickle_factory<font color='#5555FF'>&lt;</font>Args...<font color='#5555FF'>&gt;</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>pf, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>pf<font face='Lucida Console'>)</font>.<font color='#BB00BB'>execute</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Func<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_buffer'></a>def_buffer</b><font face='Lucida Console'>(</font>Func <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>func<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>struct</font> <b><a name='capture'></a>capture</b> <b>{</b>
            Func func;
        <b>}</b>;
        <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>ptr <font color='#5555FF'>=</font> <font color='#0000FF'>new</font> capture<b>{</b>std::forward<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>func<font face='Lucida Console'>)</font><b>}</b>;
        <font color='#BB00BB'>install_buffer_funcs</font><font face='Lucida Console'>(</font>
            []<font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font>obj, <font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font>ptr<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> buffer_info <font color='#5555FF'>*</font> <b>{</b>
                detail::make_caster<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font> caster;
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>caster.<font color='#BB00BB'>load</font><font face='Lucida Console'>(</font>obj, <font color='#979000'>false</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>return</font> nullptr;
                <b>}</b>
                <font color='#0000FF'>return</font> <font color='#0000FF'>new</font> <font color='#BB00BB'>buffer_info</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>capture <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> ptr<font face='Lucida Console'>)</font><font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#BB00BB'>func</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>caster<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <b>}</b>,
            ptr<font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>weakref</font><font face='Lucida Console'>(</font>m_ptr, <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>[ptr]<font face='Lucida Console'>(</font>handle wr<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#0000FF'>delete</font> ptr;
                    wr.<font color='#BB00BB'>dec_ref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                <b>}</b><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>
            .<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font> Class, <font color='#0000FF'>typename</font>... Args<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_buffer'></a>def_buffer</b><font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font>Class::<font color='#5555FF'>*</font>func<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Args...<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_buffer</font><font face='Lucida Console'>(</font>[func]<font face='Lucida Console'>(</font>type <font color='#5555FF'>&amp;</font>obj<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font>obj.<font color='#5555FF'>*</font>func<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>; <b>}</b><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Return, <font color='#0000FF'>typename</font> Class, <font color='#0000FF'>typename</font>... Args<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_buffer'></a>def_buffer</b><font face='Lucida Console'>(</font><font color='#BB00BB'>Return</font> <font face='Lucida Console'>(</font>Class::<font color='#5555FF'>*</font>func<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Args...<font face='Lucida Console'>)</font> <font color='#0000FF'>const</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_buffer</font><font face='Lucida Console'>(</font>[func]<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> type <font color='#5555FF'>&amp;</font>obj<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font>obj.<font color='#5555FF'>*</font>func<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>; <b>}</b><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> C, <font color='#0000FF'>typename</font> D, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_readwrite'></a>def_readwrite</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, D C::<font color='#5555FF'>*</font>pm, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font>std::is_same<font color='#5555FF'>&lt;</font>C, type<font color='#5555FF'>&gt;</font>::value <font color='#5555FF'>|</font><font color='#5555FF'>|</font> std::is_base_of<font color='#5555FF'>&lt;</font>C, type<font color='#5555FF'>&gt;</font>::value,
                      "<font color='#CC0000'>def_readwrite() requires a class member (or base class member)</font>"<font face='Lucida Console'>)</font>;
        cpp_function <font color='#BB00BB'>fget</font><font face='Lucida Console'>(</font>[pm]<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> type <font color='#5555FF'>&amp;</font>c<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> <font color='#0000FF'>const</font> D <font color='#5555FF'>&amp;</font> <b>{</b> <font color='#0000FF'>return</font> c.<font color='#5555FF'>*</font>pm; <b>}</b>, <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
            <font color='#BB00BB'>fset</font><font face='Lucida Console'>(</font>[pm]<font face='Lucida Console'>(</font>type <font color='#5555FF'>&amp;</font>c, <font color='#0000FF'>const</font> D <font color='#5555FF'>&amp;</font>value<font face='Lucida Console'>)</font> <b>{</b> c.<font color='#5555FF'>*</font>pm <font color='#5555FF'>=</font> value; <b>}</b>, <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>def_property</font><font face='Lucida Console'>(</font>name, fget, fset, return_value_policy::reference_internal, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> C, <font color='#0000FF'>typename</font> D, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_readonly'></a>def_readonly</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> D C::<font color='#5555FF'>*</font>pm, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font>std::is_same<font color='#5555FF'>&lt;</font>C, type<font color='#5555FF'>&gt;</font>::value <font color='#5555FF'>|</font><font color='#5555FF'>|</font> std::is_base_of<font color='#5555FF'>&lt;</font>C, type<font color='#5555FF'>&gt;</font>::value,
                      "<font color='#CC0000'>def_readonly() requires a class member (or base class member)</font>"<font face='Lucida Console'>)</font>;
        cpp_function <font color='#BB00BB'>fget</font><font face='Lucida Console'>(</font>[pm]<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> type <font color='#5555FF'>&amp;</font>c<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> <font color='#0000FF'>const</font> D <font color='#5555FF'>&amp;</font> <b>{</b> <font color='#0000FF'>return</font> c.<font color='#5555FF'>*</font>pm; <b>}</b>, <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>def_property_readonly</font><font face='Lucida Console'>(</font>name, fget, return_value_policy::reference_internal, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> D, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_readwrite_static'></a>def_readwrite_static</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, D <font color='#5555FF'>*</font>pm, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        cpp_function <font color='#BB00BB'>fget</font><font face='Lucida Console'>(</font>[pm]<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> <font color='#0000FF'>const</font> D <font color='#5555FF'>&amp;</font> <b>{</b> <font color='#0000FF'>return</font> <font color='#5555FF'>*</font>pm; <b>}</b>, <font color='#BB00BB'>scope</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
            <font color='#BB00BB'>fset</font><font face='Lucida Console'>(</font>[pm]<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>, <font color='#0000FF'>const</font> D <font color='#5555FF'>&amp;</font>value<font face='Lucida Console'>)</font> <b>{</b> <font color='#5555FF'>*</font>pm <font color='#5555FF'>=</font> value; <b>}</b>, <font color='#BB00BB'>scope</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>def_property_static</font><font face='Lucida Console'>(</font>name, fget, fset, return_value_policy::reference, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> D, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_readonly_static'></a>def_readonly_static</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> D <font color='#5555FF'>*</font>pm, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        cpp_function <font color='#BB00BB'>fget</font><font face='Lucida Console'>(</font>[pm]<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> <font color='#0000FF'>const</font> D <font color='#5555FF'>&amp;</font> <b>{</b> <font color='#0000FF'>return</font> <font color='#5555FF'>*</font>pm; <b>}</b>, <font color='#BB00BB'>scope</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>def_property_readonly_static</font><font face='Lucida Console'>(</font>name, fget, return_value_policy::reference, extra...<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#009900'>/// Uses return_value_policy::reference_internal by default
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Getter, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_property_readonly'></a>def_property_readonly</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> Getter <font color='#5555FF'>&amp;</font>fget, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_property_readonly</font><font face='Lucida Console'>(</font>name,
                                     <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>method_adaptor<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>fget<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                                     return_value_policy::reference_internal,
                                     extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Uses cpp_function's return_value_policy by default
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font>
    <b><a name='def_property_readonly'></a>def_property_readonly</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> cpp_function <font color='#5555FF'>&amp;</font>fget, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_property</font><font face='Lucida Console'>(</font>name, fget, nullptr, extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Uses return_value_policy::reference by default
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Getter, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font>
    <b><a name='def_property_readonly_static'></a>def_property_readonly_static</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> Getter <font color='#5555FF'>&amp;</font>fget, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_property_readonly_static</font><font face='Lucida Console'>(</font>
            name, <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>fget<font face='Lucida Console'>)</font>, return_value_policy::reference, extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Uses cpp_function's return_value_policy by default
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_property_readonly_static'></a>def_property_readonly_static</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name,
                                         <font color='#0000FF'>const</font> cpp_function <font color='#5555FF'>&amp;</font>fget,
                                         <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_property_static</font><font face='Lucida Console'>(</font>name, fget, nullptr, extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Uses return_value_policy::reference_internal by default
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Getter, <font color='#0000FF'>typename</font> Setter, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font>
    <b><a name='def_property'></a>def_property</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> Getter <font color='#5555FF'>&amp;</font>fget, <font color='#0000FF'>const</font> Setter <font color='#5555FF'>&amp;</font>fset, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_property</font><font face='Lucida Console'>(</font>
            name, fget, <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>method_adaptor<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>fset<font face='Lucida Console'>)</font>, <font color='#BB00BB'>is_setter</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>, extra...<font face='Lucida Console'>)</font>;
    <b>}</b>
    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Getter, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_property'></a>def_property</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name,
                         <font color='#0000FF'>const</font> Getter <font color='#5555FF'>&amp;</font>fget,
                         <font color='#0000FF'>const</font> cpp_function <font color='#5555FF'>&amp;</font>fset,
                         <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_property</font><font face='Lucida Console'>(</font>name,
                            <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>method_adaptor<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>fget<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                            fset,
                            return_value_policy::reference_internal,
                            extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Uses cpp_function's return_value_policy by default
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_property'></a>def_property</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name,
                         <font color='#0000FF'>const</font> cpp_function <font color='#5555FF'>&amp;</font>fget,
                         <font color='#0000FF'>const</font> cpp_function <font color='#5555FF'>&amp;</font>fset,
                         <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_property_static</font><font face='Lucida Console'>(</font>name, fget, fset, <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font>, extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Uses return_value_policy::reference by default
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Getter, <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_property_static'></a>def_property_static</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name,
                                <font color='#0000FF'>const</font> Getter <font color='#5555FF'>&amp;</font>fget,
                                <font color='#0000FF'>const</font> cpp_function <font color='#5555FF'>&amp;</font>fset,
                                <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>def_property_static</font><font face='Lucida Console'>(</font>
            name, <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>fget<font face='Lucida Console'>)</font>, fset, return_value_policy::reference, extra...<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Uses cpp_function's return_value_policy by default
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    class_ <font color='#5555FF'>&amp;</font><b><a name='def_property_static'></a>def_property_static</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name,
                                <font color='#0000FF'>const</font> cpp_function <font color='#5555FF'>&amp;</font>fget,
                                <font color='#0000FF'>const</font> cpp_function <font color='#5555FF'>&amp;</font>fset,
                                <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>static_assert</font><font face='Lucida Console'>(</font><font color='#979000'>0</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> detail::<font color='#BB00BB'>constexpr_sum</font><font face='Lucida Console'>(</font>std::is_base_of<font color='#5555FF'>&lt;</font>arg, Extra<font color='#5555FF'>&gt;</font>::value...<font face='Lucida Console'>)</font>,
                      "<font color='#CC0000'>Argument annotations are not allowed for properties</font>"<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>auto</font> rec_fget <font color='#5555FF'>=</font> <font color='#BB00BB'>get_function_record</font><font face='Lucida Console'>(</font>fget<font face='Lucida Console'>)</font>, rec_fset <font color='#5555FF'>=</font> <font color='#BB00BB'>get_function_record</font><font face='Lucida Console'>(</font>fset<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>rec_active <font color='#5555FF'>=</font> rec_fget;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec_fget<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>doc_prev <font color='#5555FF'>=</font> rec_fget<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc; <font color='#009900'>/* 'extra' field may include a property-specific
                                               documentation string */</font>
            detail::process_attributes<font color='#5555FF'>&lt;</font>Extra...<font color='#5555FF'>&gt;</font>::<font color='#BB00BB'>init</font><font face='Lucida Console'>(</font>extra..., rec_fget<font face='Lucida Console'>)</font>;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec_fget<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> rec_fget<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc <font color='#5555FF'>!</font><font color='#5555FF'>=</font> doc_prev<font face='Lucida Console'>)</font> <b>{</b>
                std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font>doc_prev<font face='Lucida Console'>)</font>;
                rec_fget<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc <font color='#5555FF'>=</font> <font color='#BB00BB'>PYBIND11_COMPAT_STRDUP</font><font face='Lucida Console'>(</font>rec_fget<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc<font face='Lucida Console'>)</font>;
            <b>}</b>
        <b>}</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec_fset<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>doc_prev <font color='#5555FF'>=</font> rec_fset<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc;
            detail::process_attributes<font color='#5555FF'>&lt;</font>Extra...<font color='#5555FF'>&gt;</font>::<font color='#BB00BB'>init</font><font face='Lucida Console'>(</font>extra..., rec_fset<font face='Lucida Console'>)</font>;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>rec_fset<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> rec_fset<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc <font color='#5555FF'>!</font><font color='#5555FF'>=</font> doc_prev<font face='Lucida Console'>)</font> <b>{</b>
                std::<font color='#BB00BB'>free</font><font face='Lucida Console'>(</font>doc_prev<font face='Lucida Console'>)</font>;
                rec_fset<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc <font color='#5555FF'>=</font> <font color='#BB00BB'>PYBIND11_COMPAT_STRDUP</font><font face='Lucida Console'>(</font>rec_fset<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>doc<font face='Lucida Console'>)</font>;
            <b>}</b>
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>rec_active<font face='Lucida Console'>)</font> <b>{</b>
                rec_active <font color='#5555FF'>=</font> rec_fset;
            <b>}</b>
        <b>}</b>
        <font color='#BB00BB'>def_property_static_impl</font><font face='Lucida Console'>(</font>name, fget, fset, rec_active<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

<font color='#0000FF'>private</font>:
    <font color='#009900'>/// Initialize holder object, variant 1: object derives from enable_shared_from_this
</font>    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> T<font color='#5555FF'>&gt;</font>
    <font color='#0000FF'>static</font> <font color='#0000FF'><u>void</u></font> <b><a name='init_holder'></a>init_holder</b><font face='Lucida Console'>(</font>detail::instance <font color='#5555FF'>*</font>inst,
                            detail::value_and_holder <font color='#5555FF'>&amp;</font>v_h,
                            <font color='#0000FF'>const</font> holder_type <font color='#5555FF'>*</font> <font color='#009900'>/* unused */</font>,
                            <font color='#0000FF'>const</font> std::enable_shared_from_this<font color='#5555FF'>&lt;</font>T<font color='#5555FF'>&gt;</font> <font color='#5555FF'>*</font> <font color='#009900'>/* dummy */</font><font face='Lucida Console'>)</font> <b>{</b>

        <font color='#0000FF'>auto</font> sh <font color='#5555FF'>=</font> std::dynamic_pointer_cast<font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> holder_type::element_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>
            detail::<font color='#BB00BB'>try_get_shared_from_this</font><font face='Lucida Console'>(</font>v_h.value_ptr<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>sh<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>new</font> <font face='Lucida Console'>(</font>std::<font color='#BB00BB'>addressof</font><font face='Lucida Console'>(</font>v_h.holder<font color='#5555FF'>&lt;</font>holder_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <font color='#BB00BB'>holder_type</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>sh<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            v_h.<font color='#BB00BB'>set_holder_constructed</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>v_h.<font color='#BB00BB'>holder_constructed</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> inst<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>owned<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>new</font> <font face='Lucida Console'>(</font>std::<font color='#BB00BB'>addressof</font><font face='Lucida Console'>(</font>v_h.holder<font color='#5555FF'>&lt;</font>holder_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <font color='#BB00BB'>holder_type</font><font face='Lucida Console'>(</font>v_h.value_ptr<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            v_h.<font color='#BB00BB'>set_holder_constructed</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b>

    <font color='#0000FF'>static</font> <font color='#0000FF'><u>void</u></font> <b><a name='init_holder_from_existing'></a>init_holder_from_existing</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> detail::value_and_holder <font color='#5555FF'>&amp;</font>v_h,
                                          <font color='#0000FF'>const</font> holder_type <font color='#5555FF'>*</font>holder_ptr,
                                          std::true_type <font color='#009900'>/*is_copy_constructible*/</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>new</font> <font face='Lucida Console'>(</font>std::<font color='#BB00BB'>addressof</font><font face='Lucida Console'>(</font>v_h.holder<font color='#5555FF'>&lt;</font>holder_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>
            <font color='#BB00BB'>holder_type</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'>const</font> holder_type <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>holder_ptr<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#0000FF'>static</font> <font color='#0000FF'><u>void</u></font> <b><a name='init_holder_from_existing'></a>init_holder_from_existing</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> detail::value_and_holder <font color='#5555FF'>&amp;</font>v_h,
                                          <font color='#0000FF'>const</font> holder_type <font color='#5555FF'>*</font>holder_ptr,
                                          std::false_type <font color='#009900'>/*is_copy_constructible*/</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>new</font> <font face='Lucida Console'>(</font>std::<font color='#BB00BB'>addressof</font><font face='Lucida Console'>(</font>v_h.holder<font color='#5555FF'>&lt;</font>holder_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>
            <font color='#BB00BB'>holder_type</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>const_cast</font><font color='#5555FF'>&lt;</font>holder_type <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>holder_ptr<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Initialize holder object, variant 2: try to construct from existing holder object, if
</font>    <font color='#009900'>/// possible
</font>    <font color='#0000FF'>static</font> <font color='#0000FF'><u>void</u></font> <b><a name='init_holder'></a>init_holder</b><font face='Lucida Console'>(</font>detail::instance <font color='#5555FF'>*</font>inst,
                            detail::value_and_holder <font color='#5555FF'>&amp;</font>v_h,
                            <font color='#0000FF'>const</font> holder_type <font color='#5555FF'>*</font>holder_ptr,
                            <font color='#0000FF'>const</font> <font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font> <font color='#009900'>/* dummy -- not enable_shared_from_this&lt;T&gt;) */</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>holder_ptr<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>init_holder_from_existing</font><font face='Lucida Console'>(</font>v_h, holder_ptr, std::is_copy_constructible<font color='#5555FF'>&lt;</font>holder_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            v_h.<font color='#BB00BB'>set_holder_constructed</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b> <font color='#0000FF'>else</font> <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>detail::always_construct_holder<font color='#5555FF'>&lt;</font>holder_type<font color='#5555FF'>&gt;</font>::value <font color='#5555FF'>|</font><font color='#5555FF'>|</font> inst<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>owned<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>new</font> <font face='Lucida Console'>(</font>std::<font color='#BB00BB'>addressof</font><font face='Lucida Console'>(</font>v_h.holder<font color='#5555FF'>&lt;</font>holder_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <font color='#BB00BB'>holder_type</font><font face='Lucida Console'>(</font>v_h.value_ptr<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            v_h.<font color='#BB00BB'>set_holder_constructed</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b>

    <font color='#009900'>/// Performs instance initialization including constructing a holder and registering the known
</font>    <font color='#009900'>/// instance.  Should be called as soon as the `type` value_ptr is set for an instance.  Takes
</font>    <font color='#009900'>/// an optional pointer to an existing holder to use; if not specified and the instance is
</font>    <font color='#009900'>/// `.owned`, a new holder will be constructed to manage the value pointer.
</font>    <font color='#0000FF'>static</font> <font color='#0000FF'><u>void</u></font> <b><a name='init_instance'></a>init_instance</b><font face='Lucida Console'>(</font>detail::instance <font color='#5555FF'>*</font>inst, <font color='#0000FF'>const</font> <font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font>holder_ptr<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>auto</font> v_h <font color='#5555FF'>=</font> inst<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#BB00BB'>get_value_and_holder</font><font face='Lucida Console'>(</font>detail::<font color='#BB00BB'>get_type_info</font><font face='Lucida Console'>(</font><font color='#0000FF'>typeid</font><font face='Lucida Console'>(</font>type<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>v_h.<font color='#BB00BB'>instance_registered</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>register_instance</font><font face='Lucida Console'>(</font>inst, v_h.<font color='#BB00BB'>value_ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, v_h.type<font face='Lucida Console'>)</font>;
            v_h.<font color='#BB00BB'>set_instance_registered</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#BB00BB'>init_holder</font><font face='Lucida Console'>(</font>inst, v_h, <font face='Lucida Console'>(</font><font color='#0000FF'>const</font> holder_type <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> holder_ptr, v_h.value_ptr<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Deallocates an instance; via holder, if constructed; otherwise via operator delete.
</font>    <font color='#0000FF'>static</font> <font color='#0000FF'><u>void</u></font> <b><a name='dealloc'></a>dealloc</b><font face='Lucida Console'>(</font>detail::value_and_holder <font color='#5555FF'>&amp;</font>v_h<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#009900'>// We could be deallocating because we are cleaning up after a Python exception.
</font>        <font color='#009900'>// If so, the Python error indicator will be set. We need to clear that before
</font>        <font color='#009900'>// running the destructor, in case the destructor code calls more Python.
</font>        <font color='#009900'>// If we don't, the Python API will exit with an exception, and pybind11 will
</font>        <font color='#009900'>// throw error_already_set from the C++ destructor which is forbidden and triggers
</font>        <font color='#009900'>// std::terminate().
</font>        error_scope scope;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>v_h.<font color='#BB00BB'>holder_constructed</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            v_h.holder<font color='#5555FF'>&lt;</font>holder_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.~<font color='#BB00BB'>holder_type</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            v_h.<font color='#BB00BB'>set_holder_constructed</font><font face='Lucida Console'>(</font><font color='#979000'>false</font><font face='Lucida Console'>)</font>;
        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
            detail::<font color='#BB00BB'>call_operator_delete</font><font face='Lucida Console'>(</font>
                v_h.value_ptr<font color='#5555FF'>&lt;</font>type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, v_h.type<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>type_size, v_h.type<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>type_align<font face='Lucida Console'>)</font>;
        <b>}</b>
        v_h.<font color='#BB00BB'>value_ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> nullptr;
    <b>}</b>

    <font color='#0000FF'>static</font> detail::function_record <font color='#5555FF'>*</font><b><a name='get_function_record'></a>get_function_record</b><font face='Lucida Console'>(</font>handle h<font face='Lucida Console'>)</font> <b>{</b>
        h <font color='#5555FF'>=</font> detail::<font color='#BB00BB'>get_function</font><font face='Lucida Console'>(</font>h<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>h<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> nullptr;
        <b>}</b>

        handle func_self <font color='#5555FF'>=</font> <font color='#BB00BB'>PyCFunction_GET_SELF</font><font face='Lucida Console'>(</font>h.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>func_self<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>throw</font> <font color='#BB00BB'>error_already_set</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>isinstance<font color='#5555FF'>&lt;</font>capsule<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>func_self<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> nullptr;
        <b>}</b>
        <font color='#0000FF'>auto</font> cap <font color='#5555FF'>=</font> reinterpret_borrow<font color='#5555FF'>&lt;</font>capsule<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>func_self<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>detail::<font color='#BB00BB'>is_function_record_capsule</font><font face='Lucida Console'>(</font>cap<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> nullptr;
        <b>}</b>
        <font color='#0000FF'>return</font> cap.get_pointer<font color='#5555FF'>&lt;</font>detail::function_record<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>
<b>}</b>;

<font color='#009900'>/// Binds an existing constructor taking arguments Args...
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Args<font color='#5555FF'>&gt;</font>
detail::initimpl::constructor<font color='#5555FF'>&lt;</font>Args...<font color='#5555FF'>&gt;</font> <b><a name='init'></a>init</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> <b>{</b><b>}</b>;
<b>}</b>
<font color='#009900'>/// Like `init&lt;Args...&gt;()`, but the instance is always constructed through the alias class (even
</font><font color='#009900'>/// when not inheriting on the Python side).
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Args<font color='#5555FF'>&gt;</font>
detail::initimpl::alias_constructor<font color='#5555FF'>&lt;</font>Args...<font color='#5555FF'>&gt;</font> <b><a name='init_alias'></a>init_alias</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> <b>{</b><b>}</b>;
<b>}</b>

<font color='#009900'>/// Binds a factory function as a constructor
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Func, <font color='#0000FF'>typename</font> Ret <font color='#5555FF'>=</font> detail::initimpl::factory<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font>
Ret <b><a name='init'></a>init</b><font face='Lucida Console'>(</font>Func <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>f<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> <b>{</b>std::forward<font color='#5555FF'>&lt;</font>Func<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>f<font face='Lucida Console'>)</font><b>}</b>;
<b>}</b>

<font color='#009900'>/// Dual-argument factory function: the first function is called when no alias is needed, the
</font><font color='#009900'>/// second when an alias is needed (i.e. due to python-side inheritance).  Arguments must be
</font><font color='#009900'>/// identical.
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> CFunc, <font color='#0000FF'>typename</font> AFunc, <font color='#0000FF'>typename</font> Ret <font color='#5555FF'>=</font> detail::initimpl::factory<font color='#5555FF'>&lt;</font>CFunc, AFunc<font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font>
Ret <b><a name='init'></a>init</b><font face='Lucida Console'>(</font>CFunc <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>c, AFunc <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>a<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> <b>{</b>std::forward<font color='#5555FF'>&lt;</font>CFunc<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>c<font face='Lucida Console'>)</font>, std::forward<font color='#5555FF'>&lt;</font>AFunc<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font><b>}</b>;
<b>}</b>

<font color='#009900'>/// Binds pickling functions `__getstate__` and `__setstate__` and ensures that the type
</font><font color='#009900'>/// returned by `__getstate__` is the same as the argument accepted by `__setstate__`.
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> GetState, <font color='#0000FF'>typename</font> SetState<font color='#5555FF'>&gt;</font>
detail::initimpl::pickle_factory<font color='#5555FF'>&lt;</font>GetState, SetState<font color='#5555FF'>&gt;</font> <b><a name='pickle'></a>pickle</b><font face='Lucida Console'>(</font>GetState <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>g, SetState <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>s<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> <b>{</b>std::forward<font color='#5555FF'>&lt;</font>GetState<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>g<font face='Lucida Console'>)</font>, std::forward<font color='#5555FF'>&lt;</font>SetState<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>s<font face='Lucida Console'>)</font><b>}</b>;
<b>}</b>

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#0000FF'>inline</font> str <b><a name='enum_name'></a>enum_name</b><font face='Lucida Console'>(</font>handle arg<font face='Lucida Console'>)</font> <b>{</b>
    dict entries <font color='#5555FF'>=</font> arg.<font color='#BB00BB'>get_type</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__entries</font>"<font face='Lucida Console'>)</font>;
    <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> kv : entries<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#BB00BB'>handle</font><font face='Lucida Console'>(</font>kv.second[<font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font><font color='#979000'>0</font><font face='Lucida Console'>)</font>]<font face='Lucida Console'>)</font>.<font color='#BB00BB'>equal</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>kv.first<font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b>
    <font color='#0000FF'>return</font> "<font color='#CC0000'>???</font>";
<b>}</b>

<font color='#0000FF'>struct</font> <b><a name='enum_base'></a>enum_base</b> <b>{</b>
    <b><a name='enum_base'></a>enum_base</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> handle <font color='#5555FF'>&amp;</font>base, <font color='#0000FF'>const</font> handle <font color='#5555FF'>&amp;</font>parent<font face='Lucida Console'>)</font> : m_base<font face='Lucida Console'>(</font>base<font face='Lucida Console'>)</font>, m_parent<font face='Lucida Console'>(</font>parent<font face='Lucida Console'>)</font> <b>{</b><b>}</b>

    PYBIND11_NOINLINE <font color='#0000FF'><u>void</u></font> <b><a name='init'></a>init</b><font face='Lucida Console'>(</font><font color='#0000FF'><u>bool</u></font> is_arithmetic, <font color='#0000FF'><u>bool</u></font> is_convertible<font face='Lucida Console'>)</font> <b>{</b>
        m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__entries</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>dict</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>auto</font> property <font color='#5555FF'>=</font> <font color='#BB00BB'>handle</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font>PyProperty_Type<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>auto</font> static_property <font color='#5555FF'>=</font> <font color='#BB00BB'>handle</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> <font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.static_property_type<font face='Lucida Console'>)</font>;

        m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__repr__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>
            []<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>arg<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> str <b>{</b>
                handle type <font color='#5555FF'>=</font> type::<font color='#BB00BB'>handle_of</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font>;
                object type_name <font color='#5555FF'>=</font> type.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__name__</font>"<font face='Lucida Console'>)</font>;
                <font color='#0000FF'>return</font> pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>&lt;{}.{}: {}&gt;</font>"<font face='Lucida Console'>)</font>
                    .<font color='#BB00BB'>format</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>type_name<font face='Lucida Console'>)</font>, <font color='#BB00BB'>enum_name</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font>, <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <b>}</b>,
            <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__repr__</font>"<font face='Lucida Console'>)</font>,
            <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font>m_base<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

        m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>name</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>property</font><font face='Lucida Console'>(</font><font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font><font color='#5555FF'>&amp;</font>enum_name, <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>name</font>"<font face='Lucida Console'>)</font>, <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font>m_base<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

        m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__str__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>
            []<font face='Lucida Console'>(</font>handle arg<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> str <b>{</b>
                object type_name <font color='#5555FF'>=</font> type::<font color='#BB00BB'>handle_of</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font>.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__name__</font>"<font face='Lucida Console'>)</font>;
                <font color='#0000FF'>return</font> pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>{}.{}</font>"<font face='Lucida Console'>)</font>.<font color='#BB00BB'>format</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>type_name<font face='Lucida Console'>)</font>, <font color='#BB00BB'>enum_name</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <b>}</b>,
            <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__str__</font>"<font face='Lucida Console'>)</font>,
            <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font>m_base<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>options::<font color='#BB00BB'>show_enum_members_docstring</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__doc__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>static_property</font><font face='Lucida Console'>(</font>
                <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>
                    []<font face='Lucida Console'>(</font>handle arg<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> std::string <b>{</b>
                        std::string docstring;
                        dict entries <font color='#5555FF'>=</font> arg.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__entries</font>"<font face='Lucida Console'>)</font>;
                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> arg.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>tp_doc<font face='Lucida Console'>)</font> <b>{</b>
                            docstring <font color='#5555FF'>+</font><font color='#5555FF'>=</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>
                                <font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font>PyTypeObject <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>arg.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>tp_doc<font face='Lucida Console'>)</font>;
                            docstring <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>\n\n</font>";
                        <b>}</b>
                        docstring <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>Members:</font>";
                        <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> kv : entries<font face='Lucida Console'>)</font> <b>{</b>
                            <font color='#0000FF'>auto</font> key <font color='#5555FF'>=</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>kv.first<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
                            <font color='#0000FF'>auto</font> comment <font color='#5555FF'>=</font> kv.second[<font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font><font color='#979000'>1</font><font face='Lucida Console'>)</font>];
                            docstring <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'>\n\n  </font>";
                            docstring <font color='#5555FF'>+</font><font color='#5555FF'>=</font> key;
                            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>comment.<font color='#BB00BB'>is_none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                                docstring <font color='#5555FF'>+</font><font color='#5555FF'>=</font> "<font color='#CC0000'> : </font>";
                                docstring <font color='#5555FF'>+</font><font color='#5555FF'>=</font> pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>comment<font face='Lucida Console'>)</font>.cast<font color='#5555FF'>&lt;</font>std::string<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                            <b>}</b>
                        <b>}</b>
                        <font color='#0000FF'>return</font> docstring;
                    <b>}</b>,
                    <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__doc__</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                "<font color='#CC0000'></font>"<font face='Lucida Console'>)</font>;
        <b>}</b>

        m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__members__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>static_property</font><font face='Lucida Console'>(</font><font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>
                                                         []<font face='Lucida Console'>(</font>handle arg<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> dict <b>{</b>
                                                             dict entries <font color='#5555FF'>=</font> arg.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__entries</font>"<font face='Lucida Console'>)</font>,
                                                                  m;
                                                             <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> kv : entries<font face='Lucida Console'>)</font> <b>{</b>
                                                                 m[kv.first] <font color='#5555FF'>=</font> kv.second[<font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font><font color='#979000'>0</font><font face='Lucida Console'>)</font>];
                                                             <b>}</b>
                                                             <font color='#0000FF'>return</font> m;
                                                         <b>}</b>,
                                                         <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__members__</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                                                     <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                                                     <font color='#BB00BB'>none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                                                     "<font color='#CC0000'></font>"<font face='Lucida Console'>)</font>;

<font color='#0000FF'>#define</font> PYBIND11_ENUM_OP_STRICT<font face='Lucida Console'>(</font>op, expr, strict_behavior<font face='Lucida Console'>)</font>                                        \
    m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>op<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>                                                               \
        []<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>a, <font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>b<font face='Lucida Console'>)</font> <b>{</b>                                                    \
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>type::<font color='#BB00BB'>handle_of</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font>.<font color='#BB00BB'>is</font><font face='Lucida Console'>(</font>type::<font color='#BB00BB'>handle_of</font><font face='Lucida Console'>(</font>b<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>                                       \
                strict_behavior; <font color='#009900'>/* NOLINT(bugprone-macro-parentheses) */</font>                         \
            <font color='#0000FF'>return</font> expr;                                                                          \
        <b>}</b>,                                                                                        \
        <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>op<font face='Lucida Console'>)</font>,                                                                                 \
        <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font>m_base<font face='Lucida Console'>)</font>,                                                                        \
        <font color='#BB00BB'>arg</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>other</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>

<font color='#0000FF'>#define</font> PYBIND11_ENUM_OP_CONV<font face='Lucida Console'>(</font>op, expr<font face='Lucida Console'>)</font>                                                           \
    m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>op<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>                                                               \
        []<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>a_, <font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>b_<font face='Lucida Console'>)</font> <b>{</b>                                                  \
            int_ <font color='#BB00BB'>a</font><font face='Lucida Console'>(</font>a_<font face='Lucida Console'>)</font>, <font color='#BB00BB'>b</font><font face='Lucida Console'>(</font>b_<font face='Lucida Console'>)</font>;                                                                    \
            <font color='#0000FF'>return</font> expr;                                                                          \
        <b>}</b>,                                                                                        \
        <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>op<font face='Lucida Console'>)</font>,                                                                                 \
        <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font>m_base<font face='Lucida Console'>)</font>,                                                                        \
        <font color='#BB00BB'>arg</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>other</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>

<font color='#0000FF'>#define</font> PYBIND11_ENUM_OP_CONV_LHS<font face='Lucida Console'>(</font>op, expr<font face='Lucida Console'>)</font>                                                       \
    m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>op<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>                                                               \
        []<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>a_, <font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>b<font face='Lucida Console'>)</font> <b>{</b>                                                   \
            int_ <font color='#BB00BB'>a</font><font face='Lucida Console'>(</font>a_<font face='Lucida Console'>)</font>;                                                                           \
            <font color='#0000FF'>return</font> expr;                                                                          \
        <b>}</b>,                                                                                        \
        <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>op<font face='Lucida Console'>)</font>,                                                                                 \
        <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font>m_base<font face='Lucida Console'>)</font>,                                                                        \
        <font color='#BB00BB'>arg</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>other</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>

        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>is_convertible<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV_LHS</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__eq__</font>", <font color='#5555FF'>!</font>b.<font color='#BB00BB'>is_none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> a.<font color='#BB00BB'>equal</font><font face='Lucida Console'>(</font>b<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV_LHS</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__ne__</font>", b.<font color='#BB00BB'>is_none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>|</font><font color='#5555FF'>|</font> <font color='#5555FF'>!</font>a.<font color='#BB00BB'>equal</font><font face='Lucida Console'>(</font>b<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>is_arithmetic<font face='Lucida Console'>)</font> <b>{</b>
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__lt__</font>", a <font color='#5555FF'>&lt;</font> b<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__gt__</font>", a <font color='#5555FF'>&gt;</font> b<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__le__</font>", a <font color='#5555FF'>&lt;</font><font color='#5555FF'>=</font> b<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__ge__</font>", a <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> b<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__and__</font>", a <font color='#5555FF'>&amp;</font> b<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__rand__</font>", a <font color='#5555FF'>&amp;</font> b<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__or__</font>", a <font color='#5555FF'>|</font> b<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__ror__</font>", a <font color='#5555FF'>|</font> b<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__xor__</font>", a ^ b<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_CONV</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__rxor__</font>", a ^ b<font face='Lucida Console'>)</font>;
                m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__invert__</font>"<font face='Lucida Console'>)</font>
                    <font color='#5555FF'>=</font> <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>[]<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>arg<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> ~<font face='Lucida Console'>(</font><font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>; <b>}</b>,
                                   <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__invert__</font>"<font face='Lucida Console'>)</font>,
                                   <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font>m_base<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <b>}</b>
        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
            <font color='#BB00BB'>PYBIND11_ENUM_OP_STRICT</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__eq__</font>", <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font>.<font color='#BB00BB'>equal</font><font face='Lucida Console'>(</font><font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>b<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>, <font color='#0000FF'>return</font> <font color='#979000'>false</font><font face='Lucida Console'>)</font>;
            <font color='#BB00BB'>PYBIND11_ENUM_OP_STRICT</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__ne__</font>", <font color='#5555FF'>!</font><font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font>.<font color='#BB00BB'>equal</font><font face='Lucida Console'>(</font><font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>b<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>, <font color='#0000FF'>return</font> <font color='#979000'>true</font><font face='Lucida Console'>)</font>;

            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>is_arithmetic<font face='Lucida Console'>)</font> <b>{</b>
<font color='#0000FF'>#define</font> PYBIND11_THROW <font color='#0000FF'>throw</font> type_error<font face='Lucida Console'>(</font>"<font color='#CC0000'>Expected an enumeration of matching type!</font>"<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_STRICT</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__lt__</font>", <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font> <font color='#5555FF'>&lt;</font> <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>b<font face='Lucida Console'>)</font>, PYBIND11_THROW<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_STRICT</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__gt__</font>", <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font> <font color='#5555FF'>&gt;</font> <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>b<font face='Lucida Console'>)</font>, PYBIND11_THROW<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_STRICT</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__le__</font>", <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>=</font> <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>b<font face='Lucida Console'>)</font>, PYBIND11_THROW<font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>PYBIND11_ENUM_OP_STRICT</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__ge__</font>", <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>a<font face='Lucida Console'>)</font> <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>b<font face='Lucida Console'>)</font>, PYBIND11_THROW<font face='Lucida Console'>)</font>;
<font color='#0000FF'>#undef</font> PYBIND11_THROW
            <b>}</b>
        <b>}</b>

<font color='#0000FF'>#undef</font> PYBIND11_ENUM_OP_CONV_LHS
<font color='#0000FF'>#undef</font> PYBIND11_ENUM_OP_CONV
<font color='#0000FF'>#undef</font> PYBIND11_ENUM_OP_STRICT

        m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__getstate__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>
            []<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>arg<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font>; <b>}</b>, <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__getstate__</font>"<font face='Lucida Console'>)</font>, <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font>m_base<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

        m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__hash__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>
            []<font face='Lucida Console'>(</font><font color='#0000FF'>const</font> object <font color='#5555FF'>&amp;</font>arg<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> <font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font>; <b>}</b>, <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__hash__</font>"<font face='Lucida Console'>)</font>, <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font>m_base<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    PYBIND11_NOINLINE <font color='#0000FF'><u>void</u></font> <b><a name='value'></a>value</b><font face='Lucida Console'>(</font><font color='#0000FF'><u>char</u></font> <font color='#0000FF'>const</font> <font color='#5555FF'>*</font>name_, object value, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>doc <font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
        dict entries <font color='#5555FF'>=</font> m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__entries</font>"<font face='Lucida Console'>)</font>;
        str <font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>name_<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>entries.<font color='#BB00BB'>contains</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            std::string type_name <font color='#5555FF'>=</font> <font face='Lucida Console'>(</font>std::string<font face='Lucida Console'>)</font> <font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__name__</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>throw</font> <font color='#BB00BB'>value_error</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>type_name<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>: element \"</font>" <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>name_<font face='Lucida Console'>)</font>
                              <font color='#5555FF'>+</font> "<font color='#CC0000'>\" already exists!</font>"<font face='Lucida Console'>)</font>;
        <b>}</b>

        entries[name] <font color='#5555FF'>=</font> pybind11::<font color='#BB00BB'>make_tuple</font><font face='Lucida Console'>(</font>value, doc<font face='Lucida Console'>)</font>;
        m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font>;
    <b>}</b>

    PYBIND11_NOINLINE <font color='#0000FF'><u>void</u></font> <b><a name='export_values'></a>export_values</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b>
        dict entries <font color='#5555FF'>=</font> m_base.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__entries</font>"<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> kv : entries<font face='Lucida Console'>)</font> <b>{</b>
            m_parent.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>kv.first<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> kv.second[<font color='#BB00BB'>int_</font><font face='Lucida Console'>(</font><font color='#979000'>0</font><font face='Lucida Console'>)</font>];
        <b>}</b>
    <b>}</b>

    handle m_base;
    handle m_parent;
<b>}</b>;

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'><u>bool</u></font> is_signed, <font color='#0000FF'><u>size_t</u></font> length<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='equivalent_integer'></a>equivalent_integer</b> <b>{</b><b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='equivalent_integer'></a>equivalent_integer</b><font color='#5555FF'>&lt;</font><font color='#979000'>true</font>, <font color='#979000'>1</font><font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>using</font> type <font color='#5555FF'>=</font> int8_t;
<b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='equivalent_integer'></a>equivalent_integer</b><font color='#5555FF'>&lt;</font><font color='#979000'>false</font>, <font color='#979000'>1</font><font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>using</font> type <font color='#5555FF'>=</font> uint8_t;
<b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='equivalent_integer'></a>equivalent_integer</b><font color='#5555FF'>&lt;</font><font color='#979000'>true</font>, <font color='#979000'>2</font><font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>using</font> type <font color='#5555FF'>=</font> int16_t;
<b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='equivalent_integer'></a>equivalent_integer</b><font color='#5555FF'>&lt;</font><font color='#979000'>false</font>, <font color='#979000'>2</font><font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>using</font> type <font color='#5555FF'>=</font> uint16_t;
<b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='equivalent_integer'></a>equivalent_integer</b><font color='#5555FF'>&lt;</font><font color='#979000'>true</font>, <font color='#979000'>4</font><font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>using</font> type <font color='#5555FF'>=</font> int32_t;
<b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='equivalent_integer'></a>equivalent_integer</b><font color='#5555FF'>&lt;</font><font color='#979000'>false</font>, <font color='#979000'>4</font><font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>using</font> type <font color='#5555FF'>=</font> uint32_t;
<b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='equivalent_integer'></a>equivalent_integer</b><font color='#5555FF'>&lt;</font><font color='#979000'>true</font>, <font color='#979000'>8</font><font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>using</font> type <font color='#5555FF'>=</font> int64_t;
<b>}</b>;
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='equivalent_integer'></a>equivalent_integer</b><font color='#5555FF'>&lt;</font><font color='#979000'>false</font>, <font color='#979000'>8</font><font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>using</font> type <font color='#5555FF'>=</font> uint64_t;
<b>}</b>;

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> IntLike<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>using</font> equivalent_integer_t <font color='#5555FF'>=</font>
    <font color='#0000FF'>typename</font> equivalent_integer<font color='#5555FF'>&lt;</font>std::is_signed<font color='#5555FF'>&lt;</font>IntLike<font color='#5555FF'>&gt;</font>::value, <font color='#0000FF'>sizeof</font><font face='Lucida Console'>(</font>IntLike<font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>::type;

<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#009900'>/// Binds C++ enumerations and enumeration classes to Python
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Type<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>class</font> <b><a name='enum_'></a>enum_</b> : <font color='#0000FF'>public</font> class_<font color='#5555FF'>&lt;</font>Type<font color='#5555FF'>&gt;</font> <b>{</b>
<font color='#0000FF'>public</font>:
    <font color='#0000FF'>using</font> Base <font color='#5555FF'>=</font> class_<font color='#5555FF'>&lt;</font>Type<font color='#5555FF'>&gt;</font>;
    <font color='#0000FF'>using</font> Base::attr;
    <font color='#0000FF'>using</font> Base::def;
    <font color='#0000FF'>using</font> Base::def_property_readonly;
    <font color='#0000FF'>using</font> Base::def_property_readonly_static;
    <font color='#0000FF'>using</font> Underlying <font color='#5555FF'>=</font> <font color='#0000FF'>typename</font> std::underlying_type<font color='#5555FF'>&lt;</font>Type<font color='#5555FF'>&gt;</font>::type;
    <font color='#009900'>// Scalar is the integer representation of underlying type
</font>    <font color='#0000FF'>using</font> Scalar <font color='#5555FF'>=</font> detail::conditional_t<font color='#5555FF'>&lt;</font>detail::any_of<font color='#5555FF'>&lt;</font>detail::is_std_char_type<font color='#5555FF'>&lt;</font>Underlying<font color='#5555FF'>&gt;</font>,
                                                        std::is_same<font color='#5555FF'>&lt;</font>Underlying, <font color='#0000FF'><u>bool</u></font><font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font>::value,
                                         detail::equivalent_integer_t<font color='#5555FF'>&lt;</font>Underlying<font color='#5555FF'>&gt;</font>,
                                         Underlying<font color='#5555FF'>&gt;</font>;

    <font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
    <b><a name='enum_'></a>enum_</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> handle <font color='#5555FF'>&amp;</font>scope, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, <font color='#0000FF'>const</font> Extra <font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font>
        : class_<font color='#5555FF'>&lt;</font>Type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>scope, name, extra...<font face='Lucida Console'>)</font>, m_base<font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, scope<font face='Lucida Console'>)</font> <b>{</b>
        constexpr <font color='#0000FF'><u>bool</u></font> is_arithmetic <font color='#5555FF'>=</font> detail::any_of<font color='#5555FF'>&lt;</font>std::is_same<font color='#5555FF'>&lt;</font>arithmetic, Extra<font color='#5555FF'>&gt;</font>...<font color='#5555FF'>&gt;</font>::value;
        constexpr <font color='#0000FF'><u>bool</u></font> is_convertible <font color='#5555FF'>=</font> std::is_convertible<font color='#5555FF'>&lt;</font>Type, Underlying<font color='#5555FF'>&gt;</font>::value;
        m_base.<font color='#BB00BB'>init</font><font face='Lucida Console'>(</font>is_arithmetic, is_convertible<font face='Lucida Console'>)</font>;

        <font color='#BB00BB'>def</font><font face='Lucida Console'>(</font><font color='#BB00BB'>init</font><font face='Lucida Console'>(</font>[]<font face='Lucida Console'>(</font>Scalar i<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> <font color='#0000FF'>static_cast</font><font color='#5555FF'>&lt;</font>Type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>i<font face='Lucida Console'>)</font>; <b>}</b><font face='Lucida Console'>)</font>, <font color='#BB00BB'>arg</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>value</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>def_property_readonly</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>value</font>", []<font face='Lucida Console'>(</font>Type value<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font>Scalar<font face='Lucida Console'>)</font> value; <b>}</b><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>def</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__int__</font>", []<font face='Lucida Console'>(</font>Type value<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font>Scalar<font face='Lucida Console'>)</font> value; <b>}</b><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>def</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__index__</font>", []<font face='Lucida Console'>(</font>Type value<font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font>Scalar<font face='Lucida Console'>)</font> value; <b>}</b><font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__setstate__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>
            []<font face='Lucida Console'>(</font>detail::value_and_holder <font color='#5555FF'>&amp;</font>v_h, Scalar arg<font face='Lucida Console'>)</font> <b>{</b>
                detail::initimpl::setstate<font color='#5555FF'>&lt;</font>Base<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>
                    v_h, <font color='#0000FF'>static_cast</font><font color='#5555FF'>&lt;</font>Type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>arg<font face='Lucida Console'>)</font>, <font color='#BB00BB'>Py_TYPE</font><font face='Lucida Console'>(</font>v_h.inst<font face='Lucida Console'>)</font> <font color='#5555FF'>!</font><font color='#5555FF'>=</font> v_h.type<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>type<font face='Lucida Console'>)</font>;
            <b>}</b>,
            detail::<font color='#BB00BB'>is_new_style_constructor</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
            pybind11::<font color='#BB00BB'>name</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__setstate__</font>"<font face='Lucida Console'>)</font>,
            <font color='#BB00BB'>is_method</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font>,
            <font color='#BB00BB'>arg</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>state</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/// Export enumeration entries into the parent scope
</font>    enum_ <font color='#5555FF'>&amp;</font><b><a name='export_values'></a>export_values</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b>
        m_base.<font color='#BB00BB'>export_values</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#009900'>/// Add an enumeration entry
</font>    enum_ <font color='#5555FF'>&amp;</font><b><a name='value'></a>value</b><font face='Lucida Console'>(</font><font color='#0000FF'><u>char</u></font> <font color='#0000FF'>const</font> <font color='#5555FF'>*</font>name, Type value, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>doc <font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
        m_base.<font color='#BB00BB'>value</font><font face='Lucida Console'>(</font>name, pybind11::<font color='#BB00BB'>cast</font><font face='Lucida Console'>(</font>value, return_value_policy::copy<font face='Lucida Console'>)</font>, doc<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

<font color='#0000FF'>private</font>:
    detail::enum_base m_base;
<b>}</b>;

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

PYBIND11_NOINLINE <font color='#0000FF'><u>void</u></font> <b><a name='keep_alive_impl'></a>keep_alive_impl</b><font face='Lucida Console'>(</font>handle nurse, handle patient<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>nurse <font color='#5555FF'>|</font><font color='#5555FF'>|</font> <font color='#5555FF'>!</font>patient<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>Could not activate keep_alive!</font>"<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>patient.<font color='#BB00BB'>is_none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>|</font><font color='#5555FF'>|</font> nurse.<font color='#BB00BB'>is_none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font>; <font color='#009900'>/* Nothing to keep alive or nothing to be kept alive by */</font>
    <b>}</b>

    <font color='#0000FF'>auto</font> tinfo <font color='#5555FF'>=</font> <font color='#BB00BB'>all_type_info</font><font face='Lucida Console'>(</font><font color='#BB00BB'>Py_TYPE</font><font face='Lucida Console'>(</font>nurse.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>tinfo.<font color='#BB00BB'>empty</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#009900'>/* It's a pybind-registered type, so we can store the patient in the
         * internal list. */</font>
        <font color='#BB00BB'>add_patient</font><font face='Lucida Console'>(</font>nurse.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, patient.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
        <font color='#009900'>/* Fall back to clever approach based on weak references taken from
         * Boost.Python. This is not used for pybind-registered types because
         * the objects can be destroyed out-of-order in a GC pass. */</font>
        cpp_function <font color='#BB00BB'>disable_lifesupport</font><font face='Lucida Console'>(</font>[patient]<font face='Lucida Console'>(</font>handle weakref<font face='Lucida Console'>)</font> <b>{</b>
            patient.<font color='#BB00BB'>dec_ref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            weakref.<font color='#BB00BB'>dec_ref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b><font face='Lucida Console'>)</font>;

        weakref <font color='#BB00BB'>wr</font><font face='Lucida Console'>(</font>nurse, disable_lifesupport<font face='Lucida Console'>)</font>;

        patient.<font color='#BB00BB'>inc_ref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>; <font color='#009900'>/* reference patient and leak the weak reference */</font>
        <font face='Lucida Console'>(</font><font color='#0000FF'><u>void</u></font><font face='Lucida Console'>)</font> wr.<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>
<b>}</b>

PYBIND11_NOINLINE <font color='#0000FF'><u>void</u></font>
<b><a name='keep_alive_impl'></a>keep_alive_impl</b><font face='Lucida Console'>(</font><font color='#0000FF'><u>size_t</u></font> Nurse, <font color='#0000FF'><u>size_t</u></font> Patient, function_call <font color='#5555FF'>&amp;</font>call, handle ret<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>auto</font> get_arg <font color='#5555FF'>=</font> [<font color='#5555FF'>&amp;</font>]<font face='Lucida Console'>(</font><font color='#0000FF'><u>size_t</u></font> n<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>n <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>0</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> ret;
        <b>}</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>n <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#979000'>1</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> call.init_self<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> call.init_self;
        <b>}</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>n <font color='#5555FF'>&lt;</font><font color='#5555FF'>=</font> call.args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> call.args[n <font color='#5555FF'>-</font> <font color='#979000'>1</font>];
        <b>}</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>handle</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>;

    <font color='#BB00BB'>keep_alive_impl</font><font face='Lucida Console'>(</font><font color='#BB00BB'>get_arg</font><font face='Lucida Console'>(</font>Nurse<font face='Lucida Console'>)</font>, <font color='#BB00BB'>get_arg</font><font face='Lucida Console'>(</font>Patient<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#0000FF'>inline</font> std::pair<font color='#5555FF'>&lt;</font><b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font>internals::registered_types_py<font face='Lucida Console'>)</font>::iterator, <font color='#0000FF'><u>bool</u></font><font color='#5555FF'>&gt;</font>
all_type_info_get_cache<font face='Lucida Console'>(</font>PyTypeObject <font color='#5555FF'>*</font>type<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>auto</font> res <font color='#5555FF'>=</font> <font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>
                   .registered_types_py
<font color='#0000FF'>#ifdef</font> __cpp_lib_unordered_map_try_emplace
                   .<font color='#BB00BB'>try_emplace</font><font face='Lucida Console'>(</font>type<font face='Lucida Console'>)</font>;
<font color='#0000FF'>#else</font>
                   .<font color='#BB00BB'>emplace</font><font face='Lucida Console'>(</font>type, std::vector<font color='#5555FF'>&lt;</font>detail::type_info <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
<font color='#0000FF'>#endif</font>
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>res.second<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#009900'>// New cache entry created; set up a weak reference to automatically remove it if the type
</font>        <font color='#009900'>// gets destroyed:
</font>        <font color='#BB00BB'>weakref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> type, <font color='#BB00BB'>cpp_function</font><font face='Lucida Console'>(</font>[type]<font face='Lucida Console'>(</font>handle wr<font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.registered_types_py.<font color='#BB00BB'>erase</font><font face='Lucida Console'>(</font>type<font face='Lucida Console'>)</font>;

                    <font color='#009900'>// TODO consolidate the erasure code in pybind11_meta_dealloc() in class.h
</font>                    <font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>cache <font color='#5555FF'>=</font> <font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.inactive_override_cache;
                    <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> it <font color='#5555FF'>=</font> cache.<font color='#BB00BB'>begin</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, last <font color='#5555FF'>=</font> cache.<font color='#BB00BB'>end</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>; it <font color='#5555FF'>!</font><font color='#5555FF'>=</font> last;<font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>it<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>first <font color='#5555FF'>=</font><font color='#5555FF'>=</font> <font color='#0000FF'>reinterpret_cast</font><font color='#5555FF'>&lt;</font>PyObject <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>type<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                            it <font color='#5555FF'>=</font> cache.<font color='#BB00BB'>erase</font><font face='Lucida Console'>(</font>it<font face='Lucida Console'>)</font>;
                        <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                            <font color='#5555FF'>+</font><font color='#5555FF'>+</font>it;
                        <b>}</b>
                    <b>}</b>

                    wr.<font color='#BB00BB'>dec_ref</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                <b>}</b><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>
            .<font color='#BB00BB'>release</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#0000FF'>return</font> res;
<b>}</b>

<font color='#009900'>/* There are a large number of apparently unused template arguments because
 * each combination requires a separate py::class_ registration.
 */</font>
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Access,
          return_value_policy Policy,
          <font color='#0000FF'>typename</font> Iterator,
          <font color='#0000FF'>typename</font> Sentinel,
          <font color='#0000FF'>typename</font> ValueType,
          <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='iterator_state'></a>iterator_state</b> <b>{</b>
    Iterator it;
    Sentinel end;
    <font color='#0000FF'><u>bool</u></font> first_or_done;
<b>}</b>;

<font color='#009900'>// Note: these helpers take the iterator by non-const reference because some
</font><font color='#009900'>// iterators in the wild can't be dereferenced when const. The &amp; after Iterator
</font><font color='#009900'>// is required for MSVC &lt; 16.9. SFINAE cannot be reused for result_type due to
</font><font color='#009900'>// bugs in ICC, NVCC, and PGI compilers. See PR #3293.
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Iterator, <font color='#0000FF'>typename</font> SFINAE <font color='#5555FF'>=</font> <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='iterator_access'></a>iterator_access</b> <b>{</b>
    <font color='#0000FF'>using</font> result_type <font color='#5555FF'>=</font> <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <font color='#009900'>// NOLINTNEXTLINE(readability-const-return-type) // PR #3263
</font>    result_type <b><a name='operator'></a>operator</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Iterator <font color='#5555FF'>&amp;</font>it<font face='Lucida Console'>)</font> <font color='#0000FF'>const</font> <b>{</b> <font color='#0000FF'>return</font> <font color='#5555FF'>*</font>it; <b>}</b>
<b>}</b>;

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Iterator, <font color='#0000FF'>typename</font> SFINAE <font color='#5555FF'>=</font> <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>.first<font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>class</font> <b><a name='iterator_key_access'></a>iterator_key_access</b> <b>{</b>
<font color='#0000FF'>private</font>:
    <font color='#0000FF'>using</font> pair_type <font color='#5555FF'>=</font> <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

<font color='#0000FF'>public</font>:
    <font color='#009900'>/* If either the pair itself or the element of the pair is a reference, we
     * want to return a reference, otherwise a value. When the decltype
     * expression is parenthesized it is based on the value category of the
     * expression; otherwise it is the declared type of the pair member.
     * The use of declval&lt;pair_type&gt; in the second branch rather than directly
     * using *std::declval&lt;Iterator &amp;&gt;() is a workaround for nvcc
     * (it's not used in the first branch because going via decltype and back
     * through declval does not perfectly preserve references).
     */</font>
    <font color='#0000FF'>using</font> result_type
        <font color='#5555FF'>=</font> conditional_t<font color='#5555FF'>&lt;</font>std::is_reference<font color='#5555FF'>&lt;</font><b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>::value,
                        <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>.first<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                        <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font>std::declval<font color='#5555FF'>&lt;</font>pair_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.first<font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>;
    result_type <b><a name='operator'></a>operator</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Iterator <font color='#5555FF'>&amp;</font>it<font face='Lucida Console'>)</font> <font color='#0000FF'>const</font> <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font><font color='#5555FF'>*</font>it<font face='Lucida Console'>)</font>.first; <b>}</b>
<b>}</b>;

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Iterator, <font color='#0000FF'>typename</font> SFINAE <font color='#5555FF'>=</font> <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>.second<font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>class</font> <b><a name='iterator_value_access'></a>iterator_value_access</b> <b>{</b>
<font color='#0000FF'>private</font>:
    <font color='#0000FF'>using</font> pair_type <font color='#5555FF'>=</font> <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

<font color='#0000FF'>public</font>:
    <font color='#0000FF'>using</font> result_type
        <font color='#5555FF'>=</font> conditional_t<font color='#5555FF'>&lt;</font>std::is_reference<font color='#5555FF'>&lt;</font><b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>::value,
                        <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font>std::declval<font color='#5555FF'>&lt;</font>Iterator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>.second<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>,
                        <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font>std::declval<font color='#5555FF'>&lt;</font>pair_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.second<font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>;
    result_type <b><a name='operator'></a>operator</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>Iterator <font color='#5555FF'>&amp;</font>it<font face='Lucida Console'>)</font> <font color='#0000FF'>const</font> <b>{</b> <font color='#0000FF'>return</font> <font face='Lucida Console'>(</font><font color='#5555FF'>*</font>it<font face='Lucida Console'>)</font>.second; <b>}</b>
<b>}</b>;

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> Access,
          return_value_policy Policy,
          <font color='#0000FF'>typename</font> Iterator,
          <font color='#0000FF'>typename</font> Sentinel,
          <font color='#0000FF'>typename</font> ValueType,
          <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
iterator <b><a name='make_iterator_impl'></a>make_iterator_impl</b><font face='Lucida Console'>(</font>Iterator first, Sentinel last, Extra <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>using</font> state <font color='#5555FF'>=</font> detail::iterator_state<font color='#5555FF'>&lt;</font>Access, Policy, Iterator, Sentinel, ValueType, Extra...<font color='#5555FF'>&gt;</font>;
    <font color='#009900'>// TODO: state captures only the types of Extra, not the values
</font>
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>detail::<font color='#BB00BB'>get_type_info</font><font face='Lucida Console'>(</font><font color='#0000FF'>typeid</font><font face='Lucida Console'>(</font>state<font face='Lucida Console'>)</font>, <font color='#979000'>false</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        class_<font color='#5555FF'>&lt;</font>state<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#BB00BB'>handle</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, "<font color='#CC0000'>iterator</font>", pybind11::<font color='#BB00BB'>module_local</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>
            .<font color='#BB00BB'>def</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__iter__</font>", []<font face='Lucida Console'>(</font>state <font color='#5555FF'>&amp;</font>s<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> state <font color='#5555FF'>&amp;</font> <b>{</b> <font color='#0000FF'>return</font> s; <b>}</b><font face='Lucida Console'>)</font>
            .<font color='#BB00BB'>def</font><font face='Lucida Console'>(</font>
                "<font color='#CC0000'>__next__</font>",
                []<font face='Lucida Console'>(</font>state <font color='#5555FF'>&amp;</font>s<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> ValueType <b>{</b>
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>s.first_or_done<font face='Lucida Console'>)</font> <b>{</b>
                        <font color='#5555FF'>+</font><font color='#5555FF'>+</font>s.it;
                    <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
                        s.first_or_done <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
                    <b>}</b>
                    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>s.it <font color='#5555FF'>=</font><font color='#5555FF'>=</font> s.end<font face='Lucida Console'>)</font> <b>{</b>
                        s.first_or_done <font color='#5555FF'>=</font> <font color='#979000'>true</font>;
                        <font color='#0000FF'>throw</font> <font color='#BB00BB'>stop_iteration</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                    <b>}</b>
                    <font color='#0000FF'>return</font> <font color='#BB00BB'>Access</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>s.it<font face='Lucida Console'>)</font>;
                    <font color='#009900'>// NOLINTNEXTLINE(readability-const-return-type) // PR #3263
</font>                <b>}</b>,
                std::forward<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>extra<font face='Lucida Console'>)</font>...,
                Policy<font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#0000FF'>return</font> <font color='#BB00BB'>cast</font><font face='Lucida Console'>(</font>state<b>{</b>std::forward<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>first<font face='Lucida Console'>)</font>, std::forward<font color='#5555FF'>&lt;</font>Sentinel<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>last<font face='Lucida Console'>)</font>, <font color='#979000'>true</font><b>}</b><font face='Lucida Console'>)</font>;
<b>}</b>

<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#009900'>/// Makes a python iterator from a first and past-the-end C++ InputIterator.
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font>return_value_policy Policy <font color='#5555FF'>=</font> return_value_policy::reference_internal,
          <font color='#0000FF'>typename</font> Iterator,
          <font color='#0000FF'>typename</font> Sentinel,
          <font color='#0000FF'>typename</font> ValueType <font color='#5555FF'>=</font> <font color='#0000FF'>typename</font> detail::iterator_access<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font>::result_type,
          <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
typing::Iterator<font color='#5555FF'>&lt;</font>ValueType<font color='#5555FF'>&gt;</font> <b><a name='make_iterator'></a>make_iterator</b><font face='Lucida Console'>(</font>Iterator first, Sentinel last, Extra <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> detail::make_iterator_impl<font color='#5555FF'>&lt;</font>detail::iterator_access<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font>,
                                      Policy,
                                      Iterator,
                                      Sentinel,
                                      ValueType,
                                      Extra...<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>first<font face='Lucida Console'>)</font>,
                                                std::forward<font color='#5555FF'>&lt;</font>Sentinel<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>last<font face='Lucida Console'>)</font>,
                                                std::forward<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>extra<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#009900'>/// Makes a python iterator over the keys (`.first`) of a iterator over pairs from a
</font><font color='#009900'>/// first and past-the-end InputIterator.
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font>return_value_policy Policy <font color='#5555FF'>=</font> return_value_policy::reference_internal,
          <font color='#0000FF'>typename</font> Iterator,
          <font color='#0000FF'>typename</font> Sentinel,
          <font color='#0000FF'>typename</font> KeyType <font color='#5555FF'>=</font> <font color='#0000FF'>typename</font> detail::iterator_key_access<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font>::result_type,
          <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
typing::Iterator<font color='#5555FF'>&lt;</font>KeyType<font color='#5555FF'>&gt;</font> <b><a name='make_key_iterator'></a>make_key_iterator</b><font face='Lucida Console'>(</font>Iterator first, Sentinel last, Extra <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> detail::make_iterator_impl<font color='#5555FF'>&lt;</font>detail::iterator_key_access<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font>,
                                      Policy,
                                      Iterator,
                                      Sentinel,
                                      KeyType,
                                      Extra...<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>first<font face='Lucida Console'>)</font>,
                                                std::forward<font color='#5555FF'>&lt;</font>Sentinel<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>last<font face='Lucida Console'>)</font>,
                                                std::forward<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>extra<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#009900'>/// Makes a python iterator over the values (`.second`) of a iterator over pairs from a
</font><font color='#009900'>/// first and past-the-end InputIterator.
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font>return_value_policy Policy <font color='#5555FF'>=</font> return_value_policy::reference_internal,
          <font color='#0000FF'>typename</font> Iterator,
          <font color='#0000FF'>typename</font> Sentinel,
          <font color='#0000FF'>typename</font> ValueType <font color='#5555FF'>=</font> <font color='#0000FF'>typename</font> detail::iterator_value_access<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font>::result_type,
          <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
typing::Iterator<font color='#5555FF'>&lt;</font>ValueType<font color='#5555FF'>&gt;</font> <b><a name='make_value_iterator'></a>make_value_iterator</b><font face='Lucida Console'>(</font>Iterator first, Sentinel last, Extra <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> detail::make_iterator_impl<font color='#5555FF'>&lt;</font>detail::iterator_value_access<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font>,
                                      Policy,
                                      Iterator,
                                      Sentinel,
                                      ValueType,
                                      Extra...<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Iterator<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>first<font face='Lucida Console'>)</font>,
                                                std::forward<font color='#5555FF'>&lt;</font>Sentinel<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>last<font face='Lucida Console'>)</font>,
                                                std::forward<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>extra<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#009900'>/// Makes an iterator over values of an stl container or other container supporting
</font><font color='#009900'>/// `std::begin()`/`std::end()`
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font>return_value_policy Policy <font color='#5555FF'>=</font> return_value_policy::reference_internal,
          <font color='#0000FF'>typename</font> Type,
          <font color='#0000FF'>typename</font> ValueType <font color='#5555FF'>=</font> <font color='#0000FF'>typename</font> detail::iterator_access<font color='#5555FF'>&lt;</font>
              <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>begin</font><font face='Lucida Console'>(</font>std::declval<font color='#5555FF'>&lt;</font>Type <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>::result_type,
          <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
typing::Iterator<font color='#5555FF'>&lt;</font>ValueType<font color='#5555FF'>&gt;</font> <b><a name='make_iterator'></a>make_iterator</b><font face='Lucida Console'>(</font>Type <font color='#5555FF'>&amp;</font>value, Extra <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> make_iterator<font color='#5555FF'>&lt;</font>Policy<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>
        std::<font color='#BB00BB'>begin</font><font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font>, std::<font color='#BB00BB'>end</font><font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font>, std::forward<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>extra<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#009900'>/// Makes an iterator over the keys (`.first`) of a stl map-like container supporting
</font><font color='#009900'>/// `std::begin()`/`std::end()`
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font>return_value_policy Policy <font color='#5555FF'>=</font> return_value_policy::reference_internal,
          <font color='#0000FF'>typename</font> Type,
          <font color='#0000FF'>typename</font> KeyType <font color='#5555FF'>=</font> <font color='#0000FF'>typename</font> detail::iterator_key_access<font color='#5555FF'>&lt;</font>
              <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>begin</font><font face='Lucida Console'>(</font>std::declval<font color='#5555FF'>&lt;</font>Type <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>::result_type,
          <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
typing::Iterator<font color='#5555FF'>&lt;</font>KeyType<font color='#5555FF'>&gt;</font> <b><a name='make_key_iterator'></a>make_key_iterator</b><font face='Lucida Console'>(</font>Type <font color='#5555FF'>&amp;</font>value, Extra <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> make_key_iterator<font color='#5555FF'>&lt;</font>Policy<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>
        std::<font color='#BB00BB'>begin</font><font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font>, std::<font color='#BB00BB'>end</font><font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font>, std::forward<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>extra<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#009900'>/// Makes an iterator over the values (`.second`) of a stl map-like container supporting
</font><font color='#009900'>/// `std::begin()`/`std::end()`
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font>return_value_policy Policy <font color='#5555FF'>=</font> return_value_policy::reference_internal,
          <font color='#0000FF'>typename</font> Type,
          <font color='#0000FF'>typename</font> ValueType <font color='#5555FF'>=</font> <font color='#0000FF'>typename</font> detail::iterator_value_access<font color='#5555FF'>&lt;</font>
              <b><a name='decltype'></a>decltype</b><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>begin</font><font face='Lucida Console'>(</font>std::declval<font color='#5555FF'>&lt;</font>Type <font color='#5555FF'>&amp;</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font color='#5555FF'>&gt;</font>::result_type,
          <font color='#0000FF'>typename</font>... Extra<font color='#5555FF'>&gt;</font>
typing::Iterator<font color='#5555FF'>&lt;</font>ValueType<font color='#5555FF'>&gt;</font> <b><a name='make_value_iterator'></a>make_value_iterator</b><font face='Lucida Console'>(</font>Type <font color='#5555FF'>&amp;</font>value, Extra <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>...extra<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> make_value_iterator<font color='#5555FF'>&lt;</font>Policy<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>
        std::<font color='#BB00BB'>begin</font><font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font>, std::<font color='#BB00BB'>end</font><font face='Lucida Console'>(</font>value<font face='Lucida Console'>)</font>, std::forward<font color='#5555FF'>&lt;</font>Extra<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>extra<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> InputType, <font color='#0000FF'>typename</font> OutputType<font color='#5555FF'>&gt;</font>
<font color='#0000FF'><u>void</u></font> <b><a name='implicitly_convertible'></a>implicitly_convertible</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>struct</font> <b><a name='set_flag'></a>set_flag</b> <b>{</b>
        <font color='#0000FF'><u>bool</u></font> <font color='#5555FF'>&amp;</font>flag;
        <font color='#0000FF'>explicit</font> <b><a name='set_flag'></a>set_flag</b><font face='Lucida Console'>(</font><font color='#0000FF'><u>bool</u></font> <font color='#5555FF'>&amp;</font>flag_<font face='Lucida Console'>)</font> : flag<font face='Lucida Console'>(</font>flag_<font face='Lucida Console'>)</font> <b>{</b> flag_ <font color='#5555FF'>=</font> <font color='#979000'>true</font>; <b>}</b>
        ~<b><a name='set_flag'></a>set_flag</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b> flag <font color='#5555FF'>=</font> <font color='#979000'>false</font>; <b>}</b>
    <b>}</b>;
    <font color='#0000FF'>auto</font> implicit_caster <font color='#5555FF'>=</font> []<font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font>obj, PyTypeObject <font color='#5555FF'>*</font>type<font face='Lucida Console'>)</font> <font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font> PyObject <font color='#5555FF'>*</font> <b>{</b>
        <font color='#0000FF'>static</font> <font color='#0000FF'><u>bool</u></font> currently_used <font color='#5555FF'>=</font> <font color='#979000'>false</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>currently_used<font face='Lucida Console'>)</font> <b>{</b> <font color='#009900'>// implicit conversions are non-reentrant
</font>            <font color='#0000FF'>return</font> nullptr;
        <b>}</b>
        set_flag <font color='#BB00BB'>flag_helper</font><font face='Lucida Console'>(</font>currently_used<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>detail::make_caster<font color='#5555FF'>&lt;</font>InputType<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.<font color='#BB00BB'>load</font><font face='Lucida Console'>(</font>obj, <font color='#979000'>false</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> nullptr;
        <b>}</b>
        tuple <font color='#BB00BB'>args</font><font face='Lucida Console'>(</font><font color='#979000'>1</font><font face='Lucida Console'>)</font>;
        args[<font color='#979000'>0</font>] <font color='#5555FF'>=</font> obj;
        PyObject <font color='#5555FF'>*</font>result <font color='#5555FF'>=</font> <font color='#BB00BB'>PyObject_Call</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> type, args.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, nullptr<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>result <font color='#5555FF'>=</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>PyErr_Clear</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
        <font color='#0000FF'>return</font> result;
    <b>}</b>;

    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>tinfo <font color='#5555FF'>=</font> detail::<font color='#BB00BB'>get_type_info</font><font face='Lucida Console'>(</font><font color='#0000FF'>typeid</font><font face='Lucida Console'>(</font>OutputType<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        tinfo<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>implicit_conversions.<font color='#BB00BB'>emplace_back</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>implicit_caster<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
        <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>implicitly_convertible: Unable to find type </font>" <font color='#5555FF'>+</font> type_id<font color='#5555FF'>&lt;</font>OutputType<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <b>}</b>
<b>}</b>

<font color='#0000FF'>inline</font> <font color='#0000FF'><u>void</u></font> <b><a name='register_exception_translator'></a>register_exception_translator</b><font face='Lucida Console'>(</font>ExceptionTranslator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>translator<font face='Lucida Console'>)</font> <b>{</b>
    detail::<font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.registered_exception_translators.<font color='#BB00BB'>push_front</font><font face='Lucida Console'>(</font>
        std::forward<font color='#5555FF'>&lt;</font>ExceptionTranslator<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>translator<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#009900'>/**
 * Add a new module-local exception translator. Locally registered functions
 * will be tried before any globally registered exception translators, which
 * will only be invoked if the module-local handlers do not deal with
 * the exception.
 */</font>
<font color='#0000FF'>inline</font> <font color='#0000FF'><u>void</u></font> <b><a name='register_local_exception_translator'></a>register_local_exception_translator</b><font face='Lucida Console'>(</font>ExceptionTranslator <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>translator<font face='Lucida Console'>)</font> <b>{</b>
    detail::<font color='#BB00BB'>get_local_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.registered_exception_translators.<font color='#BB00BB'>push_front</font><font face='Lucida Console'>(</font>
        std::forward<font color='#5555FF'>&lt;</font>ExceptionTranslator<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>translator<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#009900'>/**
 * Wrapper to generate a new Python exception type.
 *
 * This should only be used with py::set_error() for now.
 * It is not (yet) possible to use as a py::base.
 * Template type argument is reserved for future use.
 */</font>
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> type<font color='#5555FF'>&gt;</font>
<font color='#0000FF'>class</font> <b><a name='exception'></a>exception</b> : <font color='#0000FF'>public</font> object <b>{</b>
<font color='#0000FF'>public</font>:
    <b><a name='exception'></a>exception</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#0000FF'>default</font>;
    <b><a name='exception'></a>exception</b><font face='Lucida Console'>(</font>handle scope, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, handle base <font color='#5555FF'>=</font> PyExc_Exception<font face='Lucida Console'>)</font> <b>{</b>
        std::string full_name
            <font color='#5555FF'>=</font> scope.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__name__</font>"<font face='Lucida Console'>)</font>.cast<font color='#5555FF'>&lt;</font>std::string<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>.</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> name;
        m_ptr <font color='#5555FF'>=</font> <font color='#BB00BB'>PyErr_NewException</font><font face='Lucida Console'>(</font><font color='#0000FF'>const_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>full_name.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>, base.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, nullptr<font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#BB00BB'>hasattr</font><font face='Lucida Console'>(</font>scope, "<font color='#CC0000'>__dict__</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> scope.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>__dict__</font>"<font face='Lucida Console'>)</font>.<font color='#BB00BB'>contains</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>Error during initialization: multiple incompatible </font>"
                          "<font color='#CC0000'>definitions with name \"</font>"
                          <font color='#5555FF'>+</font> std::<font color='#BB00BB'>string</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font> <font color='#5555FF'>+</font> "<font color='#CC0000'>\"</font>"<font face='Lucida Console'>)</font>;
        <b>}</b>
        scope.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font> <font color='#5555FF'>*</font><font color='#0000FF'>this</font>;
    <b>}</b>

    <font color='#009900'>// Sets the current python exception to this exception object with the given message
</font>    <b><a name='PYBIND11_DEPRECATED'></a>PYBIND11_DEPRECATED</b><font face='Lucida Console'>(</font>"<font color='#CC0000'>Please use py::set_error() instead </font>"
                        "<font color='#CC0000'>(https://github.com/pybind/pybind11/pull/4772)</font>"<font face='Lucida Console'>)</font>
    <font color='#0000FF'><u>void</u></font> <b><a name='operator'></a>operator</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>message<font face='Lucida Console'>)</font> <font color='#0000FF'>const</font> <b>{</b> <font color='#BB00BB'>set_error</font><font face='Lucida Console'>(</font><font color='#5555FF'>*</font><font color='#0000FF'>this</font>, message<font face='Lucida Console'>)</font>; <b>}</b>
<b>}</b>;

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>struct</font> <b><a name='handle_type_name'></a>handle_type_name</b><font color='#5555FF'>&lt;</font>exception<font color='#5555FF'>&lt;</font><font color='#0000FF'><u>void</u></font><font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font> <b>{</b>
    <font color='#0000FF'>static</font> constexpr <font color='#0000FF'>auto</font> name <font color='#5555FF'>=</font> <b><a name='const_name'></a>const_name</b><font face='Lucida Console'>(</font>"<font color='#CC0000'>Exception</font>"<font face='Lucida Console'>)</font>;
<b>}</b>;

<font color='#009900'>// Helper function for register_exception and register_local_exception
</font><font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> CppException<font color='#5555FF'>&gt;</font>
exception<font color='#5555FF'>&lt;</font>CppException<font color='#5555FF'>&gt;</font> <font color='#5555FF'>&amp;</font>
<b><a name='register_exception_impl'></a>register_exception_impl</b><font face='Lucida Console'>(</font>handle scope, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, handle base, <font color='#0000FF'><u>bool</u></font> isLocal<font face='Lucida Console'>)</font> <b>{</b>
    PYBIND11_CONSTINIT <font color='#0000FF'>static</font> gil_safe_call_once_and_store<font color='#5555FF'>&lt;</font>exception<font color='#5555FF'>&lt;</font>CppException<font color='#5555FF'>&gt;</font><font color='#5555FF'>&gt;</font> exc_storage;
    exc_storage.<font color='#BB00BB'>call_once_and_store_result</font><font face='Lucida Console'>(</font>
        [<font color='#5555FF'>&amp;</font>]<font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <b>{</b> <font color='#0000FF'>return</font> exception<font color='#5555FF'>&lt;</font>CppException<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>scope, name, base<font face='Lucida Console'>)</font>; <b>}</b><font face='Lucida Console'>)</font>;

    <font color='#0000FF'>auto</font> register_func
        <font color='#5555FF'>=</font> isLocal ? <font color='#5555FF'>&amp;</font>register_local_exception_translator : <font color='#5555FF'>&amp;</font>register_exception_translator;

    <font color='#BB00BB'>register_func</font><font face='Lucida Console'>(</font>[]<font face='Lucida Console'>(</font>std::exception_ptr p<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>p<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font>;
        <b>}</b>
        <font color='#0000FF'>try</font> <b>{</b>
            std::<font color='#BB00BB'>rethrow_exception</font><font face='Lucida Console'>(</font>p<font face='Lucida Console'>)</font>;
        <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font><font color='#0000FF'>const</font> CppException <font color='#5555FF'>&amp;</font>e<font face='Lucida Console'>)</font> <b>{</b>
            <font color='#BB00BB'>set_error</font><font face='Lucida Console'>(</font>exc_storage.<font color='#BB00BB'>get_stored</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, e.<font color='#BB00BB'>what</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b><font face='Lucida Console'>)</font>;
    <font color='#0000FF'>return</font> exc_storage.<font color='#BB00BB'>get_stored</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
<b>}</b>

<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#009900'>/**
 * Registers a Python exception in `m` of the given `name` and installs a translator to
 * translate the C++ exception to the created Python exception using the what() method.
 * This is intended for simple exception translations; for more complex translation, register the
 * exception object and translator directly.
 */</font>
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> CppException<font color='#5555FF'>&gt;</font>
exception<font color='#5555FF'>&lt;</font>CppException<font color='#5555FF'>&gt;</font> <font color='#5555FF'>&amp;</font>
<b><a name='register_exception'></a>register_exception</b><font face='Lucida Console'>(</font>handle scope, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, handle base <font color='#5555FF'>=</font> PyExc_Exception<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> detail::register_exception_impl<font color='#5555FF'>&lt;</font>CppException<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>scope, name, base, <font color='#979000'>false</font> <font color='#009900'>/* isLocal */</font><font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#009900'>/**
 * Registers a Python exception in `m` of the given `name` and installs a translator to
 * translate the C++ exception to the created Python exception using the what() method.
 * This translator will only be used for exceptions that are thrown in this module and will be
 * tried before global exception translators, including those registered with register_exception.
 * This is intended for simple exception translations; for more complex translation, register the
 * exception object and translator directly.
 */</font>
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>typename</font> CppException<font color='#5555FF'>&gt;</font>
exception<font color='#5555FF'>&lt;</font>CppException<font color='#5555FF'>&gt;</font> <font color='#5555FF'>&amp;</font>
<b><a name='register_local_exception'></a>register_local_exception</b><font face='Lucida Console'>(</font>handle scope, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name, handle base <font color='#5555FF'>=</font> PyExc_Exception<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> detail::register_exception_impl<font color='#5555FF'>&lt;</font>CppException<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>scope, name, base, <font color='#979000'>true</font> <font color='#009900'>/* isLocal */</font><font face='Lucida Console'>)</font>;
<b>}</b>

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>
PYBIND11_NOINLINE <font color='#0000FF'><u>void</u></font> <b><a name='print'></a>print</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> tuple <font color='#5555FF'>&amp;</font>args, <font color='#0000FF'>const</font> dict <font color='#5555FF'>&amp;</font>kwargs<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>auto</font> strings <font color='#5555FF'>=</font> <font color='#BB00BB'>tuple</font><font face='Lucida Console'>(</font>args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <font color='#0000FF'>for</font> <font face='Lucida Console'>(</font><font color='#0000FF'><u>size_t</u></font> i <font color='#5555FF'>=</font> <font color='#979000'>0</font>; i <font color='#5555FF'>&lt;</font> args.<font color='#BB00BB'>size</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>; <font color='#5555FF'>+</font><font color='#5555FF'>+</font>i<font face='Lucida Console'>)</font> <b>{</b>
        strings[i] <font color='#5555FF'>=</font> <font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>args[i]<font face='Lucida Console'>)</font>;
    <b>}</b>
    <font color='#0000FF'>auto</font> sep <font color='#5555FF'>=</font> kwargs.<font color='#BB00BB'>contains</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>sep</font>"<font face='Lucida Console'>)</font> ? kwargs["<font color='#CC0000'>sep</font>"] : <font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>"<font color='#CC0000'> </font>"<font face='Lucida Console'>)</font>;
    <font color='#0000FF'>auto</font> line <font color='#5555FF'>=</font> sep.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>join</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>strings<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

    object file;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>kwargs.<font color='#BB00BB'>contains</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>file</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        file <font color='#5555FF'>=</font> kwargs["<font color='#CC0000'>file</font>"].cast<font color='#5555FF'>&lt;</font>object<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b> <font color='#0000FF'>else</font> <b>{</b>
        <font color='#0000FF'>try</font> <b>{</b>
            file <font color='#5555FF'>=</font> module_::<font color='#BB00BB'>import</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>sys</font>"<font face='Lucida Console'>)</font>.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>stdout</font>"<font face='Lucida Console'>)</font>;
        <b>}</b> <font color='#0000FF'>catch</font> <font face='Lucida Console'>(</font><font color='#0000FF'>const</font> error_already_set <font color='#5555FF'>&amp;</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#009900'>/* If print() is called from code that is executed as
               part of garbage collection during interpreter shutdown,
               importing 'sys' can fail. Give up rather than crashing the
               interpreter in this case. */</font>
            <font color='#0000FF'>return</font>;
        <b>}</b>
    <b>}</b>

    <font color='#0000FF'>auto</font> write <font color='#5555FF'>=</font> file.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>write</font>"<font face='Lucida Console'>)</font>;
    <font color='#BB00BB'>write</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>line<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <font color='#BB00BB'>write</font><font face='Lucida Console'>(</font>kwargs.<font color='#BB00BB'>contains</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>end</font>"<font face='Lucida Console'>)</font> ? kwargs["<font color='#CC0000'>end</font>"] : <font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>\n</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;

    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>kwargs.<font color='#BB00BB'>contains</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>flush</font>"<font face='Lucida Console'>)</font> <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> kwargs["<font color='#CC0000'>flush</font>"].cast<font color='#5555FF'>&lt;</font><font color='#0000FF'><u>bool</u></font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        file.<font color='#BB00BB'>attr</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>flush</font>"<font face='Lucida Console'>)</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>
<b>}</b>
<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font>return_value_policy policy <font color='#5555FF'>=</font> return_value_policy::automatic_reference, <font color='#0000FF'>typename</font>... Args<font color='#5555FF'>&gt;</font>
<font color='#0000FF'><u>void</u></font> <b><a name='print'></a>print</b><font face='Lucida Console'>(</font>Args <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font>...args<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>auto</font> c <font color='#5555FF'>=</font> detail::collect_arguments<font color='#5555FF'>&lt;</font>policy<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>std::forward<font color='#5555FF'>&lt;</font>Args<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>args<font face='Lucida Console'>)</font>...<font face='Lucida Console'>)</font>;
    detail::<font color='#BB00BB'>print</font><font face='Lucida Console'>(</font>c.<font color='#BB00BB'>args</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, c.<font color='#BB00BB'>kwargs</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#0000FF'>inline</font> <font color='#0000FF'><u>void</u></font>
error_already_set::<b><a name='m_fetched_error_deleter'></a>m_fetched_error_deleter</b><font face='Lucida Console'>(</font>detail::error_fetch_and_normalize <font color='#5555FF'>*</font>raw_ptr<font face='Lucida Console'>)</font> <b>{</b>
    gil_scoped_acquire gil;
    error_scope scope;
    <font color='#0000FF'>delete</font> raw_ptr;
<b>}</b>

<font color='#0000FF'>inline</font> <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>error_already_set::<b><a name='what'></a>what</b><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font> <font color='#0000FF'>const</font> noexcept <b>{</b>
    gil_scoped_acquire gil;
    error_scope scope;
    <font color='#0000FF'>return</font> m_fetched_error<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font><font color='#BB00BB'>error_string</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.<font color='#BB00BB'>c_str</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
<b>}</b>

<b><a name='PYBIND11_NAMESPACE_BEGIN'></a>PYBIND11_NAMESPACE_BEGIN</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#0000FF'>inline</font> function
<b><a name='get_type_override'></a>get_type_override</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font>this_ptr, <font color='#0000FF'>const</font> type_info <font color='#5555FF'>*</font>this_type, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name<font face='Lucida Console'>)</font> <b>{</b>
    handle self <font color='#5555FF'>=</font> <font color='#BB00BB'>get_object_handle</font><font face='Lucida Console'>(</font>this_ptr, this_type<font face='Lucida Console'>)</font>;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font color='#5555FF'>!</font>self<font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>function</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>
    handle type <font color='#5555FF'>=</font> type::<font color='#BB00BB'>handle_of</font><font face='Lucida Console'>(</font>self<font face='Lucida Console'>)</font>;
    <font color='#0000FF'>auto</font> key <font color='#5555FF'>=</font> std::<font color='#BB00BB'>make_pair</font><font face='Lucida Console'>(</font>type.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>, name<font face='Lucida Console'>)</font>;

    <font color='#009900'>/* Cache functions that aren't overridden in Python to avoid
       many costly Python dictionary lookups below */</font>
    <font color='#0000FF'>auto</font> <font color='#5555FF'>&amp;</font>cache <font color='#5555FF'>=</font> <font color='#BB00BB'>get_internals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>.inactive_override_cache;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>cache.<font color='#BB00BB'>find</font><font face='Lucida Console'>(</font>key<font face='Lucida Console'>)</font> <font color='#5555FF'>!</font><font color='#5555FF'>=</font> cache.<font color='#BB00BB'>end</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>function</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    function override <font color='#5555FF'>=</font> <font color='#BB00BB'>getattr</font><font face='Lucida Console'>(</font>self, name, <font color='#BB00BB'>function</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>override.<font color='#BB00BB'>is_cpp_function</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
        cache.<font color='#BB00BB'>insert</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>key<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>return</font> <font color='#BB00BB'>function</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <b>}</b>

    <font color='#009900'>/* Don't call dispatch code if invoked from overridden function.
       Unfortunately this doesn't work on PyPy. */</font>
<font color='#0000FF'>#if</font> <font color='#5555FF'>!</font>defined<font face='Lucida Console'>(</font>PYPY_VERSION<font face='Lucida Console'>)</font>
#    <font color='#0000FF'>if</font> PY_VERSION_HEX <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> <font color='#979000'>0x03090000</font>
    PyFrameObject <font color='#5555FF'>*</font>frame <font color='#5555FF'>=</font> <font color='#BB00BB'>PyThreadState_GetFrame</font><font face='Lucida Console'>(</font><font color='#BB00BB'>PyThreadState_Get</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>frame <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
        PyCodeObject <font color='#5555FF'>*</font>f_code <font color='#5555FF'>=</font> <font color='#BB00BB'>PyFrame_GetCode</font><font face='Lucida Console'>(</font>frame<font face='Lucida Console'>)</font>;
        <font color='#009900'>// f_code is guaranteed to not be NULL
</font>        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>std::string<font face='Lucida Console'>)</font> <font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>f_code<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>co_name<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> name <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> f_code<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>co_argcount <font color='#5555FF'>&gt;</font> <font color='#979000'>0</font><font face='Lucida Console'>)</font> <b>{</b>
            PyObject <font color='#5555FF'>*</font>locals <font color='#5555FF'>=</font> <font color='#BB00BB'>PyEval_GetLocals</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>locals <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font> <b>{</b>
#        <font color='#0000FF'>if</font> PY_VERSION_HEX <font color='#5555FF'>&gt;</font><font color='#5555FF'>=</font> <font color='#979000'>0x030b0000</font>
                PyObject <font color='#5555FF'>*</font>co_varnames <font color='#5555FF'>=</font> <font color='#BB00BB'>PyCode_GetVarnames</font><font face='Lucida Console'>(</font>f_code<font face='Lucida Console'>)</font>;
#        <font color='#0000FF'>else</font>
                PyObject <font color='#5555FF'>*</font>co_varnames <font color='#5555FF'>=</font> <font color='#BB00BB'>PyObject_GetAttrString</font><font face='Lucida Console'>(</font><font face='Lucida Console'>(</font>PyObject <font color='#5555FF'>*</font><font face='Lucida Console'>)</font> f_code, "<font color='#CC0000'>co_varnames</font>"<font face='Lucida Console'>)</font>;
#        endif
                PyObject <font color='#5555FF'>*</font>self_arg <font color='#5555FF'>=</font> <font color='#BB00BB'>PyTuple_GET_ITEM</font><font face='Lucida Console'>(</font>co_varnames, <font color='#979000'>0</font><font face='Lucida Console'>)</font>;
                <font color='#BB00BB'>Py_DECREF</font><font face='Lucida Console'>(</font>co_varnames<font face='Lucida Console'>)</font>;
                PyObject <font color='#5555FF'>*</font>self_caller <font color='#5555FF'>=</font> <font color='#BB00BB'>dict_getitem</font><font face='Lucida Console'>(</font>locals, self_arg<font face='Lucida Console'>)</font>;
                <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>self_caller <font color='#5555FF'>=</font><font color='#5555FF'>=</font> self.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
                    <font color='#BB00BB'>Py_DECREF</font><font face='Lucida Console'>(</font>f_code<font face='Lucida Console'>)</font>;
                    <font color='#BB00BB'>Py_DECREF</font><font face='Lucida Console'>(</font>frame<font face='Lucida Console'>)</font>;
                    <font color='#0000FF'>return</font> <font color='#BB00BB'>function</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
                <b>}</b>
            <b>}</b>
        <b>}</b>
        <font color='#BB00BB'>Py_DECREF</font><font face='Lucida Console'>(</font>f_code<font face='Lucida Console'>)</font>;
        <font color='#BB00BB'>Py_DECREF</font><font face='Lucida Console'>(</font>frame<font face='Lucida Console'>)</font>;
    <b>}</b>
#    <font color='#0000FF'>else</font>
    PyFrameObject <font color='#5555FF'>*</font>frame <font color='#5555FF'>=</font> <font color='#BB00BB'>PyThreadState_Get</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>frame;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>frame <font color='#5555FF'>!</font><font color='#5555FF'>=</font> nullptr <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> <font face='Lucida Console'>(</font>std::string<font face='Lucida Console'>)</font> <font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>frame<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>f_code<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>co_name<font face='Lucida Console'>)</font> <font color='#5555FF'>=</font><font color='#5555FF'>=</font> name
        <font color='#5555FF'>&amp;</font><font color='#5555FF'>&amp;</font> frame<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>f_code<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>co_argcount <font color='#5555FF'>&gt;</font> <font color='#979000'>0</font><font face='Lucida Console'>)</font> <b>{</b>
        <font color='#BB00BB'>PyFrame_FastToLocals</font><font face='Lucida Console'>(</font>frame<font face='Lucida Console'>)</font>;
        PyObject <font color='#5555FF'>*</font>self_caller
            <font color='#5555FF'>=</font> <font color='#BB00BB'>dict_getitem</font><font face='Lucida Console'>(</font>frame<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>f_locals, <font color='#BB00BB'>PyTuple_GET_ITEM</font><font face='Lucida Console'>(</font>frame<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>f_code<font color='#5555FF'>-</font><font color='#5555FF'>&gt;</font>co_varnames, <font color='#979000'>0</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>self_caller <font color='#5555FF'>=</font><font color='#5555FF'>=</font> self.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font> <b>{</b>
            <font color='#0000FF'>return</font> <font color='#BB00BB'>function</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
        <b>}</b>
    <b>}</b>
#    endif

<font color='#0000FF'>#else</font>
    <font color='#009900'>/* PyPy currently doesn't provide a detailed cpyext emulation of
       frame objects, so we have to emulate this using Python. This
       is going to be slow..*/</font>
    dict d;
    d["<font color='#CC0000'>self</font>"] <font color='#5555FF'>=</font> self;
    d["<font color='#CC0000'>name</font>"] <font color='#5555FF'>=</font> pybind11::<font color='#BB00BB'>str</font><font face='Lucida Console'>(</font>name<font face='Lucida Console'>)</font>;
    PyObject <font color='#5555FF'>*</font>result
        <font color='#5555FF'>=</font> <font color='#BB00BB'>PyRun_String</font><font face='Lucida Console'>(</font>"<font color='#CC0000'>import inspect\n</font>"
                       "<font color='#CC0000'>frame = inspect.currentframe()\n</font>"
                       "<font color='#CC0000'>if frame is not None:\n</font>"
                       "<font color='#CC0000'>    frame = frame.f_back\n</font>"
                       "<font color='#CC0000'>    if frame is not None and str(frame.f_code.co_name) == name and </font>"
                       "<font color='#CC0000'>frame.f_code.co_argcount &gt; 0:\n</font>"
                       "<font color='#CC0000'>        self_caller = frame.f_locals[frame.f_code.co_varnames[0]]\n</font>"
                       "<font color='#CC0000'>        if self_caller == self:\n</font>"
                       "<font color='#CC0000'>            self = None\n</font>",
                       Py_file_input,
                       d.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>,
                       d.<font color='#BB00BB'>ptr</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>result <font color='#5555FF'>=</font><font color='#5555FF'>=</font> nullptr<font face='Lucida Console'>)</font>
        <font color='#0000FF'>throw</font> <font color='#BB00BB'>error_already_set</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
    <font color='#BB00BB'>Py_DECREF</font><font face='Lucida Console'>(</font>result<font face='Lucida Console'>)</font>;
    <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>d["<font color='#CC0000'>self</font>"].<font color='#BB00BB'>is_none</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>
        <font color='#0000FF'>return</font> <font color='#BB00BB'>function</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
<font color='#0000FF'>#endif</font>

    <font color='#0000FF'>return</font> override;
<b>}</b>
<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>detail<font face='Lucida Console'>)</font>

<font color='#009900'>/** \rst
  Try to retrieve a python method by the provided name from the instance pointed to by the
  this_ptr.

  :this_ptr: The pointer to the object the overridden method should be retrieved for. This should
             be the first non-trampoline class encountered in the inheritance chain.
  :name: The name of the overridden Python method to retrieve.
  :return: The Python method by this name from the object or an empty function wrapper.
 \endrst */</font>
<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>class</font> <b><a name='T'></a>T</b><font color='#5555FF'>&gt;</font>
function <b><a name='get_override'></a>get_override</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> T <font color='#5555FF'>*</font>this_ptr, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>auto</font> <font color='#5555FF'>*</font>tinfo <font color='#5555FF'>=</font> detail::<font color='#BB00BB'>get_type_info</font><font face='Lucida Console'>(</font><font color='#0000FF'>typeid</font><font face='Lucida Console'>(</font>T<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;
    <font color='#0000FF'>return</font> tinfo ? detail::<font color='#BB00BB'>get_type_override</font><font face='Lucida Console'>(</font>this_ptr, tinfo, name<font face='Lucida Console'>)</font> : <font color='#BB00BB'>function</font><font face='Lucida Console'>(</font><font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#0000FF'>#define</font> PYBIND11_OVERRIDE_IMPL<font face='Lucida Console'>(</font>ret_type, cname, name, ...<font face='Lucida Console'>)</font>                                        \
    <font color='#0000FF'>do</font> <b>{</b>                                                                                          \
        pybind11::gil_scoped_acquire gil;                                                         \
        pybind11::function override                                                               \
            <font color='#5555FF'>=</font> pybind11::<font color='#BB00BB'>get_override</font><font face='Lucida Console'>(</font><font color='#0000FF'>static_cast</font><font color='#5555FF'>&lt;</font><font color='#0000FF'>const</font> cname <font color='#5555FF'>*</font><font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font><font color='#0000FF'>this</font><font face='Lucida Console'>)</font>, name<font face='Lucida Console'>)</font>;                     \
        <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>override<font face='Lucida Console'>)</font> <b>{</b>                                                                           \
            <font color='#0000FF'>auto</font> o <font color='#5555FF'>=</font> <font color='#BB00BB'>override</font><font face='Lucida Console'>(</font>__VA_ARGS__<font face='Lucida Console'>)</font>;                                                       \
            <font color='#0000FF'>if</font> <font face='Lucida Console'>(</font>pybind11::detail::cast_is_temporary_value_reference<font color='#5555FF'>&lt;</font>ret_type<font color='#5555FF'>&gt;</font>::value<font face='Lucida Console'>)</font> <b>{</b>           \
                <font color='#0000FF'>static</font> pybind11::detail::override_caster_t<font color='#5555FF'>&lt;</font>ret_type<font color='#5555FF'>&gt;</font> caster;                      \
                <font color='#0000FF'>return</font> pybind11::detail::cast_ref<font color='#5555FF'>&lt;</font>ret_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>o<font face='Lucida Console'>)</font>, caster<font face='Lucida Console'>)</font>;                \
            <b>}</b>                                                                                     \
            <font color='#0000FF'>return</font> pybind11::detail::cast_safe<font color='#5555FF'>&lt;</font>ret_type<font color='#5555FF'>&gt;</font><font face='Lucida Console'>(</font>std::<font color='#BB00BB'>move</font><font face='Lucida Console'>(</font>o<font face='Lucida Console'>)</font><font face='Lucida Console'>)</font>;                           \
        <b>}</b>                                                                                         \
    <b>}</b> <font color='#0000FF'>while</font> <font face='Lucida Console'>(</font><font color='#979000'>false</font><font face='Lucida Console'>)</font>

<font color='#009900'>/** \rst
    Macro to populate the virtual method in the trampoline class. This macro tries to look up a
    method named 'fn' from the Python side, deals with the :ref:`gil` and necessary argument
    conversions to call this method and return the appropriate type.
    See :ref:`overriding_virtuals` for more information. This macro should be used when the method
    name in C is not the same as the method name in Python. For example with `__str__`.

    .. code-block:: cpp

      std::string toString() override {
        PYBIND11_OVERRIDE_NAME(
            std::string, // Return type (ret_type)
            Animal,      // Parent class (cname)
            "__str__",   // Name of method in Python (name)
            toString,    // Name of function in C++ (fn)
        );
      }
\endrst */</font>
<font color='#0000FF'>#define</font> PYBIND11_OVERRIDE_NAME<font face='Lucida Console'>(</font>ret_type, cname, name, fn, ...<font face='Lucida Console'>)</font>                                    \
    <font color='#0000FF'>do</font> <b>{</b>                                                                                          \
        <font color='#BB00BB'>PYBIND11_OVERRIDE_IMPL</font><font face='Lucida Console'>(</font><font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>ret_type<font face='Lucida Console'>)</font>, <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font>, name, __VA_ARGS__<font face='Lucida Console'>)</font>; \
        <font color='#0000FF'>return</font> cname::<font color='#BB00BB'>fn</font><font face='Lucida Console'>(</font>__VA_ARGS__<font face='Lucida Console'>)</font>;                                                            \
    <b>}</b> <font color='#0000FF'>while</font> <font face='Lucida Console'>(</font><font color='#979000'>false</font><font face='Lucida Console'>)</font>

<font color='#009900'>/** \rst
    Macro for pure virtual functions, this function is identical to
    :c:macro:`PYBIND11_OVERRIDE_NAME`, except that it throws if no override can be found.
\endrst */</font>
<font color='#0000FF'>#define</font> PYBIND11_OVERRIDE_PURE_NAME<font face='Lucida Console'>(</font>ret_type, cname, name, fn, ...<font face='Lucida Console'>)</font>                               \
    <font color='#0000FF'>do</font> <b>{</b>                                                                                          \
        <font color='#BB00BB'>PYBIND11_OVERRIDE_IMPL</font><font face='Lucida Console'>(</font><font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>ret_type<font face='Lucida Console'>)</font>, <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font>, name, __VA_ARGS__<font face='Lucida Console'>)</font>; \
        pybind11::<font color='#BB00BB'>pybind11_fail</font><font face='Lucida Console'>(</font>                                                                  \
            "<font color='#CC0000'>Tried to call pure virtual function \"</font>" <font color='#BB00BB'>PYBIND11_STRINGIFY</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font> "<font color='#CC0000'>::</font>" name "<font color='#CC0000'>\"</font>"<font face='Lucida Console'>)</font>;   \
    <b>}</b> <font color='#0000FF'>while</font> <font face='Lucida Console'>(</font><font color='#979000'>false</font><font face='Lucida Console'>)</font>

<font color='#009900'>/** \rst
    Macro to populate the virtual method in the trampoline class. This macro tries to look up the
    method from the Python side, deals with the :ref:`gil` and necessary argument conversions to
    call this method and return the appropriate type. This macro should be used if the method name
    in C and in Python are identical.
    See :ref:`overriding_virtuals` for more information.

    .. code-block:: cpp

      class PyAnimal : public Animal {
      public:
          // Inherit the constructors
          using Animal::Animal;

          // Trampoline (need one for each virtual function)
          std::string go(int n_times) override {
              PYBIND11_OVERRIDE_PURE(
                  std::string, // Return type (ret_type)
                  Animal,      // Parent class (cname)
                  go,          // Name of function in C++ (must match Python name) (fn)
                  n_times      // Argument(s) (...)
              );
          }
      };
\endrst */</font>
<font color='#0000FF'>#define</font> PYBIND11_OVERRIDE<font face='Lucida Console'>(</font>ret_type, cname, fn, ...<font face='Lucida Console'>)</font>                                               \
    <b><a name='PYBIND11_OVERRIDE_NAME'></a>PYBIND11_OVERRIDE_NAME</b><font face='Lucida Console'>(</font><font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>ret_type<font face='Lucida Console'>)</font>, <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font>, #fn, fn, __VA_ARGS__<font face='Lucida Console'>)</font>

<font color='#009900'>/** \rst
    Macro for pure virtual functions, this function is identical to :c:macro:`PYBIND11_OVERRIDE`,
    except that it throws if no override can be found.
\endrst */</font>
<font color='#0000FF'>#define</font> PYBIND11_OVERRIDE_PURE<font face='Lucida Console'>(</font>ret_type, cname, fn, ...<font face='Lucida Console'>)</font>                                          \
    <b><a name='PYBIND11_OVERRIDE_PURE_NAME'></a>PYBIND11_OVERRIDE_PURE_NAME</b><font face='Lucida Console'>(</font>                                                                  \
        <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>ret_type<font face='Lucida Console'>)</font>, <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font>, #fn, fn, __VA_ARGS__<font face='Lucida Console'>)</font>

<font color='#009900'>// Deprecated versions
</font>
<b><a name='PYBIND11_DEPRECATED'></a>PYBIND11_DEPRECATED</b><font face='Lucida Console'>(</font>"<font color='#CC0000'>get_type_overload has been deprecated</font>"<font face='Lucida Console'>)</font>
<font color='#0000FF'>inline</font> function
<b><a name='get_type_overload'></a>get_type_overload</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> <font color='#0000FF'><u>void</u></font> <font color='#5555FF'>*</font>this_ptr, <font color='#0000FF'>const</font> detail::type_info <font color='#5555FF'>*</font>this_type, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> detail::<font color='#BB00BB'>get_type_override</font><font face='Lucida Console'>(</font>this_ptr, this_type, name<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#0000FF'>template</font> <font color='#5555FF'>&lt;</font><font color='#0000FF'>class</font> <b><a name='T'></a>T</b><font color='#5555FF'>&gt;</font>
<font color='#0000FF'>inline</font> function <b><a name='get_overload'></a>get_overload</b><font face='Lucida Console'>(</font><font color='#0000FF'>const</font> T <font color='#5555FF'>*</font>this_ptr, <font color='#0000FF'>const</font> <font color='#0000FF'><u>char</u></font> <font color='#5555FF'>*</font>name<font face='Lucida Console'>)</font> <b>{</b>
    <font color='#0000FF'>return</font> <font color='#BB00BB'>get_override</font><font face='Lucida Console'>(</font>this_ptr, name<font face='Lucida Console'>)</font>;
<b>}</b>

<font color='#0000FF'>#define</font> PYBIND11_OVERLOAD_INT<font face='Lucida Console'>(</font>ret_type, cname, name, ...<font face='Lucida Console'>)</font>                                         \
    <b><a name='PYBIND11_OVERRIDE_IMPL'></a>PYBIND11_OVERRIDE_IMPL</b><font face='Lucida Console'>(</font><font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>ret_type<font face='Lucida Console'>)</font>, <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font>, name, __VA_ARGS__<font face='Lucida Console'>)</font>
<font color='#0000FF'>#define</font> PYBIND11_OVERLOAD_NAME<font face='Lucida Console'>(</font>ret_type, cname, name, fn, ...<font face='Lucida Console'>)</font>                                    \
    <b><a name='PYBIND11_OVERRIDE_NAME'></a>PYBIND11_OVERRIDE_NAME</b><font face='Lucida Console'>(</font><font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>ret_type<font face='Lucida Console'>)</font>, <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font>, name, fn, __VA_ARGS__<font face='Lucida Console'>)</font>
<font color='#0000FF'>#define</font> PYBIND11_OVERLOAD_PURE_NAME<font face='Lucida Console'>(</font>ret_type, cname, name, fn, ...<font face='Lucida Console'>)</font>                               \
    <b><a name='PYBIND11_OVERRIDE_PURE_NAME'></a>PYBIND11_OVERRIDE_PURE_NAME</b><font face='Lucida Console'>(</font>                                                                  \
        <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>ret_type<font face='Lucida Console'>)</font>, <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font>, name, fn, __VA_ARGS__<font face='Lucida Console'>)</font>;
<font color='#0000FF'>#define</font> PYBIND11_OVERLOAD<font face='Lucida Console'>(</font>ret_type, cname, fn, ...<font face='Lucida Console'>)</font>                                               \
    <b><a name='PYBIND11_OVERRIDE'></a>PYBIND11_OVERRIDE</b><font face='Lucida Console'>(</font><font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>ret_type<font face='Lucida Console'>)</font>, <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font>, fn, __VA_ARGS__<font face='Lucida Console'>)</font>
<font color='#0000FF'>#define</font> PYBIND11_OVERLOAD_PURE<font face='Lucida Console'>(</font>ret_type, cname, fn, ...<font face='Lucida Console'>)</font>                                          \
    <b><a name='PYBIND11_OVERRIDE_PURE'></a>PYBIND11_OVERRIDE_PURE</b><font face='Lucida Console'>(</font><font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>ret_type<font face='Lucida Console'>)</font>, <font color='#BB00BB'>PYBIND11_TYPE</font><font face='Lucida Console'>(</font>cname<font face='Lucida Console'>)</font>, fn, __VA_ARGS__<font face='Lucida Console'>)</font>;

<b><a name='PYBIND11_NAMESPACE_END'></a>PYBIND11_NAMESPACE_END</b><font face='Lucida Console'>(</font>PYBIND11_NAMESPACE<font face='Lucida Console'>)</font>

</pre></body></html>